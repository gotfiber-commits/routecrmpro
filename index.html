<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>RouteCRMPro - Distribution Management</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/react/18.2.0/umd/react.development.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/react-dom/18.2.0/umd/react-dom.development.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/babel-standalone/7.23.5/babel.min.js"></script>
    <link href="https://fonts.googleapis.com/css2?family=JetBrains+Mono:wght@400;600;700&family=Outfit:wght@300;400;500;600;700;800&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/leaflet/1.9.4/leaflet.css" />
    <script src="https://cdnjs.cloudflare.com/ajax/libs/leaflet/1.9.4/leaflet.min.js"></script>
    <style>
        :root {
            --primary: #FF6B35;
            --primary-dark: #E85A2A;
            --secondary: #004E89;
            --accent: #FFD23F;
            --success: #06D6A0;
            --danger: #EF476F;
            --warning: #FCA311;
            --bg-dark: #0A0E27;
            --bg-card: #141B38;
            --bg-hover: #1C2545;
            --text-primary: #FFFFFF;
            --text-secondary: #A8B2D1;
            --text-muted: #6B7394;
            --border: #2A3451;
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Outfit', sans-serif;
            background: var(--bg-dark);
            color: var(--text-primary);
            line-height: 1.6;
            overflow-x: hidden;
        }

        .bg-pattern {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            z-index: 0;
            opacity: 0.03;
            background-image: 
                repeating-linear-gradient(45deg, transparent, transparent 35px, var(--primary) 35px, var(--primary) 36px),
                repeating-linear-gradient(-45deg, transparent, transparent 35px, var(--secondary) 35px, var(--secondary) 36px);
            animation: slide 60s linear infinite;
        }

        @keyframes slide {
            0% { transform: translate(0, 0); }
            100% { transform: translate(50px, 50px); }
        }

        .app-container {
            position: relative;
            z-index: 1;
            min-height: 100vh;
        }

        .header {
            background: linear-gradient(135deg, var(--bg-card) 0%, rgba(20, 27, 56, 0.95) 100%);
            border-bottom: 2px solid var(--border);
            padding: 1rem 2rem;
            display: flex;
            justify-content: space-between;
            align-items: center;
            backdrop-filter: blur(10px);
            position: sticky;
            top: 0;
            z-index: 100;
            box-shadow: 0 4px 20px rgba(255, 107, 53, 0.1);
            gap: 1rem;
            flex-wrap: wrap;
        }

        .logo {
            display: flex;
            align-items: center;
            gap: 1rem;
            font-family: 'JetBrains Mono', monospace;
        }

        .logo-icon {
            width: 45px;
            height: 45px;
            background: linear-gradient(135deg, var(--primary) 0%, var(--primary-dark) 100%);
            border-radius: 12px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: 800;
            font-size: 1.5rem;
            box-shadow: 0 4px 15px rgba(255, 107, 53, 0.3);
            animation: pulse 3s ease-in-out infinite;
        }

        @keyframes pulse {
            0%, 100% { transform: scale(1); }
            50% { transform: scale(1.05); }
        }

        .logo-text h1 {
            font-size: 1.5rem;
            font-weight: 800;
            background: linear-gradient(135deg, var(--primary) 0%, var(--accent) 100%);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }

        .logo-text p {
            font-size: 0.75rem;
            color: var(--text-muted);
            letter-spacing: 2px;
            text-transform: uppercase;
        }

        .nav-tabs {
            display: flex;
            gap: 0.5rem;
        }

        .nav-tab {
            padding: 0.75rem 1.5rem;
            background: transparent;
            border: 2px solid transparent;
            color: var(--text-secondary);
            font-weight: 600;
            cursor: pointer;
            border-radius: 10px;
            transition: all 0.3s ease;
            font-family: 'Outfit', sans-serif;
            font-size: 0.95rem;
        }

        .nav-tab:hover {
            background: var(--bg-hover);
            color: var(--text-primary);
        }

        .nav-tab.active {
            background: linear-gradient(135deg, var(--primary) 0%, var(--primary-dark) 100%);
            color: white;
            border-color: var(--primary);
            box-shadow: 0 4px 15px rgba(255, 107, 53, 0.3);
        }

        .main-content {
            padding: 2rem;
            max-width: 1600px;
            margin: 0 auto;
        }

        .dashboard-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
            gap: 1.5rem;
            margin-bottom: 2rem;
        }

        .stat-card {
            background: var(--bg-card);
            border: 2px solid var(--border);
            border-radius: 16px;
            padding: 1.5rem;
            position: relative;
            overflow: hidden;
            transition: all 0.3s ease;
        }

        .stat-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.3);
            border-color: var(--primary);
        }

        .stat-card::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            height: 4px;
            background: linear-gradient(90deg, var(--primary) 0%, var(--accent) 100%);
            opacity: 0;
            transition: opacity 0.3s ease;
        }

        .stat-card:hover::before {
            opacity: 1;
        }

        .stat-header {
            display: flex;
            justify-content: space-between;
            align-items: flex-start;
            margin-bottom: 1rem;
        }

        .stat-label {
            font-size: 0.85rem;
            color: var(--text-muted);
            text-transform: uppercase;
            letter-spacing: 1px;
            font-weight: 600;
        }

        .stat-icon {
            width: 40px;
            height: 40px;
            border-radius: 10px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.2rem;
        }

        .stat-value {
            font-size: 2.5rem;
            font-weight: 800;
            font-family: 'JetBrains Mono', monospace;
            background: linear-gradient(135deg, var(--text-primary) 0%, var(--text-secondary) 100%);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
            margin-bottom: 0.5rem;
        }

        .stat-change {
            font-size: 0.85rem;
            font-weight: 600;
            display: flex;
            align-items: center;
            gap: 0.3rem;
        }

        .stat-change.positive {
            color: var(--success);
        }

        .stat-change.negative {
            color: var(--danger);
        }

        .card {
            background: var(--bg-card);
            border: 2px solid var(--border);
            border-radius: 16px;
            padding: 2rem;
            margin-bottom: 2rem;
        }

        .card-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 1.5rem;
            padding-bottom: 1rem;
            border-bottom: 2px solid var(--border);
        }

        .card-title {
            font-size: 1.5rem;
            font-weight: 700;
            display: flex;
            align-items: center;
            gap: 0.75rem;
        }

        /* Map Styles */
        .map-container {
            width: 100%;
            height: 600px;
            border-radius: 12px;
            overflow: hidden;
            position: relative;
            border: 2px solid var(--border);
        }

        #gps-map {
            width: 100%;
            height: 100%;
        }

        .leaflet-popup-content-wrapper {
            background: var(--bg-card);
            color: var(--text-primary);
            border: 2px solid var(--border);
            border-radius: 12px;
            font-family: 'Outfit', sans-serif;
        }

        .leaflet-popup-content {
            margin: 1rem;
        }

        .leaflet-popup-tip {
            background: var(--bg-card);
        }

        .popup-content {
            min-width: 250px;
        }

        .popup-header {
            display: flex;
            align-items: center;
            gap: 0.75rem;
            margin-bottom: 1rem;
            padding-bottom: 0.75rem;
            border-bottom: 2px solid var(--border);
        }

        .popup-icon {
            width: 40px;
            height: 40px;
            background: linear-gradient(135deg, var(--primary) 0%, var(--primary-dark) 100%);
            border-radius: 8px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.2rem;
        }

        .popup-title {
            font-weight: 700;
            font-size: 1.1rem;
        }

        .popup-info {
            display: flex;
            flex-direction: column;
            gap: 0.5rem;
        }

        .popup-row {
            display: flex;
            justify-content: space-between;
            align-items: center;
            font-size: 0.9rem;
        }

        .popup-label {
            color: var(--text-muted);
        }

        .popup-value {
            color: var(--text-primary);
            font-weight: 600;
            font-family: 'JetBrains Mono', monospace;
        }

        .popup-status {
            display: inline-block;
            padding: 0.3rem 0.6rem;
            border-radius: 6px;
            font-size: 0.7rem;
            font-weight: 700;
            text-transform: uppercase;
            letter-spacing: 0.5px;
            background: rgba(6, 214, 160, 0.2);
            color: var(--success);
            border: 1px solid var(--success);
        }

        .map-legend {
            position: absolute;
            bottom: 2rem;
            right: 2rem;
            background: var(--bg-card);
            border: 2px solid var(--border);
            border-radius: 12px;
            padding: 1rem;
            z-index: 1000;
            backdrop-filter: blur(10px);
        }

        .legend-title {
            font-weight: 700;
            font-size: 0.9rem;
            margin-bottom: 0.75rem;
            color: var(--text-primary);
        }

        .legend-item {
            display: flex;
            align-items: center;
            gap: 0.5rem;
            margin-bottom: 0.5rem;
            font-size: 0.85rem;
        }

        .legend-color {
            width: 20px;
            height: 20px;
            border-radius: 4px;
        }

        /* Buttons */
        .btn {
            padding: 0.75rem 1.5rem;
            border: none;
            border-radius: 10px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            font-family: 'Outfit', sans-serif;
            font-size: 0.95rem;
            display: inline-flex;
            align-items: center;
            gap: 0.5rem;
        }

        .btn-primary {
            background: linear-gradient(135deg, var(--primary) 0%, var(--primary-dark) 100%);
            color: white;
            box-shadow: 0 4px 15px rgba(255, 107, 53, 0.3);
        }

        .btn-primary:hover {
            transform: translateY(-2px);
            box-shadow: 0 6px 20px rgba(255, 107, 53, 0.4);
        }

        .btn-secondary {
            background: var(--bg-hover);
            color: var(--text-primary);
            border: 2px solid var(--border);
        }

        .btn-secondary:hover {
            background: var(--border);
        }

        .btn-success {
            background: var(--success);
            color: white;
        }

        .btn-danger {
            background: var(--danger);
            color: white;
        }

        .btn-sm {
            padding: 0.5rem 1rem;
            font-size: 0.85rem;
        }

        /* Forms */
        .form-group {
            margin-bottom: 1.5rem;
        }

        .form-label {
            display: block;
            margin-bottom: 0.5rem;
            font-weight: 600;
            color: var(--text-secondary);
            font-size: 0.9rem;
        }

        .form-input,
        .form-select,
        .form-textarea {
            width: 100%;
            padding: 0.875rem 1rem;
            background: var(--bg-dark);
            border: 2px solid var(--border);
            border-radius: 10px;
            color: var(--text-primary);
            font-family: 'Outfit', sans-serif;
            font-size: 0.95rem;
            transition: all 0.3s ease;
        }

        .form-input:focus,
        .form-select:focus,
        .form-textarea:focus {
            outline: none;
            border-color: var(--primary);
            box-shadow: 0 0 0 3px rgba(255, 107, 53, 0.1);
        }

        .form-textarea {
            resize: vertical;
            min-height: 100px;
        }

        .form-row {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 1rem;
        }

        /* Tables */
        .table-container {
            overflow-x: auto;
            border-radius: 12px;
            border: 2px solid var(--border);
        }

        .table {
            width: 100%;
            border-collapse: collapse;
        }

        .table thead {
            background: var(--bg-hover);
        }

        .table th {
            padding: 1rem;
            text-align: left;
            font-weight: 700;
            color: var(--text-primary);
            text-transform: uppercase;
            font-size: 0.8rem;
            letter-spacing: 1px;
            border-bottom: 2px solid var(--border);
        }

        .table td {
            padding: 1rem;
            border-bottom: 1px solid var(--border);
            color: var(--text-secondary);
        }

        .table tbody tr {
            transition: background 0.2s ease;
        }

        .table tbody tr:hover {
            background: var(--bg-hover);
        }

        /* Badges */
        .badge {
            display: inline-block;
            padding: 0.4rem 0.8rem;
            border-radius: 6px;
            font-size: 0.75rem;
            font-weight: 700;
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }

        .badge-success {
            background: rgba(6, 214, 160, 0.2);
            color: var(--success);
            border: 1px solid var(--success);
        }

        .badge-warning {
            background: rgba(252, 163, 17, 0.2);
            color: var(--warning);
            border: 1px solid var(--warning);
        }

        .badge-danger {
            background: rgba(239, 71, 111, 0.2);
            color: var(--danger);
            border: 1px solid var(--danger);
        }

        .badge-info {
            background: rgba(0, 78, 137, 0.2);
            color: var(--secondary);
            border: 1px solid var(--secondary);
        }

        /* Modal */
        .modal-overlay {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: rgba(10, 14, 39, 0.9);
            backdrop-filter: blur(8px);
            display: flex;
            align-items: center;
            justify-content: center;
            z-index: 1000;
            animation: fadeIn 0.3s ease;
        }

        @keyframes fadeIn {
            from { opacity: 0; }
            to { opacity: 1; }
        }

        .modal {
            background: var(--bg-card);
            border: 2px solid var(--border);
            border-radius: 20px;
            padding: 2rem;
            max-width: 600px;
            width: 90%;
            max-height: 90vh;
            overflow-y: auto;
            animation: slideUp 0.3s ease;
            box-shadow: 0 20px 60px rgba(0, 0, 0, 0.5);
        }

        @keyframes slideUp {
            from {
                transform: translateY(50px);
                opacity: 0;
            }
            to {
                transform: translateY(0);
                opacity: 1;
            }
        }

        .modal-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 1.5rem;
            padding-bottom: 1rem;
            border-bottom: 2px solid var(--border);
        }

        .modal-title {
            font-size: 1.5rem;
            font-weight: 700;
        }

        .modal-close {
            background: transparent;
            border: none;
            color: var(--text-secondary);
            font-size: 1.5rem;
            cursor: pointer;
            padding: 0.5rem;
            line-height: 1;
            transition: color 0.3s ease;
        }

        .modal-close:hover {
            color: var(--danger);
        }

        .modal-footer {
            display: flex;
            gap: 1rem;
            justify-content: flex-end;
            margin-top: 2rem;
            padding-top: 1rem;
            border-top: 2px solid var(--border);
        }

        /* Route Visualization */
        .route-map {
            background: var(--bg-dark);
            border-radius: 12px;
            padding: 2rem;
            min-height: 300px;
            display: flex;
            flex-direction: column;
            gap: 1rem;
            position: relative;
            overflow: hidden;
        }

        .route-map::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: 
                linear-gradient(90deg, var(--border) 1px, transparent 1px),
                linear-gradient(0deg, var(--border) 1px, transparent 1px);
            background-size: 40px 40px;
            opacity: 0.3;
        }

        .route-item {
            background: var(--bg-card);
            border: 2px solid var(--border);
            border-left: 4px solid var(--primary);
            border-radius: 10px;
            padding: 1rem;
            display: flex;
            align-items: center;
            gap: 1rem;
            position: relative;
            z-index: 1;
            transition: all 0.3s ease;
        }

        .route-item:hover {
            border-left-color: var(--accent);
            transform: translateX(5px);
        }

        .route-number {
            width: 40px;
            height: 40px;
            background: linear-gradient(135deg, var(--primary) 0%, var(--primary-dark) 100%);
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: 800;
            font-family: 'JetBrains Mono', monospace;
            flex-shrink: 0;
        }

        .route-details {
            flex: 1;
        }

        .route-location {
            font-weight: 600;
            margin-bottom: 0.25rem;
        }

        .route-time {
            font-size: 0.85rem;
            color: var(--text-muted);
            font-family: 'JetBrains Mono', monospace;
        }

        .route-volume {
            font-weight: 700;
            color: var(--accent);
            font-family: 'JetBrains Mono', monospace;
        }

        /* Scrollbar */
        ::-webkit-scrollbar {
            width: 10px;
            height: 10px;
        }

        ::-webkit-scrollbar-track {
            background: var(--bg-dark);
        }

        ::-webkit-scrollbar-thumb {
            background: var(--border);
            border-radius: 5px;
        }

        ::-webkit-scrollbar-thumb:hover {
            background: var(--primary);
        }

        /* Loading Animation */
        .loading {
            display: inline-block;
            width: 20px;
            height: 20px;
            border: 3px solid rgba(255, 255, 255, 0.3);
            border-radius: 50%;
            border-top-color: var(--primary);
            animation: spin 1s ease-in-out infinite;
        }

        @keyframes spin {
            to { transform: rotate(360deg); }
        }

        /* Truck Marker Pulse */
        @keyframes marker-pulse {
            0%, 100% {
                transform: scale(1);
                opacity: 1;
            }
            50% {
                transform: scale(1.1);
                opacity: 0.8;
            }
        }

        .truck-marker-pulse {
            animation: marker-pulse 2s ease-in-out infinite;
        }

        /* Responsive */
        @media (max-width: 768px) {
            .header {
                flex-direction: column;
                gap: 1rem;
            }

            .nav-tabs {
                width: 100%;
                overflow-x: auto;
            }

            .main-content {
                padding: 1rem;
            }

            .dashboard-grid {
                grid-template-columns: 1fr;
            }

            .form-row {
                grid-template-columns: 1fr;
            }

            .map-container {
                height: 400px;
            }

            .map-legend {
                bottom: 1rem;
                right: 1rem;
                font-size: 0.8rem;
            }
        }

        /* iPad and Tablet Optimizations */
        @media (min-width: 768px) and (max-width: 1024px) {
            .dashboard-grid {
                grid-template-columns: repeat(2, 1fr);
            }

            .nav-tabs {
                overflow-x: auto;
                white-space: nowrap;
            }

            .table-container {
                overflow-x: auto;
                -webkit-overflow-scrolling: touch;
            }
        }

        /* Touch-friendly styles */
        @media (hover: none) and (pointer: coarse) {
            .btn {
                min-height: 44px;
                min-width: 44px;
            }

            .form-input,
            .form-select,
            .form-textarea {
                min-height: 44px;
                font-size: 16px; /* Prevent iOS zoom */
            }

            .nav-tab {
                min-height: 44px;
                padding: 1rem 1.5rem;
            }

            .table th,
            .table td {
                padding: 1rem;
            }
        }

        /* Large touch targets for mobile */
        .touch-target {
            min-height: 48px;
            min-width: 48px;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        /* Mobile menu */
        .mobile-menu-toggle {
            display: none;
            background: var(--primary);
            border: none;
            color: white;
            font-size: 1.5rem;
            padding: 0.5rem;
            border-radius: 8px;
            cursor: pointer;
        }

        @media (max-width: 768px) {
            .mobile-menu-toggle {
                display: block;
            }

            .nav-tabs {
                display: none;
                position: absolute;
                top: 100%;
                left: 0;
                right: 0;
                background: var(--bg-card);
                border: 2px solid var(--border);
                border-top: none;
                flex-direction: column;
                z-index: 99;
            }

            .nav-tabs.mobile-open {
                display: flex;
            }

            .nav-tab {
                width: 100%;
                text-align: left;
                border-radius: 0;
            }
        }

        /* Driver Mode Styles */
        .driver-mode {
            background: linear-gradient(135deg, var(--success) 0%, #05B589 100%);
            color: white;
            padding: 1rem 1.5rem;
            border-radius: 12px;
            margin-bottom: 1.5rem;
            display: flex;
            align-items: center;
            justify-content: space-between;
            box-shadow: 0 4px 15px rgba(6, 214, 160, 0.3);
        }

        .driver-mode-badge {
            background: rgba(255, 255, 255, 0.2);
            padding: 0.5rem 1rem;
            border-radius: 8px;
            font-weight: 700;
            font-size: 0.9rem;
        }

        /* Quick action buttons for mobile */
        .quick-actions {
            position: fixed;
            bottom: 2rem;
            right: 2rem;
            z-index: 50;
        }

        .fab-button {
            width: 60px;
            height: 60px;
            border-radius: 50%;
            background: linear-gradient(135deg, var(--primary) 0%, var(--primary-dark) 100%);
            border: none;
            color: white;
            font-size: 1.5rem;
            box-shadow: 0 8px 24px rgba(255, 107, 53, 0.4);
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: all 0.3s ease;
        }

        .fab-button:hover {
            transform: scale(1.1);
            box-shadow: 0 12px 32px rgba(255, 107, 53, 0.5);
        }

        @media (max-width: 768px) {
            .quick-actions {
                bottom: 1rem;
                right: 1rem;
            }

            .fab-button {
                width: 56px;
                height: 56px;
            }
        }
    </style>
</head>
<body>
    <div class="bg-pattern"></div>
    <div id="root"></div>

    <script type="text/babel">
        const { useState, useEffect, useRef } = React;

        // Global fuel price (can be updated by management)
        const DIESEL_PRICE_PER_GALLON = 3.45;

        // Cost calculation function
        const calculateRouteCosts = (route, truck, driver) => {
            if (!route || !truck || !driver) return null;

            const distance = route.totalDistance || 0;
            const duration = route.totalDuration || 0; // in minutes
            const durationHours = duration / 60;

            // Calculate individual costs
            const fuelCost = (distance / truck.fuelMPG) * DIESEL_PRICE_PER_GALLON;
            const maintenanceCost = distance * truck.maintenanceCostPerMile;
            const driverCost = durationHours * driver.hourlyRate;
            const insuranceCost = truck.insuranceCostPerDay / 24 * durationHours; // Pro-rated hourly

            // Total cost
            const totalCost = fuelCost + maintenanceCost + driverCost + insuranceCost;

            // Revenue and profit
            const revenue = route.totalRevenue || 0;
            const profit = revenue - totalCost;
            const profitMargin = revenue > 0 ? (profit / revenue * 100) : 0;

            return {
                fuelCost: parseFloat(fuelCost.toFixed(2)),
                maintenanceCost: parseFloat(maintenanceCost.toFixed(2)),
                driverCost: parseFloat(driverCost.toFixed(2)),
                insuranceCost: parseFloat(insuranceCost.toFixed(2)),
                totalCost: parseFloat(totalCost.toFixed(2)),
                revenue: parseFloat(revenue.toFixed(2)),
                profit: parseFloat(profit.toFixed(2)),
                profitMargin: parseFloat(profitMargin.toFixed(2))
            };
        };

        // Route Optimization Utilities
        // Calculate distance between two points using Haversine formula
        const calculateDistance = (lat1, lng1, lat2, lng2) => {
            const R = 3959; // Earth's radius in miles
            const dLat = (lat2 - lat1) * Math.PI / 180;
            const dLng = (lng2 - lng1) * Math.PI / 180;
            const a = Math.sin(dLat/2) * Math.sin(dLat/2) +
                      Math.cos(lat1 * Math.PI / 180) * Math.cos(lat2 * Math.PI / 180) *
                      Math.sin(dLng/2) * Math.sin(dLng/2);
            const c = 2 * Math.atan2(Math.sqrt(a), Math.sqrt(1-a));
            return R * c;
        };

        // Estimate travel time based on distance (assumes average 35 mph for delivery routes)
        const estimateTravelTime = (distanceMiles) => {
            const avgSpeed = 35; // mph for delivery driving with stops/turns
            return Math.round((distanceMiles / avgSpeed) * 60); // returns minutes
        };

        // Nearest Neighbor Algorithm for route optimization
        const optimizeRouteStops = (stops, orders, startLat, startLng) => {
            if (!stops || stops.length <= 1) return stops;
            
            // Get order locations
            const stopsWithLocations = stops.map(stop => {
                const order = orders.find(o => o.id === stop.orderId);
                return {
                    ...stop,
                    lat: order?.lat || 0,
                    lng: order?.lng || 0,
                    customer: order?.customer || 'Unknown'
                };
            });

            const optimized = [];
            const remaining = [...stopsWithLocations];
            let currentLat = startLat;
            let currentLng = startLng;
            let totalDistance = 0;
            let totalTime = 0;
            let currentTime = new Date();
            currentTime.setHours(8, 0, 0, 0); // Start at 8 AM

            while (remaining.length > 0) {
                // Find nearest stop
                let nearestIndex = 0;
                let nearestDistance = Infinity;
                
                remaining.forEach((stop, index) => {
                    const dist = calculateDistance(currentLat, currentLng, stop.lat, stop.lng);
                    if (dist < nearestDistance) {
                        nearestDistance = dist;
                        nearestIndex = index;
                    }
                });

                const nextStop = remaining.splice(nearestIndex, 1)[0];
                const travelMinutes = estimateTravelTime(nearestDistance);
                
                // Update times
                currentTime = new Date(currentTime.getTime() + travelMinutes * 60000);
                const estimatedTime = currentTime.toTimeString().slice(0, 5);
                
                // Add stop duration (average 30 min per delivery)
                currentTime = new Date(currentTime.getTime() + 30 * 60000);
                
                totalDistance += nearestDistance;
                totalTime += travelMinutes + 30;

                optimized.push({
                    ...nextStop,
                    sequence: optimized.length + 1,
                    estimatedTime: estimatedTime,
                    distance: Math.round(nearestDistance * 10) / 10,
                    duration: 30
                });

                currentLat = nextStop.lat;
                currentLng = nextStop.lng;
            }

            return {
                stops: optimized,
                totalDistance: Math.round(totalDistance),
                totalDuration: totalTime,
                savings: null // Will be calculated by comparing to original
            };
        };

        // Calculate route metrics
        const calculateRouteMetrics = (stops, orders, dcLat, dcLng) => {
            if (!stops || stops.length === 0) return { totalDistance: 0, totalTime: 0 };
            
            let totalDistance = 0;
            let prevLat = dcLat;
            let prevLng = dcLng;

            stops.forEach(stop => {
                const order = orders.find(o => o.id === stop.orderId);
                if (order?.lat && order?.lng) {
                    totalDistance += calculateDistance(prevLat, prevLng, order.lat, order.lng);
                    prevLat = order.lat;
                    prevLng = order.lng;
                }
            });

            // Add return to DC
            totalDistance += calculateDistance(prevLat, prevLng, dcLat, dcLng);

            return {
                totalDistance: Math.round(totalDistance),
                totalTime: estimateTravelTime(totalDistance) + (stops.length * 30) // travel + stop time
            };
        };

        // Security Roles Configuration
        const ROLES = {
            ADMIN: 'admin',
            DRIVER: 'driver',
            DISPATCH: 'dispatch',
            ACCOUNTING: 'accounting',
            PAYROLL: 'payroll'
        };

        // Role permissions define which tabs/features each role can access
        const ROLE_PERMISSIONS = {
            [ROLES.ADMIN]: {
                name: 'System Administrator',
                description: 'Full system access - can manage all features',
                tabs: ['dashboard', 'orders', 'routes', 'fleet', 'customers', 'inventory', 'employees', 'reports', 'management', 'payments'],
                canEdit: true,
                canDelete: true,
                canCreate: true,
                canViewAllDCs: true,
                canManageUsers: true,
                canViewPayroll: true,
                canViewAccounting: true,
                canManageRoutes: true,
                canCollectPayments: true
            },
            [ROLES.DRIVER]: {
                name: 'Driver',
                description: 'Access to assigned routes, customer delivery info, and payment collection',
                tabs: ['dashboard'],
                canEdit: false,
                canDelete: false,
                canCreate: false,
                canViewAllDCs: false,
                canManageUsers: false,
                canViewPayroll: false,
                canViewAccounting: false,
                canManageRoutes: false,
                canCollectPayments: true,
                driverModeOnly: true,
                canUpdateStopStatus: true,
                canViewCustomerInfo: true,
                canRecordDelivery: true,
                canCollectSignature: true
            },
            [ROLES.DISPATCH]: {
                name: 'Dispatch Manager',
                description: 'Manage routes, assign drivers, and monitor fleet operations',
                tabs: ['dashboard', 'orders', 'routes', 'fleet', 'customers'],
                canEdit: true,
                canDelete: false,
                canCreate: true,
                canViewAllDCs: true,
                canManageUsers: false,
                canViewPayroll: false,
                canViewAccounting: false,
                canManageRoutes: true,
                canCollectPayments: false,
                canAssignDrivers: true,
                canModifyRoutes: true,
                canAddStops: true,
                canReorderStops: true
            },
            [ROLES.ACCOUNTING]: {
                name: 'Accounting',
                description: 'View payments, revenue, and financial reports',
                tabs: ['dashboard', 'payments', 'reports'],
                canEdit: false,
                canDelete: false,
                canCreate: false,
                canViewAllDCs: true,
                canManageUsers: false,
                canViewPayroll: false,
                canViewAccounting: true,
                canManageRoutes: false,
                canCollectPayments: false,
                canViewRevenue: true,
                canViewPayments: true,
                canExportReports: true,
                canProcessRefunds: true
            },
            [ROLES.PAYROLL]: {
                name: 'Payroll Administrator',
                description: 'Manage employee information, pay rates, and benefits',
                tabs: ['dashboard', 'employees', 'reports'],
                canEdit: true,
                canDelete: false,
                canCreate: true,
                canViewAllDCs: true,
                canManageUsers: false,
                canViewPayroll: true,
                canViewAccounting: false,
                canManageRoutes: false,
                canCollectPayments: false,
                canEditPayRates: true,
                canEditBenefits: true,
                canViewSSN: true,
                canManageDirectDeposit: true,
                canRunPayroll: true
            }
        };

        // System Users - In production, this would come from a database
        const systemUsers = [
            { 
                id: 'USR-001', 
                username: 'admin', 
                password: 'admin123', 
                role: ROLES.ADMIN, 
                name: 'System Administrator',
                email: 'admin@routecrmpro.com',
                dcId: null, // null means all DCs
                driverId: null,
                avatar: 'üë®‚Äçüíº',
                lastLogin: '2026-01-15 08:00:00'
            },
            { 
                id: 'USR-002', 
                username: 'jsmith', 
                password: 'driver123', 
                role: ROLES.DRIVER, 
                name: 'John Smith',
                email: 'jsmith@routecrmpro.com',
                dcId: 'DC-AL-001',
                driverId: 'DRV001',
                avatar: 'üöö',
                lastLogin: '2026-01-15 06:30:00'
            },
            { 
                id: 'USR-003', 
                username: 'sjohnson', 
                password: 'driver123', 
                role: ROLES.DRIVER, 
                name: 'Sarah Johnson',
                email: 'sjohnson@routecrmpro.com',
                dcId: 'DC-FL-001',
                driverId: 'DRV002',
                avatar: 'üöö',
                lastLogin: '2026-01-15 06:00:00'
            },
            { 
                id: 'USR-004', 
                username: 'mwilliams', 
                password: 'driver123', 
                role: ROLES.DRIVER, 
                name: 'Mike Williams',
                email: 'mwilliams@routecrmpro.com',
                dcId: 'DC-GA-001',
                driverId: 'DRV003',
                avatar: 'üöö',
                lastLogin: '2026-01-15 07:00:00'
            },
            { 
                id: 'USR-005', 
                username: 'edavis', 
                password: 'driver123', 
                role: ROLES.DRIVER, 
                name: 'Emily Davis',
                email: 'edavis@routecrmpro.com',
                dcId: 'DC-TN-001',
                driverId: 'DRV004',
                avatar: 'üöö',
                lastLogin: '2026-01-15 06:45:00'
            },
            { 
                id: 'USR-006', 
                username: 'dispatch', 
                password: 'dispatch123', 
                role: ROLES.DISPATCH, 
                name: 'Robert Martinez',
                email: 'rmartinez@routecrmpro.com',
                dcId: null, // Can see all DCs
                driverId: null,
                avatar: 'üìã',
                lastLogin: '2026-01-15 05:30:00'
            },
            { 
                id: 'USR-007', 
                username: 'dispatch_al', 
                password: 'dispatch123', 
                role: ROLES.DISPATCH, 
                name: 'Lisa Anderson',
                email: 'landerson@routecrmpro.com',
                dcId: 'DC-AL-001', // Alabama DCs only
                driverId: null,
                avatar: 'üìã',
                lastLogin: '2026-01-15 05:45:00'
            },
            { 
                id: 'USR-008', 
                username: 'accounting', 
                password: 'accounting123', 
                role: ROLES.ACCOUNTING, 
                name: 'Jennifer Thompson',
                email: 'jthompson@routecrmpro.com',
                dcId: null,
                driverId: null,
                avatar: 'üí∞',
                lastLogin: '2026-01-15 08:30:00'
            },
            { 
                id: 'USR-009', 
                username: 'payroll', 
                password: 'payroll123', 
                role: ROLES.PAYROLL, 
                name: 'David Wilson',
                email: 'dwilson@routecrmpro.com',
                dcId: null,
                driverId: null,
                avatar: 'üìä',
                lastLogin: '2026-01-14 16:00:00'
            }
        ];

        // Sample initial data with GPS coordinates - Southeast Region
        const initialData = {
            distributionCenters: [
                { 
                    id: 'DC-AL-001', 
                    name: 'Auburn Distribution Center', 
                    address: '123 Industrial Pkwy', 
                    city: 'Auburn',
                    state: 'Alabama',
                    lat: 32.6099,
                    lng: -85.4808
                },
                { 
                    id: 'DC-AL-002', 
                    name: 'Birmingham Distribution Center', 
                    address: '456 Commerce Ave', 
                    city: 'Birmingham',
                    state: 'Alabama',
                    lat: 33.5186,
                    lng: -86.8104
                },
                { 
                    id: 'DC-GA-001', 
                    name: 'Atlanta Distribution Center', 
                    address: '789 Peachtree Industrial Blvd', 
                    city: 'Atlanta',
                    state: 'Georgia',
                    lat: 33.7490,
                    lng: -84.3880
                },
                { 
                    id: 'DC-FL-001', 
                    name: 'Jacksonville Distribution Center', 
                    address: '321 Gateway Pkwy', 
                    city: 'Jacksonville',
                    state: 'Florida',
                    lat: 30.3322,
                    lng: -81.6557
                },
                { 
                    id: 'DC-FL-002', 
                    name: 'Tampa Distribution Center', 
                    address: '555 Cargo Rd', 
                    city: 'Tampa',
                    state: 'Florida',
                    lat: 27.9506,
                    lng: -82.4572
                },
                { 
                    id: 'DC-TN-001', 
                    name: 'Nashville Distribution Center', 
                    address: '888 Music City Way', 
                    city: 'Nashville',
                    state: 'Tennessee',
                    lat: 36.1627,
                    lng: -86.7816
                },
                { 
                    id: 'DC-SC-001', 
                    name: 'Columbia Distribution Center', 
                    address: '234 Palmetto Pkwy', 
                    city: 'Columbia',
                    state: 'South Carolina',
                    lat: 34.0007,
                    lng: -81.0348
                },
                { 
                    id: 'DC-NC-001', 
                    name: 'Charlotte Distribution Center', 
                    address: '678 Trade St', 
                    city: 'Charlotte',
                    state: 'North Carolina',
                    lat: 35.2271,
                    lng: -80.8431
                },
                { 
                    id: 'DC-MS-001', 
                    name: 'Jackson Distribution Center', 
                    address: '901 Delta Dr', 
                    city: 'Jackson',
                    state: 'Mississippi',
                    lat: 32.2988,
                    lng: -90.1848
                },
                { 
                    id: 'DC-LA-001', 
                    name: 'Baton Rouge Distribution Center', 
                    address: '445 River Rd', 
                    city: 'Baton Rouge',
                    state: 'Louisiana',
                    lat: 30.4515,
                    lng: -91.1871
                },
                { 
                    id: 'DC-KY-001', 
                    name: 'Louisville Distribution Center', 
                    address: '777 Bourbon Way', 
                    city: 'Louisville',
                    state: 'Kentucky',
                    lat: 38.2527,
                    lng: -85.7585
                }
            ],
            trucks: [
                // Alabama - Auburn DC
                { 
                    id: 'TRK-AL-001', 
                    name: 'Auburn Alpha', 
                    capacity: 3000, 
                    dcId: 'DC-AL-001', 
                    status: 'active',
                    currentLat: 32.6000,
                    currentLng: -85.4700,
                    speed: 45,
                    lastUpdate: '2 min ago',
                    gpsDeviceId: 'VZ-GPS-8473-AA',
                    gpsProvider: 'Verizon Connect',
                    vin: '1HGBH41JXMN109186',
                    licensePlate: 'AL-TRK-001',
                    maintenanceCostPerMile: 0.45,
                    fuelMPG: 6.5,
                    insuranceCostPerDay: 42.50
                },
                { 
                    id: 'TRK-AL-002', 
                    name: 'Auburn Beta', 
                    capacity: 3500, 
                    dcId: 'DC-AL-001', 
                    status: 'active',
                    currentLat: 32.5900,
                    currentLng: -85.4600,
                    speed: 52,
                    lastUpdate: '1 min ago',
                    gpsDeviceId: 'VZ-GPS-8473-AB',
                    gpsProvider: 'Verizon Connect',
                    vin: '1HGBH41JXMN109187',
                    licensePlate: 'AL-TRK-002',
                    maintenanceCostPerMile: 0.48,
                    fuelMPG: 6.2,
                    insuranceCostPerDay: 42.50
                },
                // Alabama - Birmingham DC
                { 
                    id: 'TRK-AL-003', 
                    name: 'Birmingham Gamma', 
                    capacity: 2800, 
                    dcId: 'DC-AL-002', 
                    status: 'active',
                    currentLat: 33.5100,
                    currentLng: -86.8000,
                    speed: 38,
                    lastUpdate: '3 min ago',
                    gpsDeviceId: 'VZ-GPS-8473-BA',
                    gpsProvider: 'Verizon Connect',
                    vin: '1HGBH41JXMN109188',
                    licensePlate: 'AL-TRK-003',
                    maintenanceCostPerMile: 0.52,
                    fuelMPG: 5.8,
                    insuranceCostPerDay: 42.50
                },
                { 
                    id: 'TRK-AL-004', 
                    name: 'Birmingham Delta', 
                    capacity: 3200, 
                    dcId: 'DC-AL-002', 
                    status: 'maintenance',
                    currentLat: 33.5186,
                    currentLng: -86.8104,
                    speed: 0,
                    lastUpdate: '15 min ago',
                    gpsDeviceId: 'VZ-GPS-8473-BB',
                    gpsProvider: 'Verizon Connect',
                    vin: '1HGBH41JXMN109189',
                    licensePlate: 'AL-TRK-004',
                    maintenanceCostPerMile: 0.55,
                    fuelMPG: 5.5,
                    insuranceCostPerDay: 42.50
                },
                // Georgia - Atlanta DC
                { 
                    id: 'TRK-GA-001', 
                    name: 'Atlanta Eagle', 
                    capacity: 3400, 
                    dcId: 'DC-GA-001', 
                    status: 'active',
                    currentLat: 33.7400,
                    currentLng: -84.3800,
                    speed: 48,
                    lastUpdate: '1 min ago',
                    gpsDeviceId: 'VZ-GPS-8473-GA',
                    gpsProvider: 'Verizon Connect',
                    vin: '1HGBH41JXMN109190',
                    licensePlate: 'GA-TRK-001',
                    maintenanceCostPerMile: 0.42,
                    fuelMPG: 6.8,
                    insuranceCostPerDay: 42.50
                },
                { 
                    id: 'TRK-GA-002', 
                    name: 'Atlanta Falcon', 
                    capacity: 3100, 
                    dcId: 'DC-GA-001', 
                    status: 'active',
                    currentLat: 33.7600,
                    currentLng: -84.4000,
                    speed: 55,
                    lastUpdate: '4 min ago',
                    gpsDeviceId: 'VZ-GPS-8473-GB',
                    gpsProvider: 'Verizon Connect',
                    vin: '1HGBH41JXMN109191',
                    licensePlate: 'GA-TRK-002',
                    maintenanceCostPerMile: 0.46,
                    fuelMPG: 6.4,
                    insuranceCostPerDay: 42.50
                },
                // Florida - Jacksonville DC
                { 
                    id: 'TRK-FL-001', 
                    name: 'Jacksonville Jaguar', 
                    capacity: 3300, 
                    dcId: 'DC-FL-001', 
                    status: 'active',
                    currentLat: 30.3250,
                    currentLng: -81.6500,
                    speed: 42,
                    lastUpdate: '2 min ago',
                    gpsDeviceId: 'VZ-GPS-8473-FA',
                    gpsProvider: 'Verizon Connect',
                    vin: '1HGBH41JXMN109192',
                    licensePlate: 'FL-TRK-001',
                    maintenanceCostPerMile: 0.44,
                    fuelMPG: 6.6,
                    insuranceCostPerDay: 42.50
                },
                { 
                    id: 'TRK-FL-002', 
                    name: 'Jacksonville Marlin', 
                    capacity: 2900, 
                    dcId: 'DC-FL-001', 
                    status: 'active',
                    currentLat: 30.3400,
                    currentLng: -81.6600,
                    speed: 50,
                    lastUpdate: '5 min ago',
                    gpsDeviceId: 'VZ-GPS-8473-FB',
                    gpsProvider: 'Verizon Connect',
                    vin: '1HGBH41JXMN109193',
                    licensePlate: 'FL-TRK-002',
                    maintenanceCostPerMile: 0.50,
                    fuelMPG: 6.0,
                    insuranceCostPerDay: 42.50
                },
                // Florida - Tampa DC
                { 
                    id: 'TRK-FL-003', 
                    name: 'Tampa Thunder', 
                    capacity: 3600, 
                    dcId: 'DC-FL-002', 
                    status: 'active',
                    currentLat: 27.9450,
                    currentLng: -82.4500,
                    speed: 47,
                    lastUpdate: '1 min ago',
                    gpsDeviceId: 'VZ-GPS-8473-FC',
                    gpsProvider: 'Verizon Connect',
                    vin: '1HGBH41JXMN109194',
                    licensePlate: 'FL-TRK-003',
                    maintenanceCostPerMile: 0.41,
                    fuelMPG: 7.0,
                    insuranceCostPerDay: 42.50
                },
                // Tennessee - Nashville DC
                { 
                    id: 'TRK-TN-001', 
                    name: 'Nashville Titan', 
                    capacity: 3250, 
                    dcId: 'DC-TN-001', 
                    status: 'active',
                    currentLat: 36.1550,
                    currentLng: -86.7750,
                    speed: 44,
                    lastUpdate: '3 min ago',
                    gpsDeviceId: 'VZ-GPS-8473-TA',
                    gpsProvider: 'Verizon Connect',
                    vin: '1HGBH41JXMN109195',
                    licensePlate: 'TN-TRK-001',
                    maintenanceCostPerMile: 0.47,
                    fuelMPG: 6.3,
                    insuranceCostPerDay: 42.50
                },
                // South Carolina - Columbia DC
                { 
                    id: 'TRK-SC-001', 
                    name: 'Columbia Palmetto', 
                    capacity: 2950, 
                    dcId: 'DC-SC-001', 
                    status: 'active',
                    currentLat: 34.0050,
                    currentLng: -81.0300,
                    speed: 41,
                    lastUpdate: '2 min ago',
                    gpsDeviceId: 'VZ-GPS-8473-SA',
                    gpsProvider: 'Verizon Connect',
                    vin: '1HGBH41JXMN109196',
                    licensePlate: 'SC-TRK-001',
                    maintenanceCostPerMile: 0.49,
                    fuelMPG: 6.1,
                    insuranceCostPerDay: 42.50
                },
                // North Carolina - Charlotte DC
                { 
                    id: 'TRK-NC-001', 
                    name: 'Charlotte Panther', 
                    capacity: 3150, 
                    dcId: 'DC-NC-001', 
                    status: 'active',
                    currentLat: 35.2200,
                    currentLng: -80.8400,
                    speed: 53,
                    lastUpdate: '1 min ago',
                    gpsDeviceId: 'VZ-GPS-8473-NA',
                    gpsProvider: 'Verizon Connect',
                    vin: '1HGBH41JXMN109197',
                    licensePlate: 'NC-TRK-001',
                    maintenanceCostPerMile: 0.43,
                    fuelMPG: 6.7,
                    insuranceCostPerDay: 42.50
                }
            ],
            drivers: [
                { 
                    id: 'DRV001', 
                    name: 'John Smith', 
                    firstName: 'John',
                    lastName: 'Smith',
                    email: 'jsmith@routecrmpro.com',
                    phone: '(334) 555-1001',
                    dateOfBirth: '1985-03-15',
                    ssn: '***-**-4521',
                    address: '123 Main Street',
                    city: 'Auburn',
                    state: 'Alabama',
                    zipCode: '36830',
                    emergencyContact: 'Mary Smith',
                    emergencyPhone: '(334) 555-1002',
                    hireDate: '2020-06-15',
                    employeeType: 'Full-Time',
                    department: 'Delivery',
                    licenseNumber: 'CDL-AL-789456',
                    licenseClass: 'Class A',
                    licenseState: 'Alabama',
                    licenseExpiration: '2027-03-15',
                    endorsements: ['Safety', 'Cargo'],
                    restrictions: [],
                    medicalCardExpiration: '2026-06-15',
                    medicalCardStatus: 'Valid',
                    hourlyRate: 28,
                    overtimeRate: 42,
                    status: 'available',
                    backgroundCheckStatus: 'Cleared',
                    backgroundCheckDate: '2020-06-01',
                    backgroundCheckProvider: 'Checkr',
                    licenseVerificationStatus: 'Verified',
                    licenseVerificationDate: '2024-01-15',
                    drugTestStatus: 'Passed',
                    drugTestDate: '2024-12-01',
                    mvrStatus: 'Clear',
                    mvrDate: '2024-01-15',
                    trainingCompleted: ['Safety Safety', 'Defensive Driving', 'Product Handling'],
                    profilePhoto: null,
                    // Payroll Information
                    payrollId: 'PAY-001',
                    payFrequency: 'Bi-Weekly',
                    federalFilingStatus: 'Married Filing Jointly',
                    federalAllowances: 3,
                    stateFilingStatus: 'Married',
                    stateAllowances: 3,
                    additionalWithholding: 0,
                    // Direct Deposit
                    directDeposit: {
                        enabled: true,
                        bankName: 'Regions Bank',
                        accountType: 'Checking',
                        routingNumber: '****6789',
                        accountNumber: '****4521',
                        depositPercent: 100
                    },
                    // YTD Earnings
                    ytdEarnings: {
                        grossPay: 58240,
                        regularHours: 1920,
                        overtimeHours: 120,
                        overtimePay: 5040,
                        federalTax: 6988,
                        stateTax: 2912,
                        socialSecurity: 3611,
                        medicare: 844,
                        netPay: 43885
                    }
                },
                { 
                    id: 'DRV002', 
                    name: 'Sarah Johnson', 
                    firstName: 'Sarah',
                    lastName: 'Johnson',
                    email: 'sjohnson@routecrmpro.com',
                    phone: '(404) 555-2001',
                    dateOfBirth: '1990-07-22',
                    ssn: '***-**-7832',
                    address: '456 Peachtree Ave',
                    city: 'Atlanta',
                    state: 'Georgia',
                    zipCode: '30303',
                    emergencyContact: 'Tom Johnson',
                    emergencyPhone: '(404) 555-2002',
                    hireDate: '2021-03-01',
                    employeeType: 'Full-Time',
                    department: 'Delivery',
                    licenseNumber: 'CDL-GA-234567',
                    licenseClass: 'Class A',
                    licenseState: 'Georgia',
                    licenseExpiration: '2026-07-22',
                    endorsements: ['Safety', 'Cargo', 'Doubles/Triples'],
                    restrictions: [],
                    medicalCardExpiration: '2026-03-01',
                    medicalCardStatus: 'Valid',
                    hourlyRate: 32,
                    overtimeRate: 48,
                    status: 'available',
                    backgroundCheckStatus: 'Cleared',
                    backgroundCheckDate: '2021-02-15',
                    backgroundCheckProvider: 'Checkr',
                    licenseVerificationStatus: 'Verified',
                    licenseVerificationDate: '2024-02-20',
                    drugTestStatus: 'Passed',
                    drugTestDate: '2024-11-15',
                    mvrStatus: 'Clear',
                    mvrDate: '2024-02-20',
                    trainingCompleted: ['Safety Safety', 'Defensive Driving', 'Product Handling', 'Customer Service'],
                    profilePhoto: null,
                    payrollId: 'PAY-002',
                    payFrequency: 'Bi-Weekly',
                    federalFilingStatus: 'Single',
                    federalAllowances: 1,
                    stateFilingStatus: 'Single',
                    stateAllowances: 1,
                    additionalWithholding: 50,
                    directDeposit: {
                        enabled: true,
                        bankName: 'Bank of America',
                        accountType: 'Checking',
                        routingNumber: '****1234',
                        accountNumber: '****7832',
                        depositPercent: 100
                    },
                    ytdEarnings: {
                        grossPay: 66560,
                        regularHours: 1920,
                        overtimeHours: 140,
                        overtimePay: 6720,
                        federalTax: 9318,
                        stateTax: 3994,
                        socialSecurity: 4127,
                        medicare: 965,
                        netPay: 48156
                    }
                },
                { 
                    id: 'DRV003', 
                    name: 'Mike Brown', 
                    firstName: 'Mike',
                    lastName: 'Brown',
                    email: 'mbrown@routecrmpro.com',
                    phone: '(904) 555-3001',
                    dateOfBirth: '1982-11-08',
                    ssn: '***-**-9156',
                    address: '789 Beach Blvd',
                    city: 'Jacksonville',
                    state: 'Florida',
                    zipCode: '32250',
                    emergencyContact: 'Linda Brown',
                    emergencyPhone: '(904) 555-3002',
                    hireDate: '2019-01-10',
                    employeeType: 'Full-Time',
                    department: 'Delivery',
                    licenseNumber: 'CDL-FL-345678',
                    licenseClass: 'Class A',
                    licenseState: 'Florida',
                    licenseExpiration: '2025-11-08',
                    endorsements: ['Safety', 'Cargo'],
                    restrictions: [],
                    medicalCardExpiration: '2025-07-10',
                    medicalCardStatus: 'Valid',
                    hourlyRate: 30,
                    overtimeRate: 45,
                    status: 'on-route',
                    backgroundCheckStatus: 'Cleared',
                    backgroundCheckDate: '2019-01-05',
                    backgroundCheckProvider: 'Checkr',
                    licenseVerificationStatus: 'Verified',
                    licenseVerificationDate: '2024-03-10',
                    drugTestStatus: 'Passed',
                    drugTestDate: '2024-10-20',
                    mvrStatus: 'Clear',
                    mvrDate: '2024-03-10',
                    trainingCompleted: ['Safety Safety', 'Defensive Driving', 'Product Handling', 'First Aid'],
                    profilePhoto: null,
                    payrollId: 'PAY-003',
                    payFrequency: 'Weekly',
                    federalFilingStatus: 'Married Filing Jointly',
                    federalAllowances: 4,
                    stateFilingStatus: 'Married',
                    stateAllowances: 4,
                    additionalWithholding: 0,
                    directDeposit: {
                        enabled: true,
                        bankName: 'Wells Fargo',
                        accountType: 'Checking',
                        routingNumber: '****5678',
                        accountNumber: '****9156',
                        depositPercent: 80
                    },
                    secondaryDeposit: {
                        enabled: true,
                        bankName: 'Wells Fargo',
                        accountType: 'Savings',
                        routingNumber: '****5678',
                        accountNumber: '****9157',
                        depositPercent: 20
                    },
                    ytdEarnings: {
                        grossPay: 62400,
                        regularHours: 1920,
                        overtimeHours: 160,
                        overtimePay: 7200,
                        federalTax: 6864,
                        stateTax: 0,
                        socialSecurity: 3869,
                        medicare: 905,
                        netPay: 50762
                    }
                },
                { 
                    id: 'DRV004', 
                    name: 'Emily Davis', 
                    firstName: 'Emily',
                    lastName: 'Davis',
                    email: 'edavis@routecrmpro.com',
                    phone: '(615) 555-4001',
                    dateOfBirth: '1988-05-30',
                    ssn: '***-**-3847',
                    address: '321 Music Row',
                    city: 'Nashville',
                    state: 'Tennessee',
                    zipCode: '37203',
                    emergencyContact: 'James Davis',
                    emergencyPhone: '(615) 555-4002',
                    hireDate: '2022-08-20',
                    employeeType: 'Full-Time',
                    department: 'Delivery',
                    licenseNumber: 'CDL-TN-456789',
                    licenseClass: 'Class B',
                    licenseState: 'Tennessee',
                    licenseExpiration: '2027-05-30',
                    endorsements: ['Safety', 'Cargo'],
                    restrictions: ['Corrective Lenses'],
                    medicalCardExpiration: '2026-08-20',
                    medicalCardStatus: 'Valid',
                    hourlyRate: 29,
                    overtimeRate: 43.50,
                    status: 'available',
                    backgroundCheckStatus: 'Cleared',
                    backgroundCheckDate: '2022-08-10',
                    backgroundCheckProvider: 'Checkr',
                    licenseVerificationStatus: 'Verified',
                    licenseVerificationDate: '2024-04-05',
                    drugTestStatus: 'Passed',
                    drugTestDate: '2024-09-15',
                    mvrStatus: 'Clear',
                    mvrDate: '2024-04-05',
                    trainingCompleted: ['Safety Safety', 'Defensive Driving', 'Product Handling'],
                    profilePhoto: null,
                    payrollId: 'PAY-004',
                    payFrequency: 'Bi-Weekly',
                    federalFilingStatus: 'Head of Household',
                    federalAllowances: 2,
                    stateFilingStatus: 'Single',
                    stateAllowances: 2,
                    additionalWithholding: 25,
                    directDeposit: {
                        enabled: true,
                        bankName: 'First Tennessee Bank',
                        accountType: 'Checking',
                        routingNumber: '****9012',
                        accountNumber: '****3847',
                        depositPercent: 100
                    },
                    ytdEarnings: {
                        grossPay: 60320,
                        regularHours: 1920,
                        overtimeHours: 130,
                        overtimePay: 5655,
                        federalTax: 7841,
                        stateTax: 0,
                        socialSecurity: 3740,
                        medicare: 875,
                        netPay: 47864
                    }
                }
            ],
            customers: [
                // Alabama customers
                { 
                    id: 'CUST-AL-001', 
                    storeId: 'STR-AL-001',
                    name: 'Acme Manufacturing', 
                    contactPerson: 'Robert Johnson',
                    email: 'rjohnson@acmemanufacturing.com',
                    phone: '(334) 555-0101',
                    address: '789 Factory Rd', 
                    city: 'Auburn',
                    state: 'Alabama',
                    zipCode: '36830',
                    lat: 32.5950,
                    lng: -85.4650,
                    preferredDC: 'DC-AL-001',
                    accountType: 'Commercial',
                    status: 'Active',
                    totalOrders: 24,
                    yearlyVolume: 12000,
                    lastOrderDate: '2026-01-10',
                    locations: [
                        { address: '456 Industrial Park Dr', city: 'Auburn', state: 'Alabama', zipCode: '36830', contact: 'Tom Smith', phone: '(334) 555-0111' },
                        { address: '123 Warehouse Blvd', city: 'Opelika', state: 'Alabama', zipCode: '36801', contact: 'Jane Doe', phone: '(334) 555-0112' }
                    ]
                },
                { 
                    id: 'CUST-AL-002', 
                    storeId: 'STR-AL-002',
                    name: 'Green Valley Farms', 
                    contactPerson: 'Sarah Mitchell',
                    email: 'smitchell@greenvalley.com',
                    phone: '(334) 555-0102',
                    address: '321 Rural Route 5', 
                    city: 'Opelika',
                    state: 'Alabama',
                    zipCode: '36801',
                    lat: 32.6450,
                    lng: -85.3780,
                    preferredDC: 'DC-AL-001',
                    accountType: 'Agricultural',
                    status: 'Active',
                    totalOrders: 36,
                    yearlyVolume: 18000,
                    lastOrderDate: '2026-01-08',
                    locations: [
                        { address: '500 Farm Road 12', city: 'Opelika', state: 'Alabama', zipCode: '36801', contact: 'Mike Wilson', phone: '(334) 555-0121' },
                        { address: '250 Barn Lane', city: 'Auburn', state: 'Alabama', zipCode: '36830', contact: 'Lisa Brown', phone: '(334) 555-0122' },
                        { address: '100 Silo Way', city: 'Opelika', state: 'Alabama', zipCode: '36801', contact: 'John Taylor', phone: '(334) 555-0123' }
                    ],
                    accountBalance: 1250.00,
                    paymentHistory: [
                        { id: 'PAY-001', date: '2026-01-08', amount: 450.00, method: 'Credit Card', last4: '4521', type: 'Visa', orderId: 'ORD-AL-002', status: 'Completed' },
                        { id: 'PAY-002', date: '2025-12-15', amount: 875.50, method: 'Credit Card', last4: '4521', type: 'Visa', orderId: 'ORD-AL-001', status: 'Completed' },
                        { id: 'PAY-003', date: '2025-11-20', amount: 620.00, method: 'ACH', last4: '7890', type: 'Bank', orderId: 'ORD-AL-003', status: 'Completed' }
                    ]
                },
                { 
                    id: 'CUST-AL-003', 
                    storeId: 'STR-AL-003',
                    name: 'Suburban Homes HOA', 
                    contactPerson: 'Michael Davis',
                    email: 'mdavis@suburbanhomes.org',
                    phone: '(334) 555-0103',
                    address: '555 Maple Street', 
                    city: 'Auburn',
                    state: 'Alabama',
                    zipCode: '36832',
                    lat: 32.6000,
                    lng: -85.4700,
                    preferredDC: 'DC-AL-001',
                    accountType: 'Residential',
                    status: 'Active',
                    totalOrders: 48,
                    yearlyVolume: 7200,
                    lastOrderDate: '2026-01-15',
                    accountBalance: 325.00,
                    paymentHistory: [
                        { id: 'PAY-004', date: '2026-01-15', amount: 480.00, method: 'Credit Card', last4: '9876', type: 'Mastercard', orderId: 'ORD-AL-003', status: 'Completed', routeId: 'RT-AL-001', driverId: 'DRV003', signature: 'J. Williams' }
                    ]
                },
                { 
                    id: 'CUST-AL-004', 
                    storeId: 'STR-AL-004',
                    name: 'Birmingham Steel Works', 
                    contactPerson: 'James Patterson',
                    email: 'jpatterson@birminghamsteel.com',
                    phone: '(205) 555-0201',
                    address: '100 Industrial Dr', 
                    city: 'Birmingham',
                    state: 'Alabama',
                    zipCode: '35203',
                    lat: 33.5050,
                    lng: -86.8000,
                    preferredDC: 'DC-AL-002',
                    accountType: 'Industrial',
                    status: 'Active',
                    totalOrders: 52,
                    yearlyVolume: 45000,
                    lastOrderDate: '2026-01-15',
                    accountBalance: 0,
                    paymentHistory: [
                        { id: 'PAY-005', date: '2026-01-15', amount: 2100.00, method: 'Credit Card', last4: '5432', type: 'Visa', orderId: 'ORD-AL-004', status: 'Completed', routeId: 'RT-AL-001', driverId: 'DRV003', signature: 'M. Thompson' }
                    ]
                },
                // Georgia customers
                { 
                    id: 'CUST-GA-001', 
                    storeId: 'STR-GA-001',
                    name: 'Peachtree Plaza Hotel', 
                    contactPerson: 'Amanda Chen',
                    email: 'achen@peachtreeplaza.com',
                    phone: '(404) 555-0301',
                    address: '210 Peachtree St', 
                    city: 'Atlanta',
                    state: 'Georgia',
                    zipCode: '30303',
                    lat: 33.7580,
                    lng: -84.3880,
                    preferredDC: 'DC-GA-001',
                    accountType: 'Hospitality',
                    status: 'Active',
                    totalOrders: 72,
                    yearlyVolume: 32400,
                    lastOrderDate: '2026-01-15',
                    accountBalance: 0,
                    paymentHistory: [
                        { id: 'PAY-010', date: '2026-01-15', amount: 1550.00, method: 'Credit Card', last4: '8765', type: 'Visa', orderId: 'ORD-GA-001', status: 'Completed', routeId: 'RT-GA-001', driverId: 'DRV001', signature: 'R. Patel' },
                        { id: 'PAY-013', date: '2026-01-15', amount: 820.00, method: 'Credit Card', last4: '8765', type: 'Visa', orderId: 'ORD-GA-003', status: 'Completed', routeId: 'RT-GA-001', driverId: 'DRV001', signature: 'A. Mitchell' }
                    ]
                },
                { 
                    id: 'CUST-GA-002', 
                    storeId: 'STR-GA-002',
                    name: 'Georgia Tech Campus', 
                    contactPerson: 'Dr. Lisa Wong',
                    email: 'lwong@gatech.edu',
                    phone: '(404) 555-0302',
                    address: '225 North Ave NW', 
                    city: 'Atlanta',
                    state: 'Georgia',
                    zipCode: '30332',
                    lat: 33.7756,
                    lng: -84.3963,
                    preferredDC: 'DC-GA-001',
                    accountType: 'Educational',
                    status: 'Active',
                    totalOrders: 64,
                    yearlyVolume: 28000,
                    lastOrderDate: '2026-01-15',
                    accountBalance: 0,
                    paymentHistory: [
                        { id: 'PAY-011', date: '2026-01-15', amount: 1100.00, method: 'Credit Card', last4: '2345', type: 'Mastercard', orderId: 'ORD-GA-002', status: 'Completed', routeId: 'RT-GA-001', driverId: 'DRV001', signature: 'T. Johnson' }
                    ]
                },
                // Florida customers
                { 
                    id: 'CUST-FL-001', 
                    storeId: 'STR-FL-001',
                    name: 'Jacksonville Port Authority', 
                    contactPerson: 'Carlos Rodriguez',
                    email: 'crodriguez@jaxport.com',
                    phone: '(904) 555-0401',
                    address: '2831 Talleyrand Ave', 
                    city: 'Jacksonville',
                    state: 'Florida',
                    zipCode: '32206',
                    lat: 30.3370,
                    lng: -81.6290,
                    preferredDC: 'DC-FL-001',
                    accountType: 'Industrial',
                    status: 'Active',
                    totalOrders: 96,
                    yearlyVolume: 72000,
                    lastOrderDate: '2026-01-15',
                    accountBalance: 0,
                    paymentHistory: [
                        { id: 'PAY-020', date: '2026-01-15', amount: 2650.00, method: 'Credit Card', last4: '1234', type: 'Visa', orderId: 'ORD-FL-001', status: 'Completed', routeId: 'RT-FL-001', driverId: 'DRV002', signature: 'D. Martinez' }
                    ]
                },
                { 
                    id: 'CUST-FL-002', 
                    storeId: 'STR-FL-002',
                    name: 'Tampa Bay Resort', 
                    contactPerson: 'Jennifer Martinez',
                    email: 'jmartinez@tampabayresort.com',
                    phone: '(813) 555-0402',
                    address: '5500 Gulf Blvd', 
                    city: 'Tampa',
                    state: 'Florida',
                    zipCode: '33706',
                    lat: 27.9400,
                    lng: -82.4450,
                    preferredDC: 'DC-FL-001',
                    accountType: 'Hospitality',
                    status: 'Active',
                    totalOrders: 84,
                    yearlyVolume: 38400,
                    lastOrderDate: '2026-01-15',
                    accountBalance: 0,
                    paymentHistory: [
                        { id: 'PAY-021', date: '2026-01-15', amount: 1380.00, method: 'Credit Card', last4: '5678', type: 'Mastercard', orderId: 'ORD-FL-002', status: 'Completed', routeId: 'RT-FL-001', driverId: 'DRV002', signature: 'L. Chen' }
                    ]
                },
                // Tennessee customers
                { 
                    id: 'CUST-TN-001', 
                    storeId: 'STR-TN-001',
                    name: 'Grand Ole Opry', 
                    contactPerson: 'William Thompson',
                    email: 'wthompson@opry.com',
                    phone: '(615) 555-0501',
                    address: '2804 Opryland Dr', 
                    city: 'Nashville',
                    state: 'Tennessee',
                    zipCode: '37214',
                    lat: 36.2067,
                    lng: -86.6920,
                    preferredDC: 'DC-TN-001',
                    accountType: 'Entertainment',
                    status: 'Active',
                    totalOrders: 48,
                    yearlyVolume: 22000,
                    lastOrderDate: '2026-01-15',
                    accountBalance: 0,
                    paymentHistory: [
                        { id: 'PAY-030', date: '2026-01-15', amount: 920.00, method: 'Credit Card', last4: '3456', type: 'Visa', orderId: 'ORD-TN-001', status: 'Completed', routeId: 'RT-TN-001', driverId: 'DRV004', signature: 'W. Thompson' }
                    ]
                },
                { 
                    id: 'CUST-TN-002', 
                    storeId: 'STR-TN-002',
                    name: 'Ryman Auditorium', 
                    contactPerson: 'Johnny Cash Jr',
                    email: 'jcash@ryman.com',
                    phone: '(615) 555-0502',
                    address: '116 5th Ave N', 
                    city: 'Nashville',
                    state: 'Tennessee',
                    zipCode: '37219',
                    lat: 36.1612,
                    lng: -86.7785,
                    preferredDC: 'DC-TN-001',
                    accountType: 'Entertainment',
                    status: 'Active',
                    totalOrders: 36,
                    yearlyVolume: 18000,
                    lastOrderDate: '2026-01-15',
                    accountBalance: 0,
                    paymentHistory: [
                        { id: 'PAY-031', date: '2026-01-15', amount: 820.00, method: 'Credit Card', last4: '7890', type: 'Mastercard', orderId: 'ORD-TN-002', status: 'Completed', routeId: 'RT-TN-001', driverId: 'DRV004', signature: 'J. Cash' }
                    ]
                },
                { 
                    id: 'CUST-TN-003', 
                    storeId: 'STR-TN-003',
                    name: 'Nissan Stadium', 
                    contactPerson: 'Derrick Parton',
                    email: 'dparton@titans.com',
                    phone: '(615) 555-0503',
                    address: '1 Titans Way', 
                    city: 'Nashville',
                    state: 'Tennessee',
                    zipCode: '37213',
                    lat: 36.1665,
                    lng: -86.7713,
                    preferredDC: 'DC-TN-001',
                    accountType: 'Entertainment',
                    status: 'Active',
                    totalOrders: 42,
                    yearlyVolume: 24000,
                    lastOrderDate: '2026-01-15',
                    accountBalance: 0,
                    paymentHistory: [
                        { id: 'PAY-032', date: '2026-01-15', amount: 720.00, method: 'Credit Card', last4: '2468', type: 'Visa', orderId: 'ORD-TN-003', status: 'Completed', routeId: 'RT-TN-001', driverId: 'DRV004', signature: 'D. Parton' }
                    ]
                },
                { 
                    id: 'CUST-TN-004', 
                    storeId: 'STR-TN-004',
                    name: 'Vanderbilt University', 
                    contactPerson: 'Randy Travis',
                    email: 'rtravis@vanderbilt.edu',
                    phone: '(615) 555-0504',
                    address: '2201 West End Ave', 
                    city: 'Nashville',
                    state: 'Tennessee',
                    zipCode: '37235',
                    lat: 36.1447,
                    lng: -86.8027,
                    preferredDC: 'DC-TN-001',
                    accountType: 'Educational',
                    status: 'Active',
                    totalOrders: 52,
                    yearlyVolume: 26000,
                    lastOrderDate: '2026-01-15',
                    accountBalance: 0,
                    paymentHistory: [
                        { id: 'PAY-033', date: '2026-01-15', amount: 890.00, method: 'Credit Card', last4: '1357', type: 'Mastercard', orderId: 'ORD-TN-004', status: 'Completed', routeId: 'RT-TN-001', driverId: 'DRV004', signature: 'R. Travis' }
                    ]
                },
                { 
                    id: 'CUST-TN-005', 
                    storeId: 'STR-TN-005',
                    name: 'Nashville Zoo', 
                    contactPerson: 'Carrie Underwood',
                    email: 'cunderwood@nashvillezoo.org',
                    phone: '(615) 555-0505',
                    address: '3777 Nolensville Pike', 
                    city: 'Nashville',
                    state: 'Tennessee',
                    zipCode: '37211',
                    lat: 36.0660,
                    lng: -86.7400,
                    preferredDC: 'DC-TN-001',
                    accountType: 'Entertainment',
                    status: 'Active',
                    totalOrders: 28,
                    yearlyVolume: 14000,
                    lastOrderDate: '2026-01-15',
                    accountBalance: 0,
                    paymentHistory: [
                        { id: 'PAY-034', date: '2026-01-15', amount: 820.00, method: 'Credit Card', last4: '9753', type: 'Visa', orderId: 'ORD-TN-005', status: 'Completed', routeId: 'RT-TN-001', driverId: 'DRV004', signature: 'C. Underwood' }
                    ]
                },
                // North Carolina customers
                { 
                    id: 'CUST-NC-001', 
                    storeId: 'STR-NC-001',
                    name: 'Charlotte Motor Speedway', 
                    contactPerson: 'David Wilson',
                    email: 'dwilson@charlottemotorspeedway.com',
                    phone: '(704) 555-0601',
                    address: '5555 Concord Pkwy S', 
                    city: 'Charlotte',
                    state: 'North Carolina',
                    zipCode: '28027',
                    lat: 35.3560,
                    lng: -80.6830,
                    preferredDC: 'DC-NC-001',
                    accountType: 'Entertainment',
                    status: 'Active',
                    totalOrders: 56,
                    yearlyVolume: 48000,
                    lastOrderDate: '2026-01-15',
                    accountBalance: 0,
                    paymentHistory: [
                        { id: 'PAY-040', date: '2026-01-15', amount: 1900.00, method: 'Credit Card', last4: '4567', type: 'Visa', orderId: 'ORD-NC-001', status: 'Completed', routeId: 'RT-NC-001', driverId: 'DRV003', signature: 'D. Wilson' }
                    ]
                },
                { 
                    id: 'CUST-NC-002', 
                    storeId: 'STR-NC-002',
                    name: 'Bank of America Stadium', 
                    contactPerson: 'Kyle Johnson',
                    email: 'kjohnson@panthers.com',
                    phone: '(704) 555-0602',
                    address: '800 S Mint St', 
                    city: 'Charlotte',
                    state: 'North Carolina',
                    zipCode: '28202',
                    lat: 35.2258,
                    lng: -80.8528,
                    preferredDC: 'DC-NC-001',
                    accountType: 'Entertainment',
                    status: 'Active',
                    totalOrders: 48,
                    yearlyVolume: 38000,
                    lastOrderDate: '2026-01-15',
                    accountBalance: 0,
                    paymentHistory: [
                        { id: 'PAY-041', date: '2026-01-15', amount: 1460.00, method: 'Credit Card', last4: '8901', type: 'Mastercard', orderId: 'ORD-NC-002', status: 'Completed', routeId: 'RT-NC-001', driverId: 'DRV003', signature: 'K. Johnson' }
                    ]
                },
                { 
                    id: 'CUST-NC-003', 
                    storeId: 'STR-NC-003',
                    name: 'Duke Energy Center', 
                    contactPerson: 'Lisa Brown',
                    email: 'lbrown@dukeenergy.com',
                    phone: '(704) 555-0603',
                    address: '400 S College St', 
                    city: 'Charlotte',
                    state: 'North Carolina',
                    zipCode: '28202',
                    lat: 35.2243,
                    lng: -80.8436,
                    preferredDC: 'DC-NC-001',
                    accountType: 'Commercial',
                    status: 'Active',
                    totalOrders: 62,
                    yearlyVolume: 42000,
                    lastOrderDate: '2026-01-15',
                    accountBalance: 0,
                    paymentHistory: [
                        { id: 'PAY-042', date: '2026-01-15', amount: 1230.00, method: 'Credit Card', last4: '2345', type: 'Visa', orderId: 'ORD-NC-003', status: 'Completed', routeId: 'RT-NC-001', driverId: 'DRV003', signature: 'L. Brown' }
                    ]
                },
                { 
                    id: 'CUST-NC-004', 
                    storeId: 'STR-NC-004',
                    name: 'Charlotte Douglas Airport', 
                    contactPerson: 'Robert Garcia',
                    email: 'rgarcia@cltairport.com',
                    phone: '(704) 555-0604',
                    address: '5501 Josh Birmingham Pkwy', 
                    city: 'Charlotte',
                    state: 'North Carolina',
                    zipCode: '28208',
                    lat: 35.2140,
                    lng: -80.9431,
                    preferredDC: 'DC-NC-001',
                    accountType: 'Industrial',
                    status: 'Active',
                    totalOrders: 72,
                    yearlyVolume: 56000,
                    lastOrderDate: '2026-01-15',
                    accountBalance: 0,
                    paymentHistory: [
                        { id: 'PAY-043', date: '2026-01-15', amount: 1630.00, method: 'Credit Card', last4: '6789', type: 'Mastercard', orderId: 'ORD-NC-004', status: 'Completed', routeId: 'RT-NC-001', driverId: 'DRV003', signature: 'R. Garcia' }
                    ]
                },
                // South Carolina customers
                { 
                    id: 'CUST-SC-001', 
                    storeId: 'STR-SC-001',
                    name: 'Columbia Medical Center', 
                    contactPerson: 'Dr. Patricia Anderson',
                    email: 'panderson@columbiamedical.org',
                    phone: '(803) 555-0701',
                    address: '5 Richland Medical Park Dr', 
                    city: 'Columbia',
                    state: 'South Carolina',
                    zipCode: '29203',
                    lat: 34.0320,
                    lng: -81.0430,
                    preferredDC: 'DC-SC-001',
                    accountType: 'Healthcare',
                    status: 'Active',
                    totalOrders: 78,
                    yearlyVolume: 36000,
                    lastOrderDate: '2026-01-15',
                    accountBalance: 0,
                    paymentHistory: [
                        { id: 'PAY-050', date: '2026-01-15', amount: 1050.00, method: 'Credit Card', last4: '1122', type: 'Visa', orderId: 'ORD-SC-001', status: 'Completed', routeId: 'RT-SC-001', driverId: 'DRV001', signature: 'Dr. Anderson' }
                    ]
                },
                { 
                    id: 'CUST-SC-002', 
                    storeId: 'STR-SC-002',
                    name: 'University of South Carolina', 
                    contactPerson: 'Brian Smith',
                    email: 'bsmith@sc.edu',
                    phone: '(803) 555-0702',
                    address: '1600 Hampton St', 
                    city: 'Columbia',
                    state: 'South Carolina',
                    zipCode: '29208',
                    lat: 33.9970,
                    lng: -81.0261,
                    preferredDC: 'DC-SC-001',
                    accountType: 'Educational',
                    status: 'Active',
                    totalOrders: 54,
                    yearlyVolume: 28000,
                    lastOrderDate: '2026-01-15',
                    accountBalance: 0,
                    paymentHistory: [
                        { id: 'PAY-051', date: '2026-01-15', amount: 940.00, method: 'Credit Card', last4: '3344', type: 'Mastercard', orderId: 'ORD-SC-002', status: 'Completed', routeId: 'RT-SC-001', driverId: 'DRV001', signature: 'B. Smith' }
                    ]
                },
                { 
                    id: 'CUST-SC-003', 
                    storeId: 'STR-SC-003',
                    name: 'SC State House', 
                    contactPerson: 'Thomas Johnson',
                    email: 'tjohnson@scstatehouse.gov',
                    phone: '(803) 555-0703',
                    address: '1100 Gervais St', 
                    city: 'Columbia',
                    state: 'South Carolina',
                    zipCode: '29201',
                    lat: 34.0004,
                    lng: -81.0329,
                    preferredDC: 'DC-SC-001',
                    accountType: 'Government',
                    status: 'Active',
                    totalOrders: 32,
                    yearlyVolume: 16000,
                    lastOrderDate: '2026-01-15',
                    accountBalance: 0,
                    paymentHistory: [
                        { id: 'PAY-052', date: '2026-01-15', amount: 820.00, method: 'ACH', last4: '5566', type: 'Bank', orderId: 'ORD-SC-003', status: 'Completed', routeId: 'RT-SC-001', driverId: 'DRV001', signature: 'T. Johnson' }
                    ]
                },
                { 
                    id: 'CUST-SC-004', 
                    storeId: 'STR-SC-004',
                    name: 'Williams-Brice Stadium', 
                    contactPerson: 'Mike Davis',
                    email: 'mdavis@gamecocks.com',
                    phone: '(803) 555-0704',
                    address: '1125 George Rogers Blvd', 
                    city: 'Columbia',
                    state: 'South Carolina',
                    zipCode: '29201',
                    lat: 33.9728,
                    lng: -81.0197,
                    preferredDC: 'DC-SC-001',
                    accountType: 'Entertainment',
                    status: 'Active',
                    totalOrders: 46,
                    yearlyVolume: 32000,
                    lastOrderDate: '2026-01-15',
                    accountBalance: 0,
                    paymentHistory: [
                        { id: 'PAY-053', date: '2026-01-15', amount: 1230.00, method: 'Credit Card', last4: '7788', type: 'Visa', orderId: 'ORD-SC-004', status: 'Completed', routeId: 'RT-SC-001', driverId: 'DRV001', signature: 'M. Davis' }
                    ]
                },
                // Mississippi customers
                { 
                    id: 'CUST-MS-001', 
                    storeId: 'STR-MS-001',
                    name: 'Jackson Convention Center', 
                    contactPerson: 'Marcus Williams',
                    email: 'mwilliams@jacksoncenter.com',
                    phone: '(601) 555-0801',
                    address: '105 E Pascagoula St', 
                    city: 'Jackson',
                    state: 'Mississippi',
                    zipCode: '39201',
                    lat: 32.3000,
                    lng: -90.1820,
                    preferredDC: 'DC-MS-001',
                    accountType: 'Commercial',
                    status: 'Active',
                    totalOrders: 42,
                    yearlyVolume: 18500,
                    lastOrderDate: '2026-01-15',
                    accountBalance: 0,
                    paymentHistory: [
                        { id: 'PAY-060', date: '2026-01-15', amount: 820.00, method: 'Credit Card', last4: '1111', type: 'Visa', orderId: 'ORD-MS-001', status: 'Completed', routeId: 'RT-MS-001', driverId: 'DRV002', signature: 'J. Williams' },
                        { id: 'PAY-061', date: '2026-01-15', amount: 1060.00, method: 'Credit Card', last4: '1111', type: 'Visa', orderId: 'ORD-MS-002', status: 'Completed', routeId: 'RT-MS-001', driverId: 'DRV002', signature: 'M. Johnson' },
                        { id: 'PAY-062', date: '2026-01-15', amount: 890.00, method: 'Credit Card', last4: '1111', type: 'Visa', orderId: 'ORD-MS-003', status: 'Completed', routeId: 'RT-MS-001', driverId: 'DRV002', signature: 'T. Davis' },
                        { id: 'PAY-063', date: '2026-01-15', amount: 770.00, method: 'Credit Card', last4: '1111', type: 'Visa', orderId: 'ORD-MS-004', status: 'Completed', routeId: 'RT-MS-001', driverId: 'DRV002', signature: 'B. Wilson' },
                        { id: 'PAY-064', date: '2026-01-15', amount: 650.00, method: 'Credit Card', last4: '1111', type: 'Visa', orderId: 'ORD-MS-005', status: 'Completed', routeId: 'RT-MS-001', driverId: 'DRV002', signature: 'S. Brown' },
                        { id: 'PAY-065', date: '2026-01-15', amount: 720.00, method: 'Credit Card', last4: '1111', type: 'Visa', orderId: 'ORD-MS-006', status: 'Completed', routeId: 'RT-MS-001', driverId: 'DRV002', signature: 'A. Garcia' }
                    ]
                },
                // Louisiana customers
                { 
                    id: 'CUST-LA-001', 
                    storeId: 'STR-LA-001',
                    name: 'Baton Rouge Refinery', 
                    contactPerson: 'Thomas Leblanc',
                    email: 'tleblanc@brrefinery.com',
                    phone: '(225) 555-0901',
                    address: '9999 Scenic Hwy', 
                    city: 'Baton Rouge',
                    state: 'Louisiana',
                    zipCode: '70807',
                    lat: 30.4400,
                    lng: -91.1700,
                    preferredDC: 'DC-LA-001',
                    accountType: 'Industrial',
                    status: 'Active',
                    totalOrders: 120,
                    yearlyVolume: 96000,
                    lastOrderDate: '2026-01-15',
                    accountBalance: 0,
                    paymentHistory: [
                        { id: 'PAY-070', date: '2026-01-15', amount: 1460.00, method: 'Credit Card', last4: '2222', type: 'Mastercard', orderId: 'ORD-LA-001', status: 'Completed', routeId: 'RT-LA-001', driverId: 'DRV001', signature: 'P. Fontenot' },
                        { id: 'PAY-071', date: '2026-01-15', amount: 890.00, method: 'Credit Card', last4: '2222', type: 'Mastercard', orderId: 'ORD-LA-002', status: 'Completed', routeId: 'RT-LA-001', driverId: 'DRV001', signature: 'R. Boudreaux' },
                        { id: 'PAY-072', date: '2026-01-15', amount: 1230.00, method: 'Credit Card', last4: '2222', type: 'Mastercard', orderId: 'ORD-LA-003', status: 'Completed', routeId: 'RT-LA-001', driverId: 'DRV001', signature: 'M. Landry' },
                        { id: 'PAY-073', date: '2026-01-15', amount: 990.00, method: 'Credit Card', last4: '2222', type: 'Mastercard', orderId: 'ORD-LA-004', status: 'Completed', routeId: 'RT-LA-001', driverId: 'DRV001', signature: 'C. Thibodaux' },
                        { id: 'PAY-074', date: '2026-01-15', amount: 1170.00, method: 'Credit Card', last4: '2222', type: 'Mastercard', orderId: 'ORD-LA-005', status: 'Completed', routeId: 'RT-LA-001', driverId: 'DRV001', signature: 'D. Hebert' },
                        { id: 'PAY-075', date: '2026-01-15', amount: 820.00, method: 'Credit Card', last4: '2222', type: 'Mastercard', orderId: 'ORD-LA-006', status: 'Completed', routeId: 'RT-LA-001', driverId: 'DRV001', signature: 'J. Broussard' }
                    ]
                },
                // Kentucky customers
                { 
                    id: 'CUST-KY-001', 
                    storeId: 'STR-KY-001',
                    name: 'Louisville Distillery Co', 
                    contactPerson: 'Katherine Brown',
                    email: 'kbrown@louisdistillery.com',
                    phone: '(502) 555-1001',
                    address: '1000 Whiskey Row', 
                    city: 'Louisville',
                    state: 'Kentucky',
                    zipCode: '40202',
                    lat: 38.2550,
                    lng: -85.7600,
                    preferredDC: 'DC-KY-001',
                    accountType: 'Manufacturing',
                    status: 'Active',
                    totalOrders: 68,
                    yearlyVolume: 52000,
                    lastOrderDate: '2026-01-15',
                    accountBalance: 0,
                    paymentHistory: [
                        { id: 'PAY-080', date: '2026-01-15', amount: 1060.00, method: 'Credit Card', last4: '3333', type: 'Visa', orderId: 'ORD-KY-001', status: 'Completed', routeId: 'RT-KY-001', driverId: 'DRV004', signature: 'J. Bourbon' },
                        { id: 'PAY-081', date: '2026-01-15', amount: 1460.00, method: 'Credit Card', last4: '3333', type: 'Visa', orderId: 'ORD-KY-002', status: 'Completed', routeId: 'RT-KY-001', driverId: 'DRV004', signature: 'W. Derby' },
                        { id: 'PAY-082', date: '2026-01-15', amount: 820.00, method: 'Credit Card', last4: '3333', type: 'Visa', orderId: 'ORD-KY-003', status: 'Completed', routeId: 'RT-KY-001', driverId: 'DRV004', signature: 'T. Muhammad' },
                        { id: 'PAY-083', date: '2026-01-15', amount: 1230.00, method: 'Credit Card', last4: '3333', type: 'Visa', orderId: 'ORD-KY-004', status: 'Completed', routeId: 'RT-KY-001', driverId: 'DRV004', signature: 'K. Bluegrass' }
                    ]
                },
                // Birmingham Alabama additional customers for RT-AL-002
                { 
                    id: 'CUST-AL-010', 
                    storeId: 'STR-AL-010',
                    name: 'US Steel Birmingham', 
                    contactPerson: 'Robert Steel',
                    email: 'rsteel@ussteel.com',
                    phone: '(205) 555-1001',
                    address: '1200 41st St N', 
                    city: 'Birmingham',
                    state: 'Alabama',
                    zipCode: '35222',
                    lat: 33.5510,
                    lng: -86.8190,
                    preferredDC: 'DC-AL-002',
                    accountType: 'Industrial',
                    status: 'Active',
                    totalOrders: 86,
                    yearlyVolume: 72000,
                    lastOrderDate: '2026-01-15',
                    accountBalance: 0,
                    paymentHistory: [
                        { id: 'PAY-090', date: '2026-01-15', amount: 1170.00, method: 'Credit Card', last4: '4444', type: 'Mastercard', orderId: 'ORD-AL-010', status: 'Completed', routeId: 'RT-AL-002', driverId: 'DRV002', signature: 'R. Steel' },
                        { id: 'PAY-091', date: '2026-01-15', amount: 890.00, method: 'Credit Card', last4: '4444', type: 'Mastercard', orderId: 'ORD-AL-011', status: 'Completed', routeId: 'RT-AL-002', driverId: 'DRV002', signature: 'M. Iron' },
                        { id: 'PAY-092', date: '2026-01-15', amount: 990.00, method: 'Credit Card', last4: '4444', type: 'Mastercard', orderId: 'ORD-AL-012', status: 'Completed', routeId: 'RT-AL-002', driverId: 'DRV002', signature: 'J. Coal' },
                        { id: 'PAY-093', date: '2026-01-15', amount: 820.00, method: 'Credit Card', last4: '4444', type: 'Mastercard', orderId: 'ORD-AL-013', status: 'Completed', routeId: 'RT-AL-002', driverId: 'DRV002', signature: 'B. Vulcan' }
                    ]
                },
                // Florida additional customers for completed stops
                { 
                    id: 'CUST-FL-003', 
                    storeId: 'STR-FL-003',
                    name: 'Orlando Convention Center', 
                    contactPerson: 'Maria Rodriguez',
                    email: 'mrodriguez@occc.net',
                    phone: '(407) 555-0403',
                    address: '9800 International Dr', 
                    city: 'Orlando',
                    state: 'Florida',
                    zipCode: '32819',
                    lat: 28.4262,
                    lng: -81.4695,
                    preferredDC: 'DC-FL-001',
                    accountType: 'Commercial',
                    status: 'Active',
                    totalOrders: 58,
                    yearlyVolume: 32000,
                    lastOrderDate: '2026-01-15',
                    accountBalance: 0,
                    paymentHistory: [
                        { id: 'PAY-022', date: '2026-01-15', amount: 1160.00, method: 'Credit Card', last4: '9012', type: 'Visa', orderId: 'ORD-FL-003', status: 'Completed', routeId: 'RT-FL-001', driverId: 'DRV002', signature: 'M. Rodriguez' }
                    ]
                },
                { 
                    id: 'CUST-FL-004', 
                    storeId: 'STR-FL-004',
                    name: 'Miami Beach Hotels', 
                    contactPerson: 'Kevin Brown',
                    email: 'kbrown@miamibeachhotels.com',
                    phone: '(305) 555-0404',
                    address: '1701 Collins Ave', 
                    city: 'Miami Beach',
                    state: 'Florida',
                    zipCode: '33139',
                    lat: 25.7907,
                    lng: -80.1300,
                    preferredDC: 'DC-FL-001',
                    accountType: 'Hospitality',
                    status: 'Active',
                    totalOrders: 72,
                    yearlyVolume: 42000,
                    lastOrderDate: '2026-01-15',
                    accountBalance: 0,
                    paymentHistory: [
                        { id: 'PAY-023', date: '2026-01-15', amount: 770.00, method: 'Credit Card', last4: '3456', type: 'Mastercard', orderId: 'ORD-FL-004', status: 'Completed', routeId: 'RT-FL-001', driverId: 'DRV002', signature: 'K. Brown' }
                    ]
                }
            ],
            orders: [
                // Alabama orders
                { 
                    id: 'ORD-AL-001',
                    customerId: 'CUST-AL-001',
                    customer: 'Acme Manufacturing', 
                    address: '789 Factory Rd, Auburn', 
                    volume: 500, 
                    priority: 'high', 
                    status: 'pending',
                    deliveryDate: '2026-01-16',
                    revenue: 850,
                    lat: 32.5950,
                    lng: -85.4650,
                    state: 'Alabama',
                    preferredDC: 'DC-AL-001'
                },
                { 
                    id: 'ORD-AL-002',
                    customerId: 'CUST-AL-002',
                    customer: 'Green Valley Farms', 
                    address: '321 Rural Route 5, Opelika', 
                    volume: 750, 
                    priority: 'medium', 
                    status: 'pending',
                    deliveryDate: '2026-01-16',
                    revenue: 1200,
                    lat: 32.6450,
                    lng: -85.3780,
                    state: 'Alabama',
                    preferredDC: 'DC-AL-001'
                },
                { 
                    id: 'ORD-AL-003',
                    customerId: 'CUST-AL-003',
                    customer: 'Suburban Homes HOA', 
                    address: '555 Maple Street, Auburn', 
                    volume: 300, 
                    priority: 'low', 
                    status: 'assigned',
                    deliveryDate: '2026-01-15',
                    revenue: 480,
                    lat: 32.6000,
                    lng: -85.4700,
                    state: 'Alabama',
                    preferredDC: 'DC-AL-001',
                    products: { 'SKU-20': 24, 'SKU-30': 6, 'SKU-33': 4, 'SKU-40': 2 }
                },
                { 
                    id: 'ORD-AL-004',
                    customerId: 'CUST-AL-004',
                    customer: 'Birmingham Steel Works', 
                    address: '100 Industrial Dr, Birmingham', 
                    volume: 1200, 
                    priority: 'high', 
                    status: 'pending',
                    deliveryDate: '2026-01-16',
                    revenue: 2100,
                    lat: 33.5050,
                    lng: -86.8000,
                    state: 'Alabama',
                    preferredDC: 'DC-AL-002',
                    products: { 'SKU-20': 24, 'SKU-30': 6, 'SKU-33': 4, 'SKU-40': 2 }
                },
                {
                    id: 'ORD-AL-005',
                    customerId: 'CUST-AL-003',
                    customer: 'Suburban Homes HOA', 
                    address: '555 Maple Street, Auburn', 
                    volume: 450, 
                    priority: 'normal', 
                    status: 'pending',
                    deliveryDate: '2026-01-15',
                    revenue: 785,
                    lat: 32.6000,
                    lng: -85.4700,
                    state: 'Alabama',
                    preferredDC: 'DC-AL-001',
                    products: { 'SKU-20': 18, 'SKU-30': 4 }
                },
                {
                    id: 'ORD-AL-006',
                    customerId: 'CUST-AL-002',
                    customer: 'Green Valley Farms', 
                    address: '500 Farm Road 12, Opelika', 
                    volume: 680, 
                    priority: 'normal', 
                    status: 'pending',
                    deliveryDate: '2026-01-15',
                    revenue: 1190,
                    lat: 32.6400,
                    lng: -85.3800,
                    state: 'Alabama',
                    preferredDC: 'DC-AL-001',
                    products: { 'SKU-20': 30, 'SKU-30': 8, 'SKU-40': 4 }
                },
                {
                    id: 'ORD-AL-007',
                    customerId: 'CUST-AL-001',
                    customer: 'Acme Manufacturing', 
                    address: '789 Industrial Blvd, Auburn', 
                    volume: 520, 
                    priority: 'normal', 
                    status: 'pending',
                    deliveryDate: '2026-01-15',
                    revenue: 910,
                    lat: 32.6100,
                    lng: -85.4500,
                    state: 'Alabama',
                    preferredDC: 'DC-AL-001',
                    products: { 'SKU-20': 22, 'SKU-30': 6, 'SKU-33': 4, 'SKU-40': 2 }
                },
                {
                    id: 'ORD-AL-008',
                    customerId: 'CUST-AL-003',
                    customer: 'Suburban Homes HOA', 
                    address: '1200 Oak Drive, Auburn', 
                    volume: 380, 
                    priority: 'low', 
                    status: 'pending',
                    deliveryDate: '2026-01-15',
                    revenue: 665,
                    lat: 32.5850,
                    lng: -85.4900,
                    state: 'Alabama',
                    preferredDC: 'DC-AL-001',
                    products: { 'SKU-20': 16, 'SKU-30': 4, 'SKU-33': 2 }
                },
                {
                    id: 'ORD-AL-009',
                    customerId: 'CUST-AL-002',
                    customer: 'Green Valley Farms - North', 
                    address: '850 County Road 44, Opelika', 
                    volume: 290, 
                    priority: 'low', 
                    status: 'pending',
                    deliveryDate: '2026-01-15',
                    revenue: 508,
                    lat: 32.6600,
                    lng: -85.3600,
                    state: 'Alabama',
                    preferredDC: 'DC-AL-001',
                    products: { 'SKU-20': 12, 'SKU-30': 4, 'SKU-40': 2 }
                },
                // Georgia orders
                { 
                    id: 'ORD-GA-001',
                    customerId: 'CUST-GA-001',
                    customer: 'Peachtree Plaza Hotel', 
                    address: '210 Peachtree St, Atlanta', 
                    volume: 900, 
                    priority: 'high', 
                    status: 'assigned',
                    deliveryDate: '2026-01-15',
                    revenue: 1550,
                    lat: 33.7580,
                    lng: -84.3880,
                    state: 'Georgia',
                    preferredDC: 'DC-GA-001',
                    products: { 'SKU-20': 36, 'SKU-30': 12, 'SKU-33': 8, 'SKU-40': 6, 'SKU-100': 2 }
                },
                { 
                    id: 'ORD-GA-002',
                    customerId: 'CUST-GA-002',
                    customer: 'Georgia Tech Campus', 
                    address: '225 North Ave NW, Atlanta', 
                    volume: 650, 
                    priority: 'medium', 
                    status: 'assigned',
                    deliveryDate: '2026-01-15',
                    revenue: 1100,
                    lat: 33.7756,
                    lng: -84.3963,
                    state: 'Georgia',
                    preferredDC: 'DC-GA-001',
                    products: { 'SKU-20': 20, 'SKU-30': 6, 'SKU-33': 5, 'SKU-40': 3, 'SKU-100': 1 }
                },
                { 
                    id: 'ORD-GA-003',
                    customerId: 'CUST-GA-001',
                    customer: 'Peachtree Plaza Hotel - Annex', 
                    address: '180 Peachtree St NW, Atlanta', 
                    volume: 480, 
                    priority: 'medium', 
                    status: 'assigned',
                    deliveryDate: '2026-01-15',
                    revenue: 820,
                    lat: 33.7590,
                    lng: -84.3870,
                    state: 'Georgia',
                    preferredDC: 'DC-GA-001',
                    products: { 'SKU-20': 14, 'SKU-30': 6, 'SKU-33': 5, 'SKU-40': 3, 'SKU-100': 1 }
                },
                { 
                    id: 'ORD-GA-004',
                    customerId: 'CUST-GA-002',
                    customer: 'Georgia Tech Research Center', 
                    address: '505 10th St NW, Atlanta', 
                    volume: 750, 
                    priority: 'high', 
                    status: 'pending',
                    deliveryDate: '2026-01-15',
                    revenue: 1280,
                    lat: 33.7810,
                    lng: -84.4000,
                    state: 'Georgia',
                    preferredDC: 'DC-GA-001',
                    products: { 'SKU-20': 28, 'SKU-30': 10, 'SKU-33': 6, 'SKU-40': 4, 'SKU-100': 2 }
                },
                { 
                    id: 'ORD-GA-005',
                    customerId: 'CUST-GA-003',
                    customer: 'Atlanta Convention Center', 
                    address: '285 Andrew Young Intl Blvd, Atlanta', 
                    volume: 580, 
                    priority: 'normal', 
                    status: 'pending',
                    deliveryDate: '2026-01-15',
                    revenue: 990,
                    lat: 33.7600,
                    lng: -84.3950,
                    state: 'Georgia',
                    preferredDC: 'DC-GA-001',
                    products: { 'SKU-20': 20, 'SKU-30': 8, 'SKU-33': 4, 'SKU-40': 3 }
                },
                { 
                    id: 'ORD-GA-006',
                    customerId: 'CUST-GA-004',
                    customer: 'Mercedes-Benz Stadium', 
                    address: '1 AMB Dr NW, Atlanta', 
                    volume: 1100, 
                    priority: 'high', 
                    status: 'pending',
                    deliveryDate: '2026-01-15',
                    revenue: 1890,
                    lat: 33.7553,
                    lng: -84.4006,
                    state: 'Georgia',
                    preferredDC: 'DC-GA-001',
                    products: { 'SKU-20': 42, 'SKU-30': 14, 'SKU-33': 10, 'SKU-40': 6, 'SKU-100': 3 }
                },
                // Florida orders
                { 
                    id: 'ORD-FL-001',
                    customerId: 'CUST-FL-001',
                    customer: 'Jacksonville Port Authority', 
                    address: '2831 Talleyrand Ave, Jacksonville', 
                    volume: 1500, 
                    priority: 'high', 
                    status: 'assigned',
                    deliveryDate: '2026-01-15',
                    revenue: 2650,
                    lat: 30.3370,
                    lng: -81.6290,
                    state: 'Florida',
                    preferredDC: 'DC-FL-001',
                    products: { 'SKU-20': 48, 'SKU-30': 16, 'SKU-33': 12, 'SKU-40': 8, 'SKU-100': 4 }
                },
                { 
                    id: 'ORD-FL-002',
                    customerId: 'CUST-FL-002',
                    customer: 'Tampa Bay Resort', 
                    address: '5500 Gulf Blvd, St. Pete Beach', 
                    volume: 800, 
                    priority: 'medium', 
                    status: 'assigned',
                    deliveryDate: '2026-01-15',
                    revenue: 1380,
                    lat: 27.7250,
                    lng: -82.7430,
                    state: 'Florida',
                    preferredDC: 'DC-FL-001',
                    products: { 'SKU-20': 36, 'SKU-30': 12, 'SKU-33': 8, 'SKU-40': 6, 'SKU-100': 2 }
                },
                { 
                    id: 'ORD-FL-003',
                    customerId: 'CUST-FL-003',
                    customer: 'Orlando Convention Center', 
                    address: '9800 International Dr, Orlando', 
                    volume: 680, 
                    priority: 'high', 
                    status: 'assigned',
                    deliveryDate: '2026-01-15',
                    revenue: 1160,
                    lat: 28.4262,
                    lng: -81.4695,
                    state: 'Florida',
                    preferredDC: 'DC-FL-001',
                    products: { 'SKU-20': 24, 'SKU-30': 8, 'SKU-33': 6, 'SKU-40': 4, 'SKU-100': 2 }
                },
                { 
                    id: 'ORD-FL-004',
                    customerId: 'CUST-FL-004',
                    customer: 'Miami Beach Hotels', 
                    address: '1701 Collins Ave, Miami Beach', 
                    volume: 450, 
                    priority: 'normal', 
                    status: 'assigned',
                    deliveryDate: '2026-01-15',
                    revenue: 770,
                    lat: 25.7907,
                    lng: -80.1300,
                    state: 'Florida',
                    preferredDC: 'DC-FL-001',
                    products: { 'SKU-20': 12, 'SKU-30': 6, 'SKU-33': 4, 'SKU-40': 4, 'SKU-100': 1 }
                },
                { 
                    id: 'ORD-FL-005',
                    customerId: 'CUST-FL-005',
                    customer: 'Gainesville Industrial Park', 
                    address: '3600 SW 42nd Ave, Gainesville', 
                    volume: 520, 
                    priority: 'normal', 
                    status: 'pending',
                    deliveryDate: '2026-01-15',
                    revenue: 890,
                    lat: 29.6100,
                    lng: -82.3800,
                    state: 'Florida',
                    preferredDC: 'DC-FL-001',
                    products: { 'SKU-20': 18, 'SKU-30': 6, 'SKU-33': 4, 'SKU-40': 3, 'SKU-100': 1 }
                },
                { 
                    id: 'ORD-FL-006',
                    customerId: 'CUST-FL-006',
                    customer: 'Daytona Speedway', 
                    address: '1801 W International Speedway Blvd, Daytona Beach', 
                    volume: 720, 
                    priority: 'medium', 
                    status: 'pending',
                    deliveryDate: '2026-01-15',
                    revenue: 1230,
                    lat: 29.1857,
                    lng: -81.0700,
                    state: 'Florida',
                    preferredDC: 'DC-FL-001',
                    products: { 'SKU-20': 26, 'SKU-30': 10, 'SKU-33': 6, 'SKU-40': 4, 'SKU-100': 2 }
                },
                { 
                    id: 'ORD-FL-007',
                    customerId: 'CUST-FL-007',
                    customer: 'Clearwater Marine Center', 
                    address: '249 Windward Passage, Clearwater', 
                    volume: 340, 
                    priority: 'low', 
                    status: 'pending',
                    deliveryDate: '2026-01-15',
                    revenue: 580,
                    lat: 27.9778,
                    lng: -82.8270,
                    state: 'Florida',
                    preferredDC: 'DC-FL-001',
                    products: { 'SKU-20': 14, 'SKU-30': 4, 'SKU-33': 2, 'SKU-40': 2 }
                },
                // Tennessee orders (10 orders for Nashville DC)
                { id: 'ORD-TN-001', customerId: 'CUST-TN-001', customer: 'Grand Ole Opry', address: '2804 Opryland Dr, Nashville', volume: 550, priority: 'high', status: 'assigned', deliveryDate: '2026-01-15', revenue: 920, lat: 36.2067, lng: -86.6920, state: 'Tennessee', preferredDC: 'DC-TN-001', products: { 'SKU-20': 16, 'SKU-30': 6, 'SKU-33': 4, 'SKU-40': 3, 'SKU-100': 1 } },
                { id: 'ORD-TN-002', customerId: 'CUST-TN-002', customer: 'Ryman Auditorium', address: '116 5th Ave N, Nashville', volume: 480, priority: 'high', status: 'assigned', deliveryDate: '2026-01-15', revenue: 820, lat: 36.1612, lng: -86.7785, state: 'Tennessee', preferredDC: 'DC-TN-001', products: { 'SKU-20': 18, 'SKU-30': 6, 'SKU-33': 4, 'SKU-40': 3, 'SKU-100': 1 } },
                { id: 'ORD-TN-003', customerId: 'CUST-TN-003', customer: 'Nissan Stadium', address: '1 Titans Way, Nashville', volume: 420, priority: 'medium', status: 'assigned', deliveryDate: '2026-01-15', revenue: 720, lat: 36.1665, lng: -86.7713, state: 'Tennessee', preferredDC: 'DC-TN-001', products: { 'SKU-20': 14, 'SKU-30': 5, 'SKU-33': 3, 'SKU-40': 2, 'SKU-100': 1 } },
                { id: 'ORD-TN-004', customerId: 'CUST-TN-004', customer: 'Vanderbilt University', address: '2201 West End Ave, Nashville', volume: 520, priority: 'medium', status: 'assigned', deliveryDate: '2026-01-15', revenue: 890, lat: 36.1447, lng: -86.8027, state: 'Tennessee', preferredDC: 'DC-TN-001', products: { 'SKU-20': 16, 'SKU-30': 5, 'SKU-33': 4, 'SKU-40': 2, 'SKU-100': 1 } },
                { id: 'ORD-TN-005', customerId: 'CUST-TN-005', customer: 'Nashville Zoo', address: '3777 Nolensville Pike, Nashville', volume: 480, priority: 'medium', status: 'assigned', deliveryDate: '2026-01-15', revenue: 820, lat: 36.0660, lng: -86.7400, state: 'Tennessee', preferredDC: 'DC-TN-001', products: { 'SKU-20': 16, 'SKU-30': 5, 'SKU-33': 3, 'SKU-40': 2, 'SKU-100': 1 } },
                { id: 'ORD-TN-006', customerId: 'CUST-TN-006', customer: 'Bridgestone Arena', address: '501 Broadway, Nashville', volume: 650, priority: 'high', status: 'pending', deliveryDate: '2026-01-15', revenue: 1120, lat: 36.1592, lng: -86.7785, state: 'Tennessee', preferredDC: 'DC-TN-001', products: { 'SKU-20': 20, 'SKU-30': 7, 'SKU-33': 5, 'SKU-40': 3, 'SKU-100': 1 } },
                { id: 'ORD-TN-007', customerId: 'CUST-TN-007', customer: 'Tennessee State Capitol', address: '600 Charlotte Ave, Nashville', volume: 380, priority: 'medium', status: 'pending', deliveryDate: '2026-01-15', revenue: 650, lat: 36.1663, lng: -86.7843, state: 'Tennessee', preferredDC: 'DC-TN-001', products: { 'SKU-20': 12, 'SKU-30': 4, 'SKU-33': 3, 'SKU-40': 2 } },
                { id: 'ORD-TN-008', customerId: 'CUST-TN-008', customer: 'Nashville Intl Airport', address: '1 Terminal Dr, Nashville', volume: 720, priority: 'high', status: 'pending', deliveryDate: '2026-01-15', revenue: 1240, lat: 36.1245, lng: -86.6782, state: 'Tennessee', preferredDC: 'DC-TN-001', products: { 'SKU-20': 22, 'SKU-30': 8, 'SKU-33': 5, 'SKU-40': 4, 'SKU-100': 2 } },
                { id: 'ORD-TN-009', customerId: 'CUST-TN-009', customer: 'Gaylord Opryland Resort', address: '2800 Opryland Dr, Nashville', volume: 580, priority: 'medium', status: 'pending', deliveryDate: '2026-01-15', revenue: 990, lat: 36.2089, lng: -86.6951, state: 'Tennessee', preferredDC: 'DC-TN-001', products: { 'SKU-20': 18, 'SKU-30': 6, 'SKU-33': 4, 'SKU-40': 3, 'SKU-100': 1 } },
                { id: 'ORD-TN-010', customerId: 'CUST-TN-010', customer: 'Nashville Superspeedway', address: '4847 McCrary Rd, Lebanon', volume: 450, priority: 'low', status: 'pending', deliveryDate: '2026-01-15', revenue: 770, lat: 36.0520, lng: -86.3936, state: 'Tennessee', preferredDC: 'DC-TN-001', products: { 'SKU-20': 14, 'SKU-30': 5, 'SKU-33': 3, 'SKU-40': 2, 'SKU-100': 1 } },
                // North Carolina orders (10 orders for Charlotte DC)
                { id: 'ORD-NC-001', customerId: 'CUST-NC-001', customer: 'Charlotte Motor Speedway', address: '5555 Concord Pkwy S, Charlotte', volume: 1100, priority: 'high', status: 'assigned', deliveryDate: '2026-01-15', revenue: 1900, lat: 35.3560, lng: -80.6830, state: 'North Carolina', preferredDC: 'DC-NC-001', products: { 'SKU-20': 18, 'SKU-30': 6, 'SKU-33': 4, 'SKU-40': 3, 'SKU-100': 1 } },
                { id: 'ORD-NC-002', customerId: 'CUST-NC-002', customer: 'Bank of America Stadium', address: '800 S Mint St, Charlotte', volume: 850, priority: 'high', status: 'assigned', deliveryDate: '2026-01-15', revenue: 1460, lat: 35.2258, lng: -80.8528, state: 'North Carolina', preferredDC: 'DC-NC-001', products: { 'SKU-20': 16, 'SKU-30': 5, 'SKU-33': 4, 'SKU-40': 2, 'SKU-100': 1 } },
                { id: 'ORD-NC-003', customerId: 'CUST-NC-003', customer: 'Duke Energy Center', address: '400 S College St, Charlotte', volume: 720, priority: 'medium', status: 'assigned', deliveryDate: '2026-01-15', revenue: 1230, lat: 35.2243, lng: -80.8436, state: 'North Carolina', preferredDC: 'DC-NC-001', products: { 'SKU-20': 17, 'SKU-30': 6, 'SKU-33': 4, 'SKU-40': 3, 'SKU-100': 1 } },
                { id: 'ORD-NC-004', customerId: 'CUST-NC-004', customer: 'Charlotte Douglas Airport', address: '5501 Josh Birmingham Pkwy, Charlotte', volume: 950, priority: 'high', status: 'assigned', deliveryDate: '2026-01-15', revenue: 1630, lat: 35.2140, lng: -80.9431, state: 'North Carolina', preferredDC: 'DC-NC-001', products: { 'SKU-20': 17, 'SKU-30': 5, 'SKU-33': 3, 'SKU-40': 2, 'SKU-100': 1 } },
                { id: 'ORD-NC-005', customerId: 'CUST-NC-005', customer: 'NASCAR Hall of Fame', address: '400 E MLK Jr Blvd, Charlotte', volume: 580, priority: 'medium', status: 'pending', deliveryDate: '2026-01-15', revenue: 990, lat: 35.2207, lng: -80.8428, state: 'North Carolina', preferredDC: 'DC-NC-001', products: { 'SKU-20': 16, 'SKU-30': 6, 'SKU-33': 4, 'SKU-40': 2, 'SKU-100': 1 } },
                { id: 'ORD-NC-006', customerId: 'CUST-NC-006', customer: 'UNC Charlotte', address: '9201 University City Blvd, Charlotte', volume: 620, priority: 'medium', status: 'pending', deliveryDate: '2026-01-15', revenue: 1060, lat: 35.3075, lng: -80.7329, state: 'North Carolina', preferredDC: 'DC-NC-001', products: { 'SKU-20': 18, 'SKU-30': 6, 'SKU-33': 4, 'SKU-40': 3, 'SKU-100': 1 } },
                { id: 'ORD-NC-007', customerId: 'CUST-NC-007', customer: 'Research Triangle Park', address: '12 Davis Dr, Durham', volume: 780, priority: 'high', status: 'pending', deliveryDate: '2026-01-15', revenue: 1340, lat: 35.8992, lng: -78.8637, state: 'North Carolina', preferredDC: 'DC-NC-001', products: { 'SKU-20': 20, 'SKU-30': 7, 'SKU-33': 5, 'SKU-40': 3, 'SKU-100': 1 } },
                { id: 'ORD-NC-008', customerId: 'CUST-NC-008', customer: 'Spectrum Center', address: '333 E Trade St, Charlotte', volume: 680, priority: 'medium', status: 'pending', deliveryDate: '2026-01-15', revenue: 1170, lat: 35.2251, lng: -80.8392, state: 'North Carolina', preferredDC: 'DC-NC-001', products: { 'SKU-20': 18, 'SKU-30': 6, 'SKU-33': 4, 'SKU-40': 3, 'SKU-100': 1 } },
                { id: 'ORD-NC-009', customerId: 'CUST-NC-009', customer: 'Carowinds', address: '14523 Carowinds Blvd, Charlotte', volume: 520, priority: 'low', status: 'pending', deliveryDate: '2026-01-15', revenue: 890, lat: 35.1045, lng: -80.9437, state: 'North Carolina', preferredDC: 'DC-NC-001', products: { 'SKU-20': 15, 'SKU-30': 5, 'SKU-33': 3, 'SKU-40': 2, 'SKU-100': 1 } },
                { id: 'ORD-NC-010', customerId: 'CUST-NC-010', customer: 'Charlotte Convention Center', address: '501 S College St, Charlotte', volume: 480, priority: 'low', status: 'pending', deliveryDate: '2026-01-15', revenue: 820, lat: 35.2197, lng: -80.8456, state: 'North Carolina', preferredDC: 'DC-NC-001', products: { 'SKU-20': 14, 'SKU-30': 5, 'SKU-33': 3, 'SKU-40': 2, 'SKU-100': 1 } },
                // South Carolina orders (10 orders for Columbia DC)
                { id: 'ORD-SC-001', customerId: 'CUST-SC-001', customer: 'Columbia Medical Center', address: '5 Richland Medical Park Dr, Columbia', volume: 600, priority: 'high', status: 'assigned', deliveryDate: '2026-01-15', revenue: 1050, lat: 34.0320, lng: -81.0430, state: 'South Carolina', preferredDC: 'DC-SC-001', products: { 'SKU-20': 15, 'SKU-30': 5, 'SKU-33': 4, 'SKU-40': 2, 'SKU-100': 1 } },
                { id: 'ORD-SC-002', customerId: 'CUST-SC-002', customer: 'University of South Carolina', address: '1600 Hampton St, Columbia', volume: 550, priority: 'medium', status: 'assigned', deliveryDate: '2026-01-15', revenue: 940, lat: 33.9970, lng: -81.0261, state: 'South Carolina', preferredDC: 'DC-SC-001', products: { 'SKU-20': 15, 'SKU-30': 5, 'SKU-33': 3, 'SKU-40': 2, 'SKU-100': 1 } },
                { id: 'ORD-SC-003', customerId: 'CUST-SC-003', customer: 'SC State House', address: '1100 Gervais St, Columbia', volume: 480, priority: 'medium', status: 'assigned', deliveryDate: '2026-01-15', revenue: 820, lat: 34.0004, lng: -81.0329, state: 'South Carolina', preferredDC: 'DC-SC-001', products: { 'SKU-20': 15, 'SKU-30': 5, 'SKU-33': 4, 'SKU-40': 2, 'SKU-100': 1 } },
                { id: 'ORD-SC-004', customerId: 'CUST-SC-004', customer: 'Williams-Brice Stadium', address: '1125 George Rogers Blvd, Columbia', volume: 720, priority: 'high', status: 'assigned', deliveryDate: '2026-01-15', revenue: 1230, lat: 33.9728, lng: -81.0197, state: 'South Carolina', preferredDC: 'DC-SC-001', products: { 'SKU-20': 15, 'SKU-30': 5, 'SKU-33': 3, 'SKU-40': 3, 'SKU-100': 1 } },
                { id: 'ORD-SC-005', customerId: 'CUST-SC-005', customer: 'Columbia Metro Airport', address: '3250 Airport Blvd, West Columbia', volume: 580, priority: 'medium', status: 'pending', deliveryDate: '2026-01-15', revenue: 990, lat: 33.9389, lng: -81.1193, state: 'South Carolina', preferredDC: 'DC-SC-001', products: { 'SKU-20': 16, 'SKU-30': 5, 'SKU-33': 3, 'SKU-40': 2, 'SKU-100': 1 } },
                { id: 'ORD-SC-006', customerId: 'CUST-SC-006', customer: 'Riverbanks Zoo', address: '500 Wildlife Pkwy, Columbia', volume: 420, priority: 'low', status: 'pending', deliveryDate: '2026-01-15', revenue: 720, lat: 34.0060, lng: -81.0713, state: 'South Carolina', preferredDC: 'DC-SC-001', products: { 'SKU-20': 14, 'SKU-30': 4, 'SKU-33': 3, 'SKU-40': 2 } },
                { id: 'ORD-SC-007', customerId: 'CUST-SC-007', customer: 'Midlands Technical College', address: '316 S Beltline Blvd, Columbia', volume: 510, priority: 'medium', status: 'pending', deliveryDate: '2026-01-15', revenue: 870, lat: 33.9810, lng: -81.0810, state: 'South Carolina', preferredDC: 'DC-SC-001', products: { 'SKU-20': 15, 'SKU-30': 5, 'SKU-33': 3, 'SKU-40': 2, 'SKU-100': 1 } },
                { id: 'ORD-SC-008', customerId: 'CUST-SC-008', customer: 'Colonial Life Arena', address: '801 Lincoln St, Columbia', volume: 650, priority: 'high', status: 'pending', deliveryDate: '2026-01-15', revenue: 1110, lat: 33.9931, lng: -81.0245, state: 'South Carolina', preferredDC: 'DC-SC-001', products: { 'SKU-20': 18, 'SKU-30': 6, 'SKU-33': 4, 'SKU-40': 3, 'SKU-100': 1 } },
                { id: 'ORD-SC-009', customerId: 'CUST-SC-009', customer: 'Sandhill Shopping Center', address: '461 Town Center Pl, Columbia', volume: 380, priority: 'low', status: 'pending', deliveryDate: '2026-01-15', revenue: 650, lat: 34.0519, lng: -80.9454, state: 'South Carolina', preferredDC: 'DC-SC-001', products: { 'SKU-20': 12, 'SKU-30': 4, 'SKU-33': 2, 'SKU-40': 2 } },
                { id: 'ORD-SC-010', customerId: 'CUST-SC-010', customer: 'Fort Jackson', address: '4442 Jackson Blvd, Columbia', volume: 520, priority: 'medium', status: 'pending', deliveryDate: '2026-01-15', revenue: 890, lat: 34.0220, lng: -80.9350, state: 'South Carolina', preferredDC: 'DC-SC-001', products: { 'SKU-20': 15, 'SKU-30': 5, 'SKU-33': 3, 'SKU-40': 2, 'SKU-100': 1 } },
                // Mississippi orders (10 orders for Jackson DC)
                { id: 'ORD-MS-001', customerId: 'CUST-MS-001', customer: 'Jackson Convention Center', address: '105 E Pascagoula St, Jackson', volume: 480, priority: 'medium', status: 'assigned', deliveryDate: '2026-01-15', revenue: 820, lat: 32.2988, lng: -90.1826, state: 'Mississippi', preferredDC: 'DC-MS-001', products: { 'SKU-20': 14, 'SKU-30': 5, 'SKU-33': 3, 'SKU-40': 2, 'SKU-100': 1 } },
                { id: 'ORD-MS-002', customerId: 'CUST-MS-002', customer: 'UMMC Hospital', address: '2500 N State St, Jackson', volume: 620, priority: 'high', status: 'assigned', deliveryDate: '2026-01-15', revenue: 1060, lat: 32.3310, lng: -90.1756, state: 'Mississippi', preferredDC: 'DC-MS-001', products: { 'SKU-20': 14, 'SKU-30': 5, 'SKU-33': 3, 'SKU-40': 2, 'SKU-100': 1 } },
                { id: 'ORD-MS-003', customerId: 'CUST-MS-003', customer: 'MS State Fairgrounds', address: '1207 Mississippi St, Jackson', volume: 520, priority: 'medium', status: 'assigned', deliveryDate: '2026-01-15', revenue: 890, lat: 32.3041, lng: -90.1804, state: 'Mississippi', preferredDC: 'DC-MS-001', products: { 'SKU-20': 14, 'SKU-30': 4, 'SKU-33': 3, 'SKU-40': 2, 'SKU-100': 1 } },
                { id: 'ORD-MS-004', customerId: 'CUST-MS-004', customer: 'Jackson State University', address: '1400 J R Lynch St, Jackson', volume: 450, priority: 'medium', status: 'assigned', deliveryDate: '2026-01-15', revenue: 770, lat: 32.2970, lng: -90.2048, state: 'Mississippi', preferredDC: 'DC-MS-001', products: { 'SKU-20': 14, 'SKU-30': 5, 'SKU-33': 3, 'SKU-40': 2, 'SKU-100': 1 } },
                { id: 'ORD-MS-005', customerId: 'CUST-MS-005', customer: 'MS Museum Natural Science', address: '2148 Riverside Dr, Jackson', volume: 380, priority: 'low', status: 'assigned', deliveryDate: '2026-01-15', revenue: 650, lat: 32.3284, lng: -90.1562, state: 'Mississippi', preferredDC: 'DC-MS-001', products: { 'SKU-20': 14, 'SKU-30': 5, 'SKU-33': 3, 'SKU-40': 2, 'SKU-100': 1 } },
                { id: 'ORD-MS-006', customerId: 'CUST-MS-006', customer: 'MS Agriculture Museum', address: '1150 Lakeland Dr, Jackson', volume: 420, priority: 'low', status: 'assigned', deliveryDate: '2026-01-15', revenue: 720, lat: 32.3316, lng: -90.1436, state: 'Mississippi', preferredDC: 'DC-MS-001', products: { 'SKU-20': 14, 'SKU-30': 4, 'SKU-33': 3, 'SKU-40': 2, 'SKU-100': 1 } },
                { id: 'ORD-MS-007', customerId: 'CUST-MS-007', customer: 'Jackson Industrial Park', address: '200 Industrial Dr, Jackson', volume: 580, priority: 'medium', status: 'pending', deliveryDate: '2026-01-15', revenue: 990, lat: 32.2800, lng: -90.2100, state: 'Mississippi', preferredDC: 'DC-MS-001', products: { 'SKU-20': 16, 'SKU-30': 5, 'SKU-33': 4, 'SKU-40': 2, 'SKU-100': 1 } },
                { id: 'ORD-MS-008', customerId: 'CUST-MS-008', customer: 'Trustmark Park', address: '1 Braves Way, Pearl', volume: 480, priority: 'medium', status: 'pending', deliveryDate: '2026-01-15', revenue: 820, lat: 32.2756, lng: -90.0985, state: 'Mississippi', preferredDC: 'DC-MS-001', products: { 'SKU-20': 14, 'SKU-30': 5, 'SKU-33': 3, 'SKU-40': 2, 'SKU-100': 1 } },
                { id: 'ORD-MS-009', customerId: 'CUST-MS-009', customer: 'MS Farm Bureau', address: '6311 Ridgewood Rd, Jackson', volume: 420, priority: 'low', status: 'pending', deliveryDate: '2026-01-15', revenue: 720, lat: 32.3680, lng: -90.1310, state: 'Mississippi', preferredDC: 'DC-MS-001', products: { 'SKU-20': 12, 'SKU-30': 4, 'SKU-33': 3, 'SKU-40': 2 } },
                { id: 'ORD-MS-010', customerId: 'CUST-MS-010', customer: 'Jackson Mall', address: '350 W Woodrow Wilson Ave, Jackson', volume: 380, priority: 'low', status: 'pending', deliveryDate: '2026-01-15', revenue: 650, lat: 32.3290, lng: -90.1880, state: 'Mississippi', preferredDC: 'DC-MS-001', products: { 'SKU-20': 12, 'SKU-30': 4, 'SKU-33': 2, 'SKU-40': 2 } },
                // Louisiana orders (10 orders for Baton Rouge DC)
                { id: 'ORD-LA-001', customerId: 'CUST-LA-001', customer: 'ExxonMobil Refinery', address: '4999 Scenic Hwy, Baton Rouge', volume: 850, priority: 'high', status: 'assigned', deliveryDate: '2026-01-15', revenue: 1460, lat: 30.5102, lng: -91.1285, state: 'Louisiana', preferredDC: 'DC-LA-001', products: { 'SKU-20': 16, 'SKU-30': 5, 'SKU-33': 4, 'SKU-40': 2, 'SKU-100': 1 } },
                { id: 'ORD-LA-002', customerId: 'CUST-LA-002', customer: 'Louisiana State Capitol', address: 'State Capitol Dr, Baton Rouge', volume: 520, priority: 'medium', status: 'assigned', deliveryDate: '2026-01-15', revenue: 890, lat: 30.4571, lng: -91.1873, state: 'Louisiana', preferredDC: 'DC-LA-001', products: { 'SKU-20': 15, 'SKU-30': 5, 'SKU-33': 3, 'SKU-40': 2, 'SKU-100': 1 } },
                { id: 'ORD-LA-003', customerId: 'CUST-LA-003', customer: 'Tiger Stadium LSU', address: 'N Stadium Dr, Baton Rouge', volume: 720, priority: 'high', status: 'assigned', deliveryDate: '2026-01-15', revenue: 1230, lat: 30.4120, lng: -91.1839, state: 'Louisiana', preferredDC: 'DC-LA-001', products: { 'SKU-20': 16, 'SKU-30': 5, 'SKU-33': 4, 'SKU-40': 2, 'SKU-100': 1 } },
                { id: 'ORD-LA-004', customerId: 'CUST-LA-004', customer: 'Baton Rouge General Hospital', address: '3600 Florida Blvd, Baton Rouge', volume: 580, priority: 'high', status: 'assigned', deliveryDate: '2026-01-15', revenue: 990, lat: 30.4608, lng: -91.1252, state: 'Louisiana', preferredDC: 'DC-LA-001', products: { 'SKU-20': 15, 'SKU-30': 5, 'SKU-33': 3, 'SKU-40': 2, 'SKU-100': 1 } },
                { id: 'ORD-LA-005', customerId: 'CUST-LA-005', customer: 'Port of Baton Rouge', address: '501 Main St, Baton Rouge', volume: 680, priority: 'high', status: 'assigned', deliveryDate: '2026-01-15', revenue: 1170, lat: 30.4507, lng: -91.1911, state: 'Louisiana', preferredDC: 'DC-LA-001', products: { 'SKU-20': 15, 'SKU-30': 5, 'SKU-33': 3, 'SKU-40': 2, 'SKU-100': 1 } },
                { id: 'ORD-LA-006', customerId: 'CUST-LA-006', customer: 'Raising Canes River Center', address: '275 S River Rd, Baton Rouge', volume: 480, priority: 'medium', status: 'assigned', deliveryDate: '2026-01-15', revenue: 820, lat: 30.4466, lng: -91.1886, state: 'Louisiana', preferredDC: 'DC-LA-001', products: { 'SKU-20': 16, 'SKU-30': 6, 'SKU-33': 3, 'SKU-40': 3, 'SKU-100': 1 } },
                { id: 'ORD-LA-007', customerId: 'CUST-LA-007', customer: 'LSU PMAC Arena', address: 'N Stadium Rd, Baton Rouge', volume: 620, priority: 'medium', status: 'pending', deliveryDate: '2026-01-15', revenue: 1060, lat: 30.4152, lng: -91.1750, state: 'Louisiana', preferredDC: 'DC-LA-001', products: { 'SKU-20': 18, 'SKU-30': 6, 'SKU-33': 4, 'SKU-40': 3, 'SKU-100': 1 } },
                { id: 'ORD-LA-008', customerId: 'CUST-LA-008', customer: 'Mall of Louisiana', address: '6401 Bluebonnet Blvd, Baton Rouge', volume: 420, priority: 'low', status: 'pending', deliveryDate: '2026-01-15', revenue: 720, lat: 30.3893, lng: -91.0893, state: 'Louisiana', preferredDC: 'DC-LA-001', products: { 'SKU-20': 14, 'SKU-30': 4, 'SKU-33': 3, 'SKU-40': 2 } },
                { id: 'ORD-LA-009', customerId: 'CUST-LA-009', customer: 'Dow Chemical Plant', address: '13353 Hwy 1, Plaquemine', volume: 780, priority: 'high', status: 'pending', deliveryDate: '2026-01-15', revenue: 1340, lat: 30.2882, lng: -91.2345, state: 'Louisiana', preferredDC: 'DC-LA-001', products: { 'SKU-20': 18, 'SKU-30': 6, 'SKU-33': 4, 'SKU-40': 3, 'SKU-100': 1 } },
                { id: 'ORD-LA-010', customerId: 'CUST-LA-010', customer: 'Baton Rouge Metro Airport', address: '9430 Jackie Cochran Dr, Baton Rouge', volume: 480, priority: 'medium', status: 'pending', deliveryDate: '2026-01-15', revenue: 820, lat: 30.5330, lng: -91.1496, state: 'Louisiana', preferredDC: 'DC-LA-001', products: { 'SKU-20': 14, 'SKU-30': 5, 'SKU-33': 3, 'SKU-40': 2, 'SKU-100': 1 } },
                // Kentucky orders (10 orders for Louisville DC)
                { id: 'ORD-KY-001', customerId: 'CUST-KY-001', customer: 'Jim Beam Distillery', address: '526 Happy Hollow Rd, Clermont', volume: 620, priority: 'high', status: 'assigned', deliveryDate: '2026-01-15', revenue: 1060, lat: 37.8169, lng: -85.6481, state: 'Kentucky', preferredDC: 'DC-KY-001', products: { 'SKU-20': 15, 'SKU-30': 5, 'SKU-33': 3, 'SKU-40': 2, 'SKU-100': 1 } },
                { id: 'ORD-KY-002', customerId: 'CUST-KY-002', customer: 'Churchill Downs', address: '700 Central Ave, Louisville', volume: 850, priority: 'high', status: 'assigned', deliveryDate: '2026-01-15', revenue: 1460, lat: 38.2026, lng: -85.7706, state: 'Kentucky', preferredDC: 'DC-KY-001', products: { 'SKU-20': 14, 'SKU-30': 5, 'SKU-33': 4, 'SKU-40': 2, 'SKU-100': 1 } },
                { id: 'ORD-KY-003', customerId: 'CUST-KY-003', customer: 'Louisville Slugger Museum', address: '800 W Main St, Louisville', volume: 480, priority: 'medium', status: 'assigned', deliveryDate: '2026-01-15', revenue: 820, lat: 38.2574, lng: -85.7641, state: 'Kentucky', preferredDC: 'DC-KY-001', products: { 'SKU-20': 14, 'SKU-30': 5, 'SKU-33': 3, 'SKU-40': 2, 'SKU-100': 1 } },
                { id: 'ORD-KY-004', customerId: 'CUST-KY-004', customer: 'KFC Yum Center', address: '1 Arena Plaza, Louisville', volume: 720, priority: 'high', status: 'assigned', deliveryDate: '2026-01-15', revenue: 1230, lat: 38.2575, lng: -85.7585, state: 'Kentucky', preferredDC: 'DC-KY-001', products: { 'SKU-20': 15, 'SKU-30': 4, 'SKU-33': 3, 'SKU-40': 2, 'SKU-100': 1 } },
                { id: 'ORD-KY-005', customerId: 'CUST-KY-005', customer: 'UPS Worldport', address: '911 Grade Ln, Louisville', volume: 980, priority: 'high', status: 'pending', deliveryDate: '2026-01-15', revenue: 1680, lat: 38.0012, lng: -85.7180, state: 'Kentucky', preferredDC: 'DC-KY-001', products: { 'SKU-20': 20, 'SKU-30': 7, 'SKU-33': 5, 'SKU-40': 4, 'SKU-100': 2 } },
                { id: 'ORD-KY-006', customerId: 'CUST-KY-006', customer: 'University of Louisville', address: '2301 S 3rd St, Louisville', volume: 550, priority: 'medium', status: 'pending', deliveryDate: '2026-01-15', revenue: 940, lat: 38.2167, lng: -85.7585, state: 'Kentucky', preferredDC: 'DC-KY-001', products: { 'SKU-20': 16, 'SKU-30': 5, 'SKU-33': 4, 'SKU-40': 2, 'SKU-100': 1 } },
                { id: 'ORD-KY-007', customerId: 'CUST-KY-007', customer: 'Louisville Zoo', address: '1100 Trevilian Way, Louisville', volume: 420, priority: 'low', status: 'pending', deliveryDate: '2026-01-15', revenue: 720, lat: 38.2091, lng: -85.7176, state: 'Kentucky', preferredDC: 'DC-KY-001', products: { 'SKU-20': 14, 'SKU-30': 4, 'SKU-33': 3, 'SKU-40': 2 } },
                { id: 'ORD-KY-008', customerId: 'CUST-KY-008', customer: 'GE Appliances Park', address: '4000 Buechel Bank Rd, Louisville', volume: 780, priority: 'high', status: 'pending', deliveryDate: '2026-01-15', revenue: 1340, lat: 38.1935, lng: -85.6553, state: 'Kentucky', preferredDC: 'DC-KY-001', products: { 'SKU-20': 18, 'SKU-30': 6, 'SKU-33': 4, 'SKU-40': 3, 'SKU-100': 1 } },
                { id: 'ORD-KY-009', customerId: 'CUST-KY-009', customer: 'KY Fair Expo Center', address: '937 Phillips Ln, Louisville', volume: 650, priority: 'medium', status: 'pending', deliveryDate: '2026-01-15', revenue: 1110, lat: 38.1940, lng: -85.7481, state: 'Kentucky', preferredDC: 'DC-KY-001', products: { 'SKU-20': 16, 'SKU-30': 6, 'SKU-33': 4, 'SKU-40': 3, 'SKU-100': 1 } },
                { id: 'ORD-KY-010', customerId: 'CUST-KY-010', customer: 'Louisville Intl Airport', address: '600 Terminal Dr, Louisville', volume: 520, priority: 'medium', status: 'pending', deliveryDate: '2026-01-15', revenue: 890, lat: 38.1781, lng: -85.7272, state: 'Kentucky', preferredDC: 'DC-KY-001', products: { 'SKU-20': 15, 'SKU-30': 5, 'SKU-33': 3, 'SKU-40': 2, 'SKU-100': 1 } },
                // Additional Alabama orders for Birmingham DC route
                { id: 'ORD-AL-010', customerId: 'CUST-AL-010', customer: 'US Steel Birmingham', address: '1200 41st St N, Birmingham', volume: 680, priority: 'high', status: 'assigned', deliveryDate: '2026-01-15', revenue: 1170, lat: 33.5510, lng: -86.8190, state: 'Alabama', preferredDC: 'DC-AL-002', products: { 'SKU-20': 14, 'SKU-30': 5, 'SKU-33': 3, 'SKU-40': 2, 'SKU-100': 1 } },
                { id: 'ORD-AL-011', customerId: 'CUST-AL-011', customer: 'Vulcan Materials HQ', address: '1200 Urban Center Dr, Birmingham', volume: 520, priority: 'medium', status: 'assigned', deliveryDate: '2026-01-15', revenue: 890, lat: 33.4490, lng: -86.8227, state: 'Alabama', preferredDC: 'DC-AL-002', products: { 'SKU-20': 13, 'SKU-30': 4, 'SKU-33': 3, 'SKU-40': 2, 'SKU-100': 1 } },
                { id: 'ORD-AL-012', customerId: 'CUST-AL-012', customer: 'Regions Field', address: '1401 1st Ave S, Birmingham', volume: 580, priority: 'medium', status: 'assigned', deliveryDate: '2026-01-15', revenue: 990, lat: 33.5086, lng: -86.8025, state: 'Alabama', preferredDC: 'DC-AL-002', products: { 'SKU-20': 14, 'SKU-30': 5, 'SKU-33': 3, 'SKU-40': 2, 'SKU-100': 1 } },
                { id: 'ORD-AL-013', customerId: 'CUST-AL-013', customer: 'Birmingham Airport', address: '5900 Messer Airport Hwy, Birmingham', volume: 480, priority: 'medium', status: 'assigned', deliveryDate: '2026-01-15', revenue: 820, lat: 33.5628, lng: -86.7535, state: 'Alabama', preferredDC: 'DC-AL-002', products: { 'SKU-20': 13, 'SKU-30': 4, 'SKU-33': 3, 'SKU-40': 2, 'SKU-100': 1 } },
                { id: 'ORD-AL-014', customerId: 'CUST-AL-014', customer: 'UAB Hospital', address: '619 19th St S, Birmingham', volume: 720, priority: 'high', status: 'pending', deliveryDate: '2026-01-15', revenue: 1230, lat: 33.5016, lng: -86.8005, state: 'Alabama', preferredDC: 'DC-AL-002', products: { 'SKU-20': 16, 'SKU-30': 6, 'SKU-33': 4, 'SKU-40': 3, 'SKU-100': 1 } },
                { id: 'ORD-AL-015', customerId: 'CUST-AL-015', customer: 'Protective Stadium', address: '1020 24th St N, Birmingham', volume: 650, priority: 'high', status: 'pending', deliveryDate: '2026-01-15', revenue: 1110, lat: 33.5270, lng: -86.8120, state: 'Alabama', preferredDC: 'DC-AL-002', products: { 'SKU-20': 15, 'SKU-30': 5, 'SKU-33': 4, 'SKU-40': 3, 'SKU-100': 1 } },
                { id: 'ORD-AL-016', customerId: 'CUST-AL-016', customer: 'Birmingham Zoo', address: '2630 Cahaba Rd, Birmingham', volume: 420, priority: 'low', status: 'pending', deliveryDate: '2026-01-15', revenue: 720, lat: 33.4848, lng: -86.7761, state: 'Alabama', preferredDC: 'DC-AL-002', products: { 'SKU-20': 12, 'SKU-30': 4, 'SKU-33': 3, 'SKU-40': 2 } },
                { id: 'ORD-AL-017', customerId: 'CUST-AL-017', customer: 'McWane Science Center', address: '200 19th St N, Birmingham', volume: 380, priority: 'low', status: 'pending', deliveryDate: '2026-01-15', revenue: 650, lat: 33.5165, lng: -86.8086, state: 'Alabama', preferredDC: 'DC-AL-002', products: { 'SKU-20': 12, 'SKU-30': 4, 'SKU-33': 2, 'SKU-40': 2 } },
                { id: 'ORD-AL-018', customerId: 'CUST-AL-018', customer: 'Riverchase Galleria', address: '3000 Riverchase Galleria, Hoover', volume: 520, priority: 'medium', status: 'pending', deliveryDate: '2026-01-15', revenue: 890, lat: 33.3779, lng: -86.8110, state: 'Alabama', preferredDC: 'DC-AL-002', products: { 'SKU-20': 14, 'SKU-30': 5, 'SKU-33': 3, 'SKU-40': 2, 'SKU-100': 1 } },
                { id: 'ORD-AL-019', customerId: 'CUST-AL-019', customer: 'Birmingham Museum of Art', address: '2000 Rev Abraham Woods Jr Blvd, Birmingham', volume: 350, priority: 'low', status: 'pending', deliveryDate: '2026-01-15', revenue: 600, lat: 33.5199, lng: -86.8094, state: 'Alabama', preferredDC: 'DC-AL-002', products: { 'SKU-20': 10, 'SKU-30': 4, 'SKU-33': 2, 'SKU-40': 2 } }
            ],
            routes: [
                {
                    id: 'RT-AL-001',
                    dcId: 'DC-AL-001',
                    truckId: 'TRK-AL-001',
                    driverId: 'DRV003',
                    date: '2026-01-15',
                    startTime: '08:00',
                    endTime: null,
                    initialLoad: {
                        'SKU-20': 144,
                        'SKU-30': 48,
                        'SKU-33': 32,
                        'SKU-40': 24,
                        'SKU-100': 8
                    },
                    currentLoad: {
                        'SKU-20': 72,
                        'SKU-30': 24,
                        'SKU-33': 16,
                        'SKU-40': 12,
                        'SKU-100': 4
                    },
                    emptyPickups: {
                        'SKU-20': 65,
                        'SKU-30': 20,
                        'SKU-33': 14,
                        'SKU-40': 10,
                        'SKU-100': 3
                    },
                    stops: [
                        { 
                            orderId: 'ORD-AL-003', 
                            sequence: 1, 
                            estimatedTime: '08:45', 
                            actualTime: '08:50',
                            completedTime: '09:25',
                            duration: 35, 
                            distance: 12,
                            status: 'completed',
                            delivered: { 'SKU-20': 18, 'SKU-30': 6, 'SKU-33': 4, 'SKU-40': 3 },
                            emptiesCollected: { 'SKU-20': 16, 'SKU-30': 5, 'SKU-33': 3, 'SKU-40': 2 },
                            signature: 'J. Williams',
                            notes: 'Left at loading dock'
                        },
                        { 
                            orderId: 'ORD-AL-004', 
                            sequence: 2, 
                            estimatedTime: '10:00', 
                            actualTime: '10:10',
                            completedTime: '10:50',
                            duration: 40, 
                            distance: 15,
                            status: 'completed',
                            delivered: { 'SKU-20': 24, 'SKU-30': 8, 'SKU-33': 6, 'SKU-40': 4, 'SKU-100': 2 },
                            emptiesCollected: { 'SKU-20': 22, 'SKU-30': 7, 'SKU-33': 5, 'SKU-40': 4, 'SKU-100': 1 },
                            signature: 'M. Thompson',
                            notes: 'Signature collected at front office'
                        },
                        { 
                            orderId: 'ORD-AL-005', 
                            sequence: 3, 
                            estimatedTime: '11:30', 
                            actualTime: '11:35',
                            completedTime: '12:05',
                            duration: 30, 
                            distance: 8,
                            status: 'completed',
                            delivered: { 'SKU-20': 15, 'SKU-30': 5, 'SKU-33': 3, 'SKU-40': 2 },
                            emptiesCollected: { 'SKU-20': 14, 'SKU-30': 4, 'SKU-33': 3, 'SKU-40': 2 },
                            signature: 'S. Garcia',
                            notes: ''
                        },
                        { 
                            orderId: 'ORD-AL-006', 
                            sequence: 4, 
                            estimatedTime: '12:45', 
                            actualTime: null,
                            completedTime: null,
                            duration: 45, 
                            distance: 10,
                            status: 'pending',
                            delivered: null,
                            emptiesCollected: null,
                            signature: null,
                            notes: 'Call 30 min before arrival'
                        },
                        { 
                            orderId: 'ORD-AL-007', 
                            sequence: 5, 
                            estimatedTime: '14:00', 
                            actualTime: null,
                            completedTime: null,
                            duration: 35, 
                            distance: 14,
                            status: 'pending',
                            delivered: null,
                            emptiesCollected: null,
                            signature: null,
                            notes: 'Use side entrance'
                        },
                        { 
                            orderId: 'ORD-AL-008', 
                            sequence: 6, 
                            estimatedTime: '15:15', 
                            actualTime: null,
                            completedTime: null,
                            duration: 40, 
                            distance: 18,
                            status: 'pending',
                            delivered: null,
                            emptiesCollected: null,
                            signature: null,
                            notes: ''
                        },
                        { 
                            orderId: 'ORD-AL-009', 
                            sequence: 7, 
                            estimatedTime: '16:30', 
                            actualTime: null,
                            completedTime: null,
                            duration: 25, 
                            distance: 11,
                            status: 'pending',
                            delivered: null,
                            emptiesCollected: null,
                            signature: null,
                            notes: 'Last stop - residential area'
                        }
                    ],
                    status: 'in-progress',
                    totalDistance: 88,
                    totalDuration: 250,
                    totalRevenue: 4850,
                    totalCost: 425
                },
                {
                    id: 'RT-GA-001',
                    dcId: 'DC-GA-001',
                    truckId: 'TRK-GA-001',
                    driverId: 'DRV001',
                    date: '2026-01-15',
                    startTime: '07:00',
                    endTime: null,
                    initialLoad: {
                        'SKU-20': 168,
                        'SKU-30': 56,
                        'SKU-33': 40,
                        'SKU-40': 28,
                        'SKU-100': 10
                    },
                    currentLoad: {
                        'SKU-20': 98,
                        'SKU-30': 32,
                        'SKU-33': 22,
                        'SKU-40': 16,
                        'SKU-100': 6
                    },
                    emptyPickups: {
                        'SKU-20': 62,
                        'SKU-30': 21,
                        'SKU-33': 15,
                        'SKU-40': 10,
                        'SKU-100': 3
                    },
                    stops: [
                        { 
                            orderId: 'ORD-GA-001', 
                            sequence: 1, 
                            estimatedTime: '07:45', 
                            actualTime: '07:50',
                            completedTime: '08:35',
                            duration: 45, 
                            distance: 8,
                            status: 'completed',
                            delivered: { 'SKU-20': 36, 'SKU-30': 12, 'SKU-33': 8, 'SKU-40': 6, 'SKU-100': 2 },
                            emptiesCollected: { 'SKU-20': 32, 'SKU-30': 10, 'SKU-33': 7, 'SKU-40': 5, 'SKU-100': 2 },
                            signature: 'R. Patel',
                            notes: 'Hotel receiving dock - Building B'
                        },
                        { 
                            orderId: 'ORD-GA-002', 
                            sequence: 2, 
                            estimatedTime: '09:15', 
                            actualTime: '09:20',
                            completedTime: '10:00',
                            duration: 40, 
                            distance: 6,
                            status: 'completed',
                            delivered: { 'SKU-20': 20, 'SKU-30': 6, 'SKU-33': 5, 'SKU-40': 3, 'SKU-100': 1 },
                            emptiesCollected: { 'SKU-20': 18, 'SKU-30': 6, 'SKU-33': 4, 'SKU-40': 3, 'SKU-100': 1 },
                            signature: 'T. Johnson',
                            notes: 'Campus facilities building'
                        },
                        { 
                            orderId: 'ORD-GA-003', 
                            sequence: 3, 
                            estimatedTime: '10:45', 
                            actualTime: '10:55',
                            completedTime: '11:30',
                            duration: 35, 
                            distance: 9,
                            status: 'completed',
                            delivered: { 'SKU-20': 14, 'SKU-30': 6, 'SKU-33': 5, 'SKU-40': 3, 'SKU-100': 1 },
                            emptiesCollected: { 'SKU-20': 12, 'SKU-30': 5, 'SKU-33': 4, 'SKU-40': 2 },
                            signature: 'A. Mitchell',
                            notes: ''
                        },
                        { 
                            orderId: 'ORD-GA-004', 
                            sequence: 4, 
                            estimatedTime: '12:15', 
                            actualTime: null,
                            completedTime: null,
                            duration: 50, 
                            distance: 12,
                            status: 'pending',
                            delivered: null,
                            emptiesCollected: null,
                            signature: null,
                            notes: 'Large order - bring dolly'
                        },
                        { 
                            orderId: 'ORD-GA-005', 
                            sequence: 5, 
                            estimatedTime: '13:30', 
                            actualTime: null,
                            completedTime: null,
                            duration: 35, 
                            distance: 7,
                            status: 'pending',
                            delivered: null,
                            emptiesCollected: null,
                            signature: null,
                            notes: 'Gate code: 4521'
                        },
                        { 
                            orderId: 'ORD-GA-006', 
                            sequence: 6, 
                            estimatedTime: '14:30', 
                            actualTime: null,
                            completedTime: null,
                            duration: 40, 
                            distance: 15,
                            status: 'pending',
                            delivered: null,
                            emptiesCollected: null,
                            signature: null,
                            notes: 'Check in at security first'
                        }
                    ],
                    status: 'in-progress',
                    totalDistance: 57,
                    totalDuration: 245,
                    totalRevenue: 5200,
                    totalCost: 380
                },
                {
                    id: 'RT-FL-001',
                    dcId: 'DC-FL-001',
                    truckId: 'TRK-FL-001',
                    driverId: 'DRV002',
                    date: '2026-01-15',
                    startTime: '06:30',
                    endTime: null,
                    initialLoad: {
                        'SKU-20': 180,
                        'SKU-30': 60,
                        'SKU-33': 42,
                        'SKU-40': 30,
                        'SKU-100': 12
                    },
                    currentLoad: {
                        'SKU-20': 60,
                        'SKU-30': 18,
                        'SKU-33': 12,
                        'SKU-40': 8,
                        'SKU-100': 3
                    },
                    emptyPickups: {
                        'SKU-20': 110,
                        'SKU-30': 38,
                        'SKU-33': 28,
                        'SKU-40': 20,
                        'SKU-100': 8
                    },
                    stops: [
                        { 
                            orderId: 'ORD-FL-001', 
                            sequence: 1, 
                            estimatedTime: '07:30', 
                            actualTime: '07:35',
                            completedTime: '08:45',
                            duration: 70, 
                            distance: 22,
                            status: 'completed',
                            delivered: { 'SKU-20': 48, 'SKU-30': 16, 'SKU-33': 12, 'SKU-40': 8, 'SKU-100': 4 },
                            emptiesCollected: { 'SKU-20': 45, 'SKU-30': 14, 'SKU-33': 11, 'SKU-40': 7, 'SKU-100': 3 },
                            signature: 'D. Martinez',
                            notes: 'Port authority main gate - Dock 7'
                        },
                        { 
                            orderId: 'ORD-FL-002', 
                            sequence: 2, 
                            estimatedTime: '09:30', 
                            actualTime: '09:40',
                            completedTime: '10:25',
                            duration: 45, 
                            distance: 18,
                            status: 'completed',
                            delivered: { 'SKU-20': 36, 'SKU-30': 12, 'SKU-33': 8, 'SKU-40': 6, 'SKU-100': 2 },
                            emptiesCollected: { 'SKU-20': 34, 'SKU-30': 12, 'SKU-33': 8, 'SKU-40': 6, 'SKU-100': 2 },
                            signature: 'L. Chen',
                            notes: 'Resort main building'
                        },
                        { 
                            orderId: 'ORD-FL-003', 
                            sequence: 3, 
                            estimatedTime: '11:15', 
                            actualTime: '11:20',
                            completedTime: '12:00',
                            duration: 40, 
                            distance: 14,
                            status: 'completed',
                            delivered: { 'SKU-20': 24, 'SKU-30': 8, 'SKU-33': 6, 'SKU-40': 4, 'SKU-100': 2 },
                            emptiesCollected: { 'SKU-20': 20, 'SKU-30': 8, 'SKU-33': 5, 'SKU-40': 4, 'SKU-100': 2 },
                            signature: 'M. Rodriguez',
                            notes: ''
                        },
                        { 
                            orderId: 'ORD-FL-004', 
                            sequence: 4, 
                            estimatedTime: '12:45', 
                            actualTime: '12:50',
                            completedTime: '13:20',
                            duration: 30, 
                            distance: 10,
                            status: 'completed',
                            delivered: { 'SKU-20': 12, 'SKU-30': 6, 'SKU-33': 4, 'SKU-40': 4, 'SKU-100': 1 },
                            emptiesCollected: { 'SKU-20': 11, 'SKU-30': 4, 'SKU-33': 4, 'SKU-40': 3, 'SKU-100': 1 },
                            signature: 'K. Brown',
                            notes: 'Residential - leave at garage'
                        },
                        { 
                            orderId: 'ORD-FL-005', 
                            sequence: 5, 
                            estimatedTime: '14:00', 
                            actualTime: null,
                            completedTime: null,
                            duration: 35, 
                            distance: 8,
                            status: 'pending',
                            delivered: null,
                            emptiesCollected: null,
                            signature: null,
                            notes: 'Business closes at 5pm'
                        },
                        { 
                            orderId: 'ORD-FL-006', 
                            sequence: 6, 
                            estimatedTime: '15:00', 
                            actualTime: null,
                            completedTime: null,
                            duration: 40, 
                            distance: 12,
                            status: 'pending',
                            delivered: null,
                            emptiesCollected: null,
                            signature: null,
                            notes: 'Ask for warehouse manager'
                        },
                        { 
                            orderId: 'ORD-FL-007', 
                            sequence: 7, 
                            estimatedTime: '16:15', 
                            actualTime: null,
                            completedTime: null,
                            duration: 25, 
                            distance: 9,
                            status: 'pending',
                            delivered: null,
                            emptiesCollected: null,
                            signature: null,
                            notes: 'Last delivery of the day'
                        }
                    ],
                    status: 'in-progress',
                    totalDistance: 93,
                    totalDuration: 285,
                    totalRevenue: 6150,
                    totalCost: 520
                },
                // Tennessee - Nashville DC Route
                {
                    id: 'RT-TN-001',
                    dcId: 'DC-TN-001',
                    truckId: 'TRK-TN-001',
                    driverId: 'DRV004',
                    date: '2026-01-15',
                    startTime: '07:00',
                    endTime: null,
                    initialLoad: {
                        'SKU-20': 160,
                        'SKU-30': 54,
                        'SKU-33': 36,
                        'SKU-40': 24,
                        'SKU-100': 10
                    },
                    currentLoad: {
                        'SKU-20': 80,
                        'SKU-30': 27,
                        'SKU-33': 18,
                        'SKU-40': 12,
                        'SKU-100': 5
                    },
                    emptyPickups: {
                        'SKU-20': 72,
                        'SKU-30': 24,
                        'SKU-33': 16,
                        'SKU-40': 10,
                        'SKU-100': 4
                    },
                    stops: [
                        { orderId: 'ORD-TN-001', sequence: 1, estimatedTime: '07:45', actualTime: '07:50', completedTime: '08:30', duration: 40, distance: 12, status: 'completed', delivered: { 'SKU-20': 16, 'SKU-30': 6, 'SKU-33': 4, 'SKU-40': 3, 'SKU-100': 1 }, emptiesCollected: { 'SKU-20': 14, 'SKU-30': 5, 'SKU-33': 3, 'SKU-40': 2, 'SKU-100': 1 }, signature: 'W. Thompson', notes: 'Delivered to backstage entrance' },
                        { orderId: 'ORD-TN-002', sequence: 2, estimatedTime: '09:00', actualTime: '09:10', completedTime: '09:50', duration: 40, distance: 8, status: 'completed', delivered: { 'SKU-20': 18, 'SKU-30': 6, 'SKU-33': 4, 'SKU-40': 3, 'SKU-100': 1 }, emptiesCollected: { 'SKU-20': 16, 'SKU-30': 5, 'SKU-33': 4, 'SKU-40': 2, 'SKU-100': 1 }, signature: 'J. Cash', notes: '' },
                        { orderId: 'ORD-TN-003', sequence: 3, estimatedTime: '10:15', actualTime: '10:20', completedTime: '11:00', duration: 40, distance: 10, status: 'completed', delivered: { 'SKU-20': 14, 'SKU-30': 5, 'SKU-33': 3, 'SKU-40': 2, 'SKU-100': 1 }, emptiesCollected: { 'SKU-20': 12, 'SKU-30': 4, 'SKU-33': 3, 'SKU-40': 2 }, signature: 'D. Parton', notes: '' },
                        { orderId: 'ORD-TN-004', sequence: 4, estimatedTime: '11:30', actualTime: '11:40', completedTime: '12:15', duration: 35, distance: 7, status: 'completed', delivered: { 'SKU-20': 16, 'SKU-30': 5, 'SKU-33': 4, 'SKU-40': 2, 'SKU-100': 1 }, emptiesCollected: { 'SKU-20': 14, 'SKU-30': 5, 'SKU-33': 3, 'SKU-40': 2, 'SKU-100': 1 }, signature: 'R. Travis', notes: '' },
                        { orderId: 'ORD-TN-005', sequence: 5, estimatedTime: '12:45', actualTime: '12:55', completedTime: '13:30', duration: 35, distance: 9, status: 'completed', delivered: { 'SKU-20': 16, 'SKU-30': 5, 'SKU-33': 3, 'SKU-40': 2, 'SKU-100': 1 }, emptiesCollected: { 'SKU-20': 16, 'SKU-30': 5, 'SKU-33': 3, 'SKU-40': 2, 'SKU-100': 1 }, signature: 'C. Underwood', notes: '' },
                        { orderId: 'ORD-TN-006', sequence: 6, estimatedTime: '14:00', actualTime: null, completedTime: null, duration: 40, distance: 11, status: 'pending', delivered: null, emptiesCollected: null, signature: null, notes: 'Call ahead - gate access required' },
                        { orderId: 'ORD-TN-007', sequence: 7, estimatedTime: '15:00', actualTime: null, completedTime: null, duration: 35, distance: 8, status: 'pending', delivered: null, emptiesCollected: null, signature: null, notes: 'Delivery dock B' },
                        { orderId: 'ORD-TN-008', sequence: 8, estimatedTime: '15:50', actualTime: null, completedTime: null, duration: 30, distance: 6, status: 'pending', delivered: null, emptiesCollected: null, signature: null, notes: '' },
                        { orderId: 'ORD-TN-009', sequence: 9, estimatedTime: '16:35', actualTime: null, completedTime: null, duration: 35, distance: 10, status: 'pending', delivered: null, emptiesCollected: null, signature: null, notes: 'Ask for manager Mike' },
                        { orderId: 'ORD-TN-010', sequence: 10, estimatedTime: '17:30', actualTime: null, completedTime: null, duration: 30, distance: 7, status: 'pending', delivered: null, emptiesCollected: null, signature: null, notes: 'Last stop - closes at 6pm' }
                    ],
                    status: 'in-progress',
                    totalDistance: 88,
                    totalDuration: 360,
                    totalRevenue: 7250,
                    totalCost: 485
                },
                // South Carolina - Columbia DC Route
                {
                    id: 'RT-SC-001',
                    dcId: 'DC-SC-001',
                    truckId: 'TRK-SC-001',
                    driverId: 'DRV001',
                    date: '2026-01-15',
                    startTime: '06:30',
                    endTime: null,
                    initialLoad: {
                        'SKU-20': 150,
                        'SKU-30': 50,
                        'SKU-33': 34,
                        'SKU-40': 22,
                        'SKU-100': 8
                    },
                    currentLoad: {
                        'SKU-20': 90,
                        'SKU-30': 30,
                        'SKU-33': 20,
                        'SKU-40': 13,
                        'SKU-100': 5
                    },
                    emptyPickups: {
                        'SKU-20': 55,
                        'SKU-30': 18,
                        'SKU-33': 12,
                        'SKU-40': 8,
                        'SKU-100': 3
                    },
                    stops: [
                        { orderId: 'ORD-SC-001', sequence: 1, estimatedTime: '07:15', actualTime: '07:20', completedTime: '08:00', duration: 40, distance: 10, status: 'completed', delivered: { 'SKU-20': 15, 'SKU-30': 5, 'SKU-33': 4, 'SKU-40': 2, 'SKU-100': 1 }, emptiesCollected: { 'SKU-20': 14, 'SKU-30': 5, 'SKU-33': 3, 'SKU-40': 2 }, signature: 'Dr. Anderson', notes: 'Medical center loading dock' },
                        { orderId: 'ORD-SC-002', sequence: 2, estimatedTime: '08:30', actualTime: '08:35', completedTime: '09:10', duration: 35, distance: 8, status: 'completed', delivered: { 'SKU-20': 15, 'SKU-30': 5, 'SKU-33': 3, 'SKU-40': 2, 'SKU-100': 1 }, emptiesCollected: { 'SKU-20': 13, 'SKU-30': 4, 'SKU-33': 3, 'SKU-40': 2, 'SKU-100': 1 }, signature: 'B. Smith', notes: '' },
                        { orderId: 'ORD-SC-003', sequence: 3, estimatedTime: '09:45', actualTime: '09:50', completedTime: '10:25', duration: 35, distance: 9, status: 'completed', delivered: { 'SKU-20': 15, 'SKU-30': 5, 'SKU-33': 4, 'SKU-40': 2, 'SKU-100': 1 }, emptiesCollected: { 'SKU-20': 14, 'SKU-30': 4, 'SKU-33': 3, 'SKU-40': 2, 'SKU-100': 1 }, signature: 'T. Johnson', notes: '' },
                        { orderId: 'ORD-SC-004', sequence: 4, estimatedTime: '11:00', actualTime: '11:05', completedTime: '11:40', duration: 35, distance: 7, status: 'completed', delivered: { 'SKU-20': 15, 'SKU-30': 5, 'SKU-33': 3, 'SKU-40': 3, 'SKU-100': 1 }, emptiesCollected: { 'SKU-20': 14, 'SKU-30': 5, 'SKU-33': 3, 'SKU-40': 2, 'SKU-100': 1 }, signature: 'M. Davis', notes: '' },
                        { orderId: 'ORD-SC-005', sequence: 5, estimatedTime: '12:15', actualTime: null, completedTime: null, duration: 40, distance: 11, status: 'pending', delivered: null, emptiesCollected: null, signature: null, notes: 'University main campus' },
                        { orderId: 'ORD-SC-006', sequence: 6, estimatedTime: '13:15', actualTime: null, completedTime: null, duration: 35, distance: 8, status: 'pending', delivered: null, emptiesCollected: null, signature: null, notes: '' },
                        { orderId: 'ORD-SC-007', sequence: 7, estimatedTime: '14:10', actualTime: null, completedTime: null, duration: 40, distance: 12, status: 'pending', delivered: null, emptiesCollected: null, signature: null, notes: 'Industrial park - Building C' },
                        { orderId: 'ORD-SC-008', sequence: 8, estimatedTime: '15:10', actualTime: null, completedTime: null, duration: 35, distance: 9, status: 'pending', delivered: null, emptiesCollected: null, signature: null, notes: '' },
                        { orderId: 'ORD-SC-009', sequence: 9, estimatedTime: '16:05', actualTime: null, completedTime: null, duration: 30, distance: 6, status: 'pending', delivered: null, emptiesCollected: null, signature: null, notes: 'Shopping center rear entrance' },
                        { orderId: 'ORD-SC-010', sequence: 10, estimatedTime: '16:50', actualTime: null, completedTime: null, duration: 35, distance: 8, status: 'pending', delivered: null, emptiesCollected: null, signature: null, notes: 'Final delivery' }
                    ],
                    status: 'in-progress',
                    totalDistance: 88,
                    totalDuration: 360,
                    totalRevenue: 6800,
                    totalCost: 455
                },
                // North Carolina - Charlotte DC Route
                {
                    id: 'RT-NC-001',
                    dcId: 'DC-NC-001',
                    truckId: 'TRK-NC-001',
                    driverId: 'DRV003',
                    date: '2026-01-15',
                    startTime: '07:30',
                    endTime: null,
                    initialLoad: {
                        'SKU-20': 170,
                        'SKU-30': 56,
                        'SKU-33': 38,
                        'SKU-40': 26,
                        'SKU-100': 10
                    },
                    currentLoad: {
                        'SKU-20': 102,
                        'SKU-30': 34,
                        'SKU-33': 23,
                        'SKU-40': 16,
                        'SKU-100': 6
                    },
                    emptyPickups: {
                        'SKU-20': 62,
                        'SKU-30': 20,
                        'SKU-33': 14,
                        'SKU-40': 9,
                        'SKU-100': 4
                    },
                    stops: [
                        { orderId: 'ORD-NC-001', sequence: 1, estimatedTime: '08:15', actualTime: '08:20', completedTime: '09:05', duration: 45, distance: 14, status: 'completed', delivered: { 'SKU-20': 18, 'SKU-30': 6, 'SKU-33': 4, 'SKU-40': 3, 'SKU-100': 1 }, emptiesCollected: { 'SKU-20': 16, 'SKU-30': 5, 'SKU-33': 4, 'SKU-40': 3, 'SKU-100': 1 }, signature: 'D. Wilson', notes: 'Speedway main entrance' },
                        { orderId: 'ORD-NC-002', sequence: 2, estimatedTime: '09:45', actualTime: '09:50', completedTime: '10:30', duration: 40, distance: 10, status: 'completed', delivered: { 'SKU-20': 16, 'SKU-30': 5, 'SKU-33': 4, 'SKU-40': 2, 'SKU-100': 1 }, emptiesCollected: { 'SKU-20': 15, 'SKU-30': 5, 'SKU-33': 3, 'SKU-40': 2, 'SKU-100': 1 }, signature: 'K. Johnson', notes: '' },
                        { orderId: 'ORD-NC-003', sequence: 3, estimatedTime: '11:00', actualTime: '11:10', completedTime: '11:50', duration: 40, distance: 9, status: 'completed', delivered: { 'SKU-20': 17, 'SKU-30': 6, 'SKU-33': 4, 'SKU-40': 3, 'SKU-100': 1 }, emptiesCollected: { 'SKU-20': 15, 'SKU-30': 5, 'SKU-33': 4, 'SKU-40': 2, 'SKU-100': 1 }, signature: 'L. Brown', notes: '' },
                        { orderId: 'ORD-NC-004', sequence: 4, estimatedTime: '12:20', actualTime: '12:30', completedTime: '13:05', duration: 35, distance: 8, status: 'completed', delivered: { 'SKU-20': 17, 'SKU-30': 5, 'SKU-33': 3, 'SKU-40': 2, 'SKU-100': 1 }, emptiesCollected: { 'SKU-20': 16, 'SKU-30': 5, 'SKU-33': 3, 'SKU-40': 2, 'SKU-100': 1 }, signature: 'R. Garcia', notes: '' },
                        { orderId: 'ORD-NC-005', sequence: 5, estimatedTime: '13:30', actualTime: null, completedTime: null, duration: 40, distance: 11, status: 'pending', delivered: null, emptiesCollected: null, signature: null, notes: 'Bank of America Stadium' },
                        { orderId: 'ORD-NC-006', sequence: 6, estimatedTime: '14:30', actualTime: null, completedTime: null, duration: 35, distance: 7, status: 'pending', delivered: null, emptiesCollected: null, signature: null, notes: '' },
                        { orderId: 'ORD-NC-007', sequence: 7, estimatedTime: '15:20', actualTime: null, completedTime: null, duration: 40, distance: 12, status: 'pending', delivered: null, emptiesCollected: null, signature: null, notes: 'Research Triangle delivery' },
                        { orderId: 'ORD-NC-008', sequence: 8, estimatedTime: '16:20', actualTime: null, completedTime: null, duration: 35, distance: 9, status: 'pending', delivered: null, emptiesCollected: null, signature: null, notes: '' },
                        { orderId: 'ORD-NC-009', sequence: 9, estimatedTime: '17:10', actualTime: null, completedTime: null, duration: 30, distance: 6, status: 'pending', delivered: null, emptiesCollected: null, signature: null, notes: 'Residential area' },
                        { orderId: 'ORD-NC-010', sequence: 10, estimatedTime: '17:55', actualTime: null, completedTime: null, duration: 35, distance: 10, status: 'pending', delivered: null, emptiesCollected: null, signature: null, notes: 'Evening delivery' }
                    ],
                    status: 'in-progress',
                    totalDistance: 96,
                    totalDuration: 375,
                    totalRevenue: 7800,
                    totalCost: 510
                },
                // Mississippi - Jackson DC Route
                {
                    id: 'RT-MS-001',
                    dcId: 'DC-MS-001',
                    truckId: 'TRK-MS-001',
                    driverId: 'DRV002',
                    date: '2026-01-15',
                    startTime: '06:00',
                    endTime: null,
                    initialLoad: {
                        'SKU-20': 140,
                        'SKU-30': 46,
                        'SKU-33': 30,
                        'SKU-40': 20,
                        'SKU-100': 8
                    },
                    currentLoad: {
                        'SKU-20': 56,
                        'SKU-30': 18,
                        'SKU-33': 12,
                        'SKU-40': 8,
                        'SKU-100': 3
                    },
                    emptyPickups: {
                        'SKU-20': 78,
                        'SKU-30': 26,
                        'SKU-33': 17,
                        'SKU-40': 11,
                        'SKU-100': 5
                    },
                    stops: [
                        { orderId: 'ORD-MS-001', sequence: 1, estimatedTime: '06:45', actualTime: '06:50', completedTime: '07:30', duration: 40, distance: 10, status: 'completed', delivered: { 'SKU-20': 14, 'SKU-30': 5, 'SKU-33': 3, 'SKU-40': 2, 'SKU-100': 1 }, emptiesCollected: { 'SKU-20': 13, 'SKU-30': 4, 'SKU-33': 3, 'SKU-40': 2, 'SKU-100': 1 }, signature: 'J. Williams', notes: '' },
                        { orderId: 'ORD-MS-002', sequence: 2, estimatedTime: '08:00', actualTime: '08:05', completedTime: '08:45', duration: 40, distance: 9, status: 'completed', delivered: { 'SKU-20': 14, 'SKU-30': 5, 'SKU-33': 3, 'SKU-40': 2, 'SKU-100': 1 }, emptiesCollected: { 'SKU-20': 13, 'SKU-30': 4, 'SKU-33': 3, 'SKU-40': 2, 'SKU-100': 1 }, signature: 'M. Johnson', notes: '' },
                        { orderId: 'ORD-MS-003', sequence: 3, estimatedTime: '09:15', actualTime: '09:20', completedTime: '10:00', duration: 40, distance: 11, status: 'completed', delivered: { 'SKU-20': 14, 'SKU-30': 4, 'SKU-33': 3, 'SKU-40': 2, 'SKU-100': 1 }, emptiesCollected: { 'SKU-20': 13, 'SKU-30': 4, 'SKU-33': 2, 'SKU-40': 2 }, signature: 'T. Davis', notes: '' },
                        { orderId: 'ORD-MS-004', sequence: 4, estimatedTime: '10:30', actualTime: '10:35', completedTime: '11:10', duration: 35, distance: 8, status: 'completed', delivered: { 'SKU-20': 14, 'SKU-30': 5, 'SKU-33': 3, 'SKU-40': 2, 'SKU-100': 1 }, emptiesCollected: { 'SKU-20': 13, 'SKU-30': 5, 'SKU-33': 3, 'SKU-40': 2, 'SKU-100': 1 }, signature: 'B. Wilson', notes: '' },
                        { orderId: 'ORD-MS-005', sequence: 5, estimatedTime: '11:45', actualTime: '11:50', completedTime: '12:25', duration: 35, distance: 7, status: 'completed', delivered: { 'SKU-20': 14, 'SKU-30': 5, 'SKU-33': 3, 'SKU-40': 2, 'SKU-100': 1 }, emptiesCollected: { 'SKU-20': 13, 'SKU-30': 5, 'SKU-33': 3, 'SKU-40': 2, 'SKU-100': 1 }, signature: 'S. Brown', notes: '' },
                        { orderId: 'ORD-MS-006', sequence: 6, estimatedTime: '13:00', actualTime: '13:05', completedTime: '13:40', duration: 35, distance: 8, status: 'completed', delivered: { 'SKU-20': 14, 'SKU-30': 4, 'SKU-33': 3, 'SKU-40': 2, 'SKU-100': 1 }, emptiesCollected: { 'SKU-20': 13, 'SKU-30': 4, 'SKU-33': 3, 'SKU-40': 1, 'SKU-100': 1 }, signature: 'A. Garcia', notes: '' },
                        { orderId: 'ORD-MS-007', sequence: 7, estimatedTime: '14:15', actualTime: null, completedTime: null, duration: 40, distance: 10, status: 'pending', delivered: null, emptiesCollected: null, signature: null, notes: 'Industrial complex' },
                        { orderId: 'ORD-MS-008', sequence: 8, estimatedTime: '15:15', actualTime: null, completedTime: null, duration: 35, distance: 9, status: 'pending', delivered: null, emptiesCollected: null, signature: null, notes: '' },
                        { orderId: 'ORD-MS-009', sequence: 9, estimatedTime: '16:10', actualTime: null, completedTime: null, duration: 35, distance: 8, status: 'pending', delivered: null, emptiesCollected: null, signature: null, notes: 'Farm equipment dealer' },
                        { orderId: 'ORD-MS-010', sequence: 10, estimatedTime: '17:05', actualTime: null, completedTime: null, duration: 30, distance: 6, status: 'pending', delivered: null, emptiesCollected: null, signature: null, notes: 'Last stop' }
                    ],
                    status: 'in-progress',
                    totalDistance: 86,
                    totalDuration: 365,
                    totalRevenue: 5900,
                    totalCost: 425
                },
                // Louisiana - Baton Rouge DC Route
                {
                    id: 'RT-LA-001',
                    dcId: 'DC-LA-001',
                    truckId: 'TRK-LA-001',
                    driverId: 'DRV001',
                    date: '2026-01-15',
                    startTime: '05:30',
                    endTime: null,
                    initialLoad: {
                        'SKU-20': 155,
                        'SKU-30': 52,
                        'SKU-33': 34,
                        'SKU-40': 22,
                        'SKU-100': 9
                    },
                    currentLoad: {
                        'SKU-20': 62,
                        'SKU-30': 21,
                        'SKU-33': 14,
                        'SKU-40': 9,
                        'SKU-100': 4
                    },
                    emptyPickups: {
                        'SKU-20': 86,
                        'SKU-30': 29,
                        'SKU-33': 19,
                        'SKU-40': 12,
                        'SKU-100': 5
                    },
                    stops: [
                        { orderId: 'ORD-LA-001', sequence: 1, estimatedTime: '06:15', actualTime: '06:20', completedTime: '07:00', duration: 40, distance: 12, status: 'completed', delivered: { 'SKU-20': 16, 'SKU-30': 5, 'SKU-33': 4, 'SKU-40': 2, 'SKU-100': 1 }, emptiesCollected: { 'SKU-20': 15, 'SKU-30': 5, 'SKU-33': 3, 'SKU-40': 2, 'SKU-100': 1 }, signature: 'P. Fontenot', notes: 'Petrochemical plant' },
                        { orderId: 'ORD-LA-002', sequence: 2, estimatedTime: '07:30', actualTime: '07:35', completedTime: '08:15', duration: 40, distance: 10, status: 'completed', delivered: { 'SKU-20': 15, 'SKU-30': 5, 'SKU-33': 3, 'SKU-40': 2, 'SKU-100': 1 }, emptiesCollected: { 'SKU-20': 14, 'SKU-30': 5, 'SKU-33': 3, 'SKU-40': 2, 'SKU-100': 1 }, signature: 'R. Boudreaux', notes: '' },
                        { orderId: 'ORD-LA-003', sequence: 3, estimatedTime: '08:45', actualTime: '08:50', completedTime: '09:30', duration: 40, distance: 11, status: 'completed', delivered: { 'SKU-20': 16, 'SKU-30': 5, 'SKU-33': 4, 'SKU-40': 2, 'SKU-100': 1 }, emptiesCollected: { 'SKU-20': 15, 'SKU-30': 5, 'SKU-33': 4, 'SKU-40': 2, 'SKU-100': 1 }, signature: 'M. Landry', notes: '' },
                        { orderId: 'ORD-LA-004', sequence: 4, estimatedTime: '10:00', actualTime: '10:10', completedTime: '10:50', duration: 40, distance: 9, status: 'completed', delivered: { 'SKU-20': 15, 'SKU-30': 5, 'SKU-33': 3, 'SKU-40': 2, 'SKU-100': 1 }, emptiesCollected: { 'SKU-20': 14, 'SKU-30': 5, 'SKU-33': 3, 'SKU-40': 2 }, signature: 'C. Thibodaux', notes: '' },
                        { orderId: 'ORD-LA-005', sequence: 5, estimatedTime: '11:20', actualTime: '11:25', completedTime: '12:05', duration: 40, distance: 10, status: 'completed', delivered: { 'SKU-20': 15, 'SKU-30': 5, 'SKU-33': 3, 'SKU-40': 2, 'SKU-100': 1 }, emptiesCollected: { 'SKU-20': 14, 'SKU-30': 4, 'SKU-33': 3, 'SKU-40': 2, 'SKU-100': 1 }, signature: 'D. Hebert', notes: '' },
                        { orderId: 'ORD-LA-006', sequence: 6, estimatedTime: '12:35', actualTime: '12:40', completedTime: '13:15', duration: 35, distance: 8, status: 'completed', delivered: { 'SKU-20': 16, 'SKU-30': 6, 'SKU-33': 3, 'SKU-40': 3, 'SKU-100': 1 }, emptiesCollected: { 'SKU-20': 14, 'SKU-30': 5, 'SKU-33': 3, 'SKU-40': 2, 'SKU-100': 1 }, signature: 'J. Broussard', notes: '' },
                        { orderId: 'ORD-LA-007', sequence: 7, estimatedTime: '13:50', actualTime: null, completedTime: null, duration: 40, distance: 11, status: 'pending', delivered: null, emptiesCollected: null, signature: null, notes: 'LSU Campus delivery' },
                        { orderId: 'ORD-LA-008', sequence: 8, estimatedTime: '14:50', actualTime: null, completedTime: null, duration: 35, distance: 9, status: 'pending', delivered: null, emptiesCollected: null, signature: null, notes: '' },
                        { orderId: 'ORD-LA-009', sequence: 9, estimatedTime: '15:45', actualTime: null, completedTime: null, duration: 35, distance: 8, status: 'pending', delivered: null, emptiesCollected: null, signature: null, notes: 'Port facility' },
                        { orderId: 'ORD-LA-010', sequence: 10, estimatedTime: '16:40', actualTime: null, completedTime: null, duration: 30, distance: 7, status: 'pending', delivered: null, emptiesCollected: null, signature: null, notes: 'Final delivery' }
                    ],
                    status: 'in-progress',
                    totalDistance: 95,
                    totalDuration: 375,
                    totalRevenue: 6650,
                    totalCost: 470
                },
                // Kentucky - Louisville DC Route
                {
                    id: 'RT-KY-001',
                    dcId: 'DC-KY-001',
                    truckId: 'TRK-KY-001',
                    driverId: 'DRV004',
                    date: '2026-01-15',
                    startTime: '07:00',
                    endTime: null,
                    initialLoad: {
                        'SKU-20': 145,
                        'SKU-30': 48,
                        'SKU-33': 32,
                        'SKU-40': 21,
                        'SKU-100': 8
                    },
                    currentLoad: {
                        'SKU-20': 87,
                        'SKU-30': 29,
                        'SKU-33': 19,
                        'SKU-40': 13,
                        'SKU-100': 5
                    },
                    emptyPickups: {
                        'SKU-20': 54,
                        'SKU-30': 18,
                        'SKU-33': 12,
                        'SKU-40': 8,
                        'SKU-100': 3
                    },
                    stops: [
                        { orderId: 'ORD-KY-001', sequence: 1, estimatedTime: '07:45', actualTime: '07:50', completedTime: '08:30', duration: 40, distance: 10, status: 'completed', delivered: { 'SKU-20': 15, 'SKU-30': 5, 'SKU-33': 3, 'SKU-40': 2, 'SKU-100': 1 }, emptiesCollected: { 'SKU-20': 14, 'SKU-30': 5, 'SKU-33': 3, 'SKU-40': 2, 'SKU-100': 1 }, signature: 'J. Bourbon', notes: 'Distillery delivery dock' },
                        { orderId: 'ORD-KY-002', sequence: 2, estimatedTime: '09:00', actualTime: '09:05', completedTime: '09:45', duration: 40, distance: 9, status: 'completed', delivered: { 'SKU-20': 14, 'SKU-30': 5, 'SKU-33': 4, 'SKU-40': 2, 'SKU-100': 1 }, emptiesCollected: { 'SKU-20': 13, 'SKU-30': 4, 'SKU-33': 3, 'SKU-40': 2 }, signature: 'W. Derby', notes: '' },
                        { orderId: 'ORD-KY-003', sequence: 3, estimatedTime: '10:15', actualTime: '10:20', completedTime: '11:00', duration: 40, distance: 11, status: 'completed', delivered: { 'SKU-20': 14, 'SKU-30': 5, 'SKU-33': 3, 'SKU-40': 2, 'SKU-100': 1 }, emptiesCollected: { 'SKU-20': 13, 'SKU-30': 5, 'SKU-33': 3, 'SKU-40': 2, 'SKU-100': 1 }, signature: 'T. Muhammad', notes: '' },
                        { orderId: 'ORD-KY-004', sequence: 4, estimatedTime: '11:30', actualTime: '11:40', completedTime: '12:15', duration: 35, distance: 8, status: 'completed', delivered: { 'SKU-20': 15, 'SKU-30': 4, 'SKU-33': 3, 'SKU-40': 2, 'SKU-100': 1 }, emptiesCollected: { 'SKU-20': 14, 'SKU-30': 4, 'SKU-33': 3, 'SKU-40': 2, 'SKU-100': 1 }, signature: 'K. Bluegrass', notes: '' },
                        { orderId: 'ORD-KY-005', sequence: 5, estimatedTime: '12:45', actualTime: null, completedTime: null, duration: 40, distance: 10, status: 'pending', delivered: null, emptiesCollected: null, signature: null, notes: 'UPS Worldport facility' },
                        { orderId: 'ORD-KY-006', sequence: 6, estimatedTime: '13:45', actualTime: null, completedTime: null, duration: 35, distance: 8, status: 'pending', delivered: null, emptiesCollected: null, signature: null, notes: '' },
                        { orderId: 'ORD-KY-007', sequence: 7, estimatedTime: '14:40', actualTime: null, completedTime: null, duration: 40, distance: 12, status: 'pending', delivered: null, emptiesCollected: null, signature: null, notes: 'Churchill Downs area' },
                        { orderId: 'ORD-KY-008', sequence: 8, estimatedTime: '15:40', actualTime: null, completedTime: null, duration: 35, distance: 9, status: 'pending', delivered: null, emptiesCollected: null, signature: null, notes: '' },
                        { orderId: 'ORD-KY-009', sequence: 9, estimatedTime: '16:35', actualTime: null, completedTime: null, duration: 35, distance: 8, status: 'pending', delivered: null, emptiesCollected: null, signature: null, notes: 'University campus' },
                        { orderId: 'ORD-KY-010', sequence: 10, estimatedTime: '17:30', actualTime: null, completedTime: null, duration: 30, distance: 7, status: 'pending', delivered: null, emptiesCollected: null, signature: null, notes: 'Evening delivery' }
                    ],
                    status: 'in-progress',
                    totalDistance: 92,
                    totalDuration: 370,
                    totalRevenue: 6200,
                    totalCost: 445
                },
                // Alabama - Birmingham DC Route (Second truck)
                {
                    id: 'RT-AL-002',
                    dcId: 'DC-AL-002',
                    truckId: 'TRK-AL-003',
                    driverId: 'DRV002',
                    date: '2026-01-15',
                    startTime: '06:00',
                    endTime: null,
                    initialLoad: {
                        'SKU-20': 135,
                        'SKU-30': 45,
                        'SKU-33': 30,
                        'SKU-40': 20,
                        'SKU-100': 8
                    },
                    currentLoad: {
                        'SKU-20': 81,
                        'SKU-30': 27,
                        'SKU-33': 18,
                        'SKU-40': 12,
                        'SKU-100': 5
                    },
                    emptyPickups: {
                        'SKU-20': 50,
                        'SKU-30': 17,
                        'SKU-33': 11,
                        'SKU-40': 7,
                        'SKU-100': 3
                    },
                    stops: [
                        { orderId: 'ORD-AL-010', sequence: 1, estimatedTime: '06:45', actualTime: '06:50', completedTime: '07:30', duration: 40, distance: 10, status: 'completed', delivered: { 'SKU-20': 14, 'SKU-30': 5, 'SKU-33': 3, 'SKU-40': 2, 'SKU-100': 1 }, emptiesCollected: { 'SKU-20': 13, 'SKU-30': 5, 'SKU-33': 3, 'SKU-40': 2, 'SKU-100': 1 }, signature: 'R. Steel', notes: 'Steel mill entrance' },
                        { orderId: 'ORD-AL-011', sequence: 2, estimatedTime: '08:00', actualTime: '08:05', completedTime: '08:45', duration: 40, distance: 9, status: 'completed', delivered: { 'SKU-20': 13, 'SKU-30': 4, 'SKU-33': 3, 'SKU-40': 2, 'SKU-100': 1 }, emptiesCollected: { 'SKU-20': 12, 'SKU-30': 4, 'SKU-33': 3, 'SKU-40': 2 }, signature: 'M. Iron', notes: '' },
                        { orderId: 'ORD-AL-012', sequence: 3, estimatedTime: '09:15', actualTime: '09:20', completedTime: '10:00', duration: 40, distance: 11, status: 'completed', delivered: { 'SKU-20': 14, 'SKU-30': 5, 'SKU-33': 3, 'SKU-40': 2, 'SKU-100': 1 }, emptiesCollected: { 'SKU-20': 13, 'SKU-30': 4, 'SKU-33': 2, 'SKU-40': 2, 'SKU-100': 1 }, signature: 'J. Coal', notes: '' },
                        { orderId: 'ORD-AL-013', sequence: 4, estimatedTime: '10:30', actualTime: '10:35', completedTime: '11:10', duration: 35, distance: 8, status: 'completed', delivered: { 'SKU-20': 13, 'SKU-30': 4, 'SKU-33': 3, 'SKU-40': 2, 'SKU-100': 1 }, emptiesCollected: { 'SKU-20': 12, 'SKU-30': 4, 'SKU-33': 3, 'SKU-40': 1, 'SKU-100': 1 }, signature: 'B. Vulcan', notes: '' },
                        { orderId: 'ORD-AL-014', sequence: 5, estimatedTime: '11:45', actualTime: null, completedTime: null, duration: 40, distance: 10, status: 'pending', delivered: null, emptiesCollected: null, signature: null, notes: 'UAB Medical Center' },
                        { orderId: 'ORD-AL-015', sequence: 6, estimatedTime: '12:45', actualTime: null, completedTime: null, duration: 35, distance: 8, status: 'pending', delivered: null, emptiesCollected: null, signature: null, notes: '' },
                        { orderId: 'ORD-AL-016', sequence: 7, estimatedTime: '13:40', actualTime: null, completedTime: null, duration: 40, distance: 12, status: 'pending', delivered: null, emptiesCollected: null, signature: null, notes: 'Downtown Birmingham' },
                        { orderId: 'ORD-AL-017', sequence: 8, estimatedTime: '14:40', actualTime: null, completedTime: null, duration: 35, distance: 9, status: 'pending', delivered: null, emptiesCollected: null, signature: null, notes: '' },
                        { orderId: 'ORD-AL-018', sequence: 9, estimatedTime: '15:35', actualTime: null, completedTime: null, duration: 35, distance: 8, status: 'pending', delivered: null, emptiesCollected: null, signature: null, notes: 'Hoover area' },
                        { orderId: 'ORD-AL-019', sequence: 10, estimatedTime: '16:30', actualTime: null, completedTime: null, duration: 30, distance: 7, status: 'pending', delivered: null, emptiesCollected: null, signature: null, notes: 'Final delivery' }
                    ],
                    status: 'in-progress',
                    totalDistance: 92,
                    totalDuration: 370,
                    totalRevenue: 5800,
                    totalCost: 430
                }
            ]
        };

        function GPSMap({ trucks, routes, orders, drivers, distributionCenters, onTruckClick, showWeather = true }) {
            const mapRef = useRef(null);
            const mapInstanceRef = useRef(null);
            const markersRef = useRef([]);
            const weatherLayerRef = useRef(null);
            const [weatherEnabled, setWeatherEnabled] = useState(true);
            const [weatherType, setWeatherType] = useState('radar');

            useEffect(() => {
                if (!mapRef.current || mapInstanceRef.current) return;

                // Initialize map centered on Southeast US (Georgia/Alabama border area)
                const map = L.map(mapRef.current).setView([33.0, -84.0], 6);

                L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', {
                    attribution: '¬© OpenStreetMap contributors',
                    maxZoom: 19
                }).addTo(map);

                mapInstanceRef.current = map;

                return () => {
                    if (mapInstanceRef.current) {
                        mapInstanceRef.current.remove();
                        mapInstanceRef.current = null;
                    }
                };
            }, []);

            // Weather radar layer effect
            useEffect(() => {
                if (!mapInstanceRef.current) return;

                // Remove existing weather layer
                if (weatherLayerRef.current) {
                    mapInstanceRef.current.removeLayer(weatherLayerRef.current);
                    weatherLayerRef.current = null;
                }

                if (weatherEnabled && showWeather) {
                    // OpenWeatherMap radar layer (free tier available)
                    // Using RainViewer API (free, no API key required for basic use)
                    const timestamp = Math.floor(Date.now() / 1000);
                    const radarTimestamp = timestamp - (timestamp % 600); // Round to nearest 10 min
                    
                    let weatherUrl;
                    if (weatherType === 'radar') {
                        // RainViewer radar tiles (free)
                        weatherUrl = `https://tilecache.rainviewer.com/v2/radar/${radarTimestamp}/256/{z}/{x}/{y}/2/1_1.png`;
                    } else if (weatherType === 'clouds') {
                        // OpenWeatherMap clouds layer
                        weatherUrl = 'https://tile.openweathermap.org/map/clouds_new/{z}/{x}/{y}.png?appid=demo';
                    } else if (weatherType === 'temp') {
                        // OpenWeatherMap temperature layer  
                        weatherUrl = 'https://tile.openweathermap.org/map/temp_new/{z}/{x}/{y}.png?appid=demo';
                    } else if (weatherType === 'wind') {
                        // OpenWeatherMap wind layer
                        weatherUrl = 'https://tile.openweathermap.org/map/wind_new/{z}/{x}/{y}.png?appid=demo';
                    }

                    weatherLayerRef.current = L.tileLayer(weatherUrl, {
                        opacity: 0.6,
                        attribution: weatherType === 'radar' ? '¬© RainViewer' : '¬© OpenWeatherMap',
                        maxZoom: 18
                    }).addTo(mapInstanceRef.current);
                }
            }, [weatherEnabled, weatherType, showWeather]);

            useEffect(() => {
                if (!mapInstanceRef.current) return;

                // Clear existing markers
                markersRef.current.forEach(marker => marker.remove());
                markersRef.current = [];

                // Add distribution center markers
                distributionCenters.forEach(dc => {
                    if (dc.lat && dc.lng) {
                        const dcIcon = L.divIcon({
                            className: 'custom-dc-marker',
                            html: `
                                <div style="
                                    width: 50px;
                                    height: 50px;
                                    background: linear-gradient(135deg, #004E89 0%, #003A6B 100%);
                                    border: 4px solid #FFD23F;
                                    border-radius: 12px;
                                    display: flex;
                                    align-items: center;
                                    justify-content: center;
                                    font-size: 24px;
                                    box-shadow: 0 6px 20px rgba(0, 0, 0, 0.4);
                                    cursor: pointer;
                                ">
                                    üè≠
                                </div>
                            `,
                            iconSize: [50, 50],
                            iconAnchor: [25, 25]
                        });

                        const dcMarker = L.marker([dc.lat, dc.lng], { icon: dcIcon })
                            .addTo(mapInstanceRef.current);

                        const dcTrucks = trucks.filter(t => t.dcId === dc.id);
                        const dcRoutes = routes.filter(r => r.dcId === dc.id);

                        dcMarker.bindPopup(`
                            <div class="popup-content">
                                <div class="popup-header">
                                    <div class="popup-icon" style="background: linear-gradient(135deg, #004E89 0%, #003A6B 100%);">üè≠</div>
                                    <div>
                                        <div class="popup-title">${dc.name}</div>
                                        <div style="font-size: 0.8rem; color: var(--text-muted); font-family: 'JetBrains Mono', monospace;">${dc.id}</div>
                                    </div>
                                </div>
                                <div class="popup-info">
                                    <div class="popup-row">
                                        <span class="popup-label">Location:</span>
                                        <span class="popup-value">${dc.city}, ${dc.state}</span>
                                    </div>
                                    <div class="popup-row">
                                        <span class="popup-label">Address:</span>
                                        <span class="popup-value" style="font-size: 0.85rem;">${dc.address}</span>
                                    </div>
                                    <div class="popup-row">
                                        <span class="popup-label">Active Trucks:</span>
                                        <span class="popup-value">${dcTrucks.filter(t => t.status === 'active').length}/${dcTrucks.length}</span>
                                    </div>
                                    <div class="popup-row">
                                        <span class="popup-label">Active Routes:</span>
                                        <span class="popup-value">${dcRoutes.filter(r => r.status === 'in-progress').length}</span>
                                    </div>
                                </div>
                            </div>
                        `);

                        markersRef.current.push(dcMarker);
                    }
                });

                // Add truck markers
                trucks.forEach(truck => {
                    if (truck.currentLat && truck.currentLng) {
                        const route = routes.find(r => r.truckId === truck.id);
                        const driver = route ? drivers.find(d => d.id === route.driverId) : null;

                        const truckIcon = L.divIcon({
                            className: 'custom-truck-marker',
                            html: `
                                <div style="
                                    width: 40px;
                                    height: 40px;
                                    background: ${truck.status === 'active' ? 'linear-gradient(135deg, #FF6B35 0%, #E85A2A 100%)' : 'linear-gradient(135deg, #6B7394 0%, #4A5068 100%)'};
                                    border: 3px solid ${truck.status === 'active' ? '#FFD23F' : '#2A3451'};
                                    border-radius: 50%;
                                    display: flex;
                                    align-items: center;
                                    justify-content: center;
                                    font-size: 20px;
                                    box-shadow: 0 4px 15px rgba(0, 0, 0, 0.3);
                                    cursor: pointer;
                                    animation: ${truck.status === 'active' ? 'marker-pulse 2s ease-in-out infinite' : 'none'};
                                ">
                                    üöõ
                                </div>
                            `,
                            iconSize: [40, 40],
                            iconAnchor: [20, 20]
                        });

                        const marker = L.marker([truck.currentLat, truck.currentLng], { icon: truckIcon })
                            .addTo(mapInstanceRef.current);

                        const popupContent = `
                            <div class="popup-content">
                                <div class="popup-header">
                                    <div class="popup-icon">üöõ</div>
                                    <div>
                                        <div class="popup-title">${truck.name}</div>
                                        <div style="font-size: 0.8rem; color: var(--text-muted); font-family: 'JetBrains Mono', monospace;">${truck.id}</div>
                                    </div>
                                </div>
                                <div class="popup-info">
                                    <div class="popup-row">
                                        <span class="popup-label">GPS Device:</span>
                                        <span class="popup-value">${truck.gpsDeviceId || 'Not Mapped'}</span>
                                    </div>
                                    <div class="popup-row">
                                        <span class="popup-label">GPS Provider:</span>
                                        <span class="popup-value">${truck.gpsProvider || 'N/A'}</span>
                                    </div>
                                    <div class="popup-row">
                                        <span class="popup-label">Status:</span>
                                        <span class="popup-status">${truck.status}</span>
                                    </div>
                                    <div class="popup-row">
                                        <span class="popup-label">Speed:</span>
                                        <span class="popup-value">${truck.speed} mph</span>
                                    </div>
                                    <div class="popup-row">
                                        <span class="popup-label">Capacity:</span>
                                        <span class="popup-value">${truck.capacity} units</span>
                                    </div>
                                    ${driver ? `
                                    <div class="popup-row">
                                        <span class="popup-label">Driver:</span>
                                        <span class="popup-value">${driver.name}</span>
                                    </div>
                                    ` : ''}
                                    ${route ? `
                                    <div class="popup-row">
                                        <span class="popup-label">Route:</span>
                                        <span class="popup-value">${route.id}</span>
                                    </div>
                                    <div class="popup-row">
                                        <span class="popup-label">Stops:</span>
                                        <span class="popup-value">${route.stops.length}</span>
                                    </div>
                                    <div class="popup-row">
                                        <span class="popup-label">Revenue:</span>
                                        <span class="popup-value">$${route.totalRevenue}</span>
                                    </div>
                                    ` : ''}
                                    <div class="popup-row">
                                        <span class="popup-label">Last Update:</span>
                                        <span class="popup-value">${truck.lastUpdate}</span>
                                    </div>
                                    <div class="popup-row">
                                        <span class="popup-label">GPS Coords:</span>
                                        <span class="popup-value" style="font-size: 0.75rem;">${truck.currentLat.toFixed(4)}, ${truck.currentLng.toFixed(4)}</span>
                                    </div>
                                </div>
                            </div>
                        `;

                        marker.bindPopup(popupContent);
                        marker.on('click', () => {
                            if (onTruckClick) onTruckClick(truck);
                        });

                        markersRef.current.push(marker);

                        // Add route path if exists
                        if (route && route.stops.length > 0) {
                            const routeCoords = [
                                [truck.currentLat, truck.currentLng]
                            ];

                            route.stops.forEach(stop => {
                                const order = orders.find(o => o.id === stop.orderId);
                                if (order && order.lat && order.lng) {
                                    routeCoords.push([order.lat, order.lng]);

                                    // Add destination marker
                                    const destIcon = L.divIcon({
                                        className: 'custom-dest-marker',
                                        html: `
                                            <div style="
                                                width: 30px;
                                                height: 30px;
                                                background: linear-gradient(135deg, #06D6A0 0%, #05B589 100%);
                                                border: 2px solid white;
                                                border-radius: 50%;
                                                display: flex;
                                                align-items: center;
                                                justify-content: center;
                                                font-size: 14px;
                                                box-shadow: 0 2px 8px rgba(0, 0, 0, 0.3);
                                                cursor: pointer;
                                            ">
                                                üìç
                                            </div>
                                        `,
                                        iconSize: [30, 30],
                                        iconAnchor: [15, 15]
                                    });

                                    const destMarker = L.marker([order.lat, order.lng], { icon: destIcon })
                                        .addTo(mapInstanceRef.current);

                                    destMarker.bindPopup(`
                                        <div class="popup-content">
                                            <div class="popup-header">
                                                <div class="popup-icon" style="background: linear-gradient(135deg, #06D6A0 0%, #05B589 100%);">üìç</div>
                                                <div>
                                                    <div class="popup-title">${order.customer}</div>
                                                    <div style="font-size: 0.8rem; color: var(--text-muted);">${order.address}</div>
                                                </div>
                                            </div>
                                            <div class="popup-info">
                                                <div class="popup-row">
                                                    <span class="popup-label">Volume:</span>
                                                    <span class="popup-value">${order.volume} units</span>
                                                </div>
                                                <div class="popup-row">
                                                    <span class="popup-label">ETA:</span>
                                                    <span class="popup-value">${stop.estimatedTime}</span>
                                                </div>
                                                <div class="popup-row">
                                                    <span class="popup-label">Stop:</span>
                                                    <span class="popup-value">#${stop.sequence}</span>
                                                </div>
                                            </div>
                                        </div>
                                    `);

                                    markersRef.current.push(destMarker);
                                }
                            });

                            // Draw route line
                            const routeLine = L.polyline(routeCoords, {
                                color: '#FF6B35',
                                weight: 3,
                                opacity: 0.7,
                                dashArray: '10, 10'
                            }).addTo(mapInstanceRef.current);

                            markersRef.current.push(routeLine);
                        }
                    }
                });
            }, [trucks, routes, orders, drivers, onTruckClick]);

            return (
                <div className="map-container">
                    <div id="gps-map" ref={mapRef}></div>
                    
                    {/* Weather Controls - Bottom Left */}
                    <div style={{
                        position: 'absolute',
                        bottom: '2rem',
                        left: '2rem',
                        background: 'rgba(20, 27, 56, 0.95)',
                        borderRadius: '12px',
                        padding: '1rem',
                        zIndex: 1000,
                        border: '2px solid var(--border)',
                        minWidth: '160px',
                        backdropFilter: 'blur(10px)'
                    }}>
                        <div style={{ display: 'flex', alignItems: 'center', justifyContent: 'space-between', marginBottom: '0.75rem' }}>
                            <span style={{ fontWeight: '700', fontSize: '0.9rem' }}>üå¶Ô∏è Weather</span>
                            <label style={{ display: 'flex', alignItems: 'center', cursor: 'pointer' }}>
                                <input 
                                    type="checkbox" 
                                    checked={weatherEnabled}
                                    onChange={(e) => setWeatherEnabled(e.target.checked)}
                                    style={{ marginRight: '0.5rem' }}
                                />
                                <span style={{ fontSize: '0.8rem' }}>{weatherEnabled ? 'On' : 'Off'}</span>
                            </label>
                        </div>
                        {weatherEnabled && (
                            <div style={{ display: 'grid', gridTemplateColumns: '1fr 1fr', gap: '0.5rem' }}>
                                <button 
                                    className={`btn btn-sm ${weatherType === 'radar' ? 'btn-primary' : 'btn-secondary'}`}
                                    onClick={() => setWeatherType('radar')}
                                    style={{ fontSize: '0.75rem', padding: '0.4rem' }}
                                >
                                    üåßÔ∏è Radar
                                </button>
                                <button 
                                    className={`btn btn-sm ${weatherType === 'clouds' ? 'btn-primary' : 'btn-secondary'}`}
                                    onClick={() => setWeatherType('clouds')}
                                    style={{ fontSize: '0.75rem', padding: '0.4rem' }}
                                >
                                    ‚òÅÔ∏è Clouds
                                </button>
                                <button 
                                    className={`btn btn-sm ${weatherType === 'temp' ? 'btn-primary' : 'btn-secondary'}`}
                                    onClick={() => setWeatherType('temp')}
                                    style={{ fontSize: '0.75rem', padding: '0.4rem' }}
                                >
                                    üå°Ô∏è Temp
                                </button>
                                <button 
                                    className={`btn btn-sm ${weatherType === 'wind' ? 'btn-primary' : 'btn-secondary'}`}
                                    onClick={() => setWeatherType('wind')}
                                    style={{ fontSize: '0.75rem', padding: '0.4rem' }}
                                >
                                    üí® Wind
                                </button>
                            </div>
                        )}
                        {weatherEnabled && (
                            <div style={{ marginTop: '0.5rem', fontSize: '0.7rem', color: 'var(--text-muted)', textAlign: 'center' }}>
                                {weatherType === 'radar' ? 'Live precipitation' : 'Layer active'}
                            </div>
                        )}
                    </div>

                    {/* Map Legend - Bottom Right */}
                    <div className="map-legend">
                        <div className="legend-title">Map Legend</div>
                        <div className="legend-item">
                            <div className="legend-color" style={{ background: 'linear-gradient(135deg, #004E89 0%, #003A6B 100%)', border: '2px solid #FFD23F' }}></div>
                            <span>Distribution Center</span>
                        </div>
                        <div className="legend-item">
                            <div className="legend-color" style={{ background: 'linear-gradient(135deg, #FF6B35 0%, #E85A2A 100%)' }}></div>
                            <span>Active Truck</span>
                        </div>
                        <div className="legend-item">
                            <div className="legend-color" style={{ background: 'linear-gradient(135deg, #06D6A0 0%, #05B589 100%)' }}></div>
                            <span>Delivery Stop</span>
                        </div>
                        <div className="legend-item">
                            <div className="legend-color" style={{ background: '#6B7394' }}></div>
                            <span>Inactive</span>
                        </div>
                        {weatherEnabled && (
                            <>
                                <div style={{ borderTop: '1px solid var(--border)', margin: '0.5rem 0', paddingTop: '0.5rem' }}>
                                    <div className="legend-title" style={{ fontSize: '0.75rem' }}>Weather Radar</div>
                                </div>
                                <div className="legend-item">
                                    <div className="legend-color" style={{ background: 'linear-gradient(90deg, #00ff00, #ffff00, #ff0000)' }}></div>
                                    <span style={{ fontSize: '0.75rem' }}>Light ‚Üí Heavy</span>
                                </div>
                            </>
                        )}
                    </div>
                </div>
            );
        }

        // Login Component
        function LoginScreen({ onLogin, apiBase = '' }) {
            const [username, setUsername] = useState('');
            const [password, setPassword] = useState('');
            const [error, setError] = useState('');
            const [showPassword, setShowPassword] = useState(false);
            const [isLoading, setIsLoading] = useState(false);

            const handleSubmit = (e) => {
                e.preventDefault();
                handleLoginClick();
            };

            const handleLoginClick = async () => {
                if (!username || !password) {
                    setError('Please enter username and password');
                    return;
                }
                
                setIsLoading(true);
                setError('');
                
                try {
                    // Try API login first
                    const response = await fetch(`${apiBase}/api/auth/login`, {
                        method: 'POST',
                        headers: { 'Content-Type': 'application/json' },
                        body: JSON.stringify({ username, password })
                    });
                    
                    if (response.ok) {
                        const user = await response.json();
                        // Map API response to expected format
                        const mappedUser = {
                            ...user,
                            lastLogin: new Date().toLocaleString()
                        };
                        onLogin(mappedUser);
                        return;
                    }
                } catch (err) {
                    console.log('API login failed, trying local auth:', err);
                }
                
                // Fall back to local authentication (for demo/offline mode)
                const user = systemUsers.find(u => u.username === username && u.password === password);
                if (user) {
                    onLogin(user);
                } else {
                    setError('Invalid username or password');
                }
                setIsLoading(false);
            };

            const quickLogin = async (role) => {
                const user = systemUsers.find(u => u.role === role);
                if (user) {
                    setUsername(user.username);
                    setPassword(user.password);
                    setIsLoading(true);
                    
                    try {
                        // Try API login
                        const response = await fetch(`${apiBase}/api/auth/login`, {
                            method: 'POST',
                            headers: { 'Content-Type': 'application/json' },
                            body: JSON.stringify({ username: user.username, password: user.password })
                        });
                        
                        if (response.ok) {
                            const apiUser = await response.json();
                            onLogin({ ...apiUser, lastLogin: new Date().toLocaleString() });
                            return;
                        }
                    } catch (err) {
                        console.log('API quick login failed, using local:', err);
                    }
                    
                    // Fall back to local
                    onLogin(user);
                    setIsLoading(false);
                }
            };

            return (
                <div style={{ 
                    minHeight: '100vh', 
                    display: 'flex', 
                    alignItems: 'center', 
                    justifyContent: 'center',
                    background: 'linear-gradient(135deg, var(--bg-dark) 0%, var(--bg-darker) 100%)',
                    padding: '1rem'
                }}>
                    <div style={{ 
                        width: '100%', 
                        maxWidth: '450px',
                        background: 'var(--bg-card)',
                        borderRadius: '16px',
                        padding: '2rem',
                        boxShadow: '0 20px 60px rgba(0,0,0,0.4)'
                    }}>
                        <div style={{ textAlign: 'center', marginBottom: '2rem' }}>
                            <div style={{ fontSize: '3rem', marginBottom: '0.5rem' }}>üöö</div>
                            <h1 style={{ 
                                fontSize: '1.75rem', 
                                fontWeight: '800',
                                background: 'linear-gradient(135deg, var(--primary) 0%, var(--secondary) 100%)',
                                WebkitBackgroundClip: 'text',
                                WebkitTextFillColor: 'transparent',
                                marginBottom: '0.5rem'
                            }}>RouteCRM Pro</h1>
                            <p style={{ color: 'var(--text-muted)', fontSize: '0.9rem' }}>
                                Distribution Management System
                            </p>
                            <div style={{ marginTop: '0.5rem', fontSize: '0.75rem', color: 'var(--text-muted)' }}>
                                <span style={{ padding: '0.2rem 0.5rem', background: 'var(--bg-dark)', borderRadius: '4px', marginRight: '0.5rem' }}>v1.0.0-beta</span>
                                <span>Build: Jan 29, 2026</span>
                            </div>
                        </div>

                        <div>
                            {error && (
                                <div style={{
                                    background: 'rgba(239, 68, 68, 0.1)',
                                    border: '1px solid var(--danger)',
                                    borderRadius: '8px',
                                    padding: '0.75rem 1rem',
                                    marginBottom: '1rem',
                                    color: 'var(--danger)',
                                    fontSize: '0.9rem'
                                }}>
                                    ‚ö†Ô∏è {error}
                                </div>
                            )}

                            <div className="form-group">
                                <label className="form-label">Username</label>
                                <input
                                    type="text"
                                    className="form-input"
                                    value={username}
                                    onChange={(e) => setUsername(e.target.value)}
                                    placeholder="Enter username"
                                    autoFocus
                                />
                            </div>

                            <div className="form-group">
                                <label className="form-label">Password</label>
                                <div style={{ position: 'relative' }}>
                                    <input
                                        type={showPassword ? 'text' : 'password'}
                                        className="form-input"
                                        value={password}
                                        onChange={(e) => setPassword(e.target.value)}
                                        placeholder="Enter password"
                                        style={{ paddingRight: '3rem' }}
                                        onKeyPress={(e) => { if (e.key === 'Enter') handleLoginClick(); }}
                                    />
                                    <button
                                        type="button"
                                        onClick={() => setShowPassword(!showPassword)}
                                        style={{
                                            position: 'absolute',
                                            right: '0.75rem',
                                            top: '50%',
                                            transform: 'translateY(-50%)',
                                            background: 'none',
                                            border: 'none',
                                            cursor: 'pointer',
                                            fontSize: '1.1rem'
                                        }}
                                    >
                                        {showPassword ? 'üôà' : 'üëÅÔ∏è'}
                                    </button>
                                </div>
                            </div>

                            <button 
                                type="button" 
                                className="btn btn-primary" 
                                style={{ width: '100%', marginTop: '1rem', padding: '0.875rem' }}
                                onClick={handleLoginClick}
                                disabled={isLoading}
                            >
                                {isLoading ? 'üîÑ Signing in...' : 'üîê Sign In'}
                            </button>
                        </div>

                        <div style={{ marginTop: '2rem', borderTop: '1px solid var(--border)', paddingTop: '1.5rem' }}>
                            <p style={{ color: 'var(--text-muted)', fontSize: '0.8rem', marginBottom: '1rem', textAlign: 'center' }}>
                                Quick Login (Demo)
                            </p>
                            <div style={{ display: 'grid', gridTemplateColumns: 'repeat(2, 1fr)', gap: '0.5rem' }}>
                                <button 
                                    onClick={() => quickLogin(ROLES.ADMIN)}
                                    className="btn btn-secondary"
                                    style={{ fontSize: '0.8rem', padding: '0.5rem' }}
                                    disabled={isLoading}
                                >
                                    üë®‚Äçüíº Admin
                                </button>
                                <button 
                                    onClick={() => quickLogin(ROLES.DRIVER)}
                                    className="btn btn-secondary"
                                    style={{ fontSize: '0.8rem', padding: '0.5rem' }}
                                    disabled={isLoading}
                                >
                                    üöö Driver
                                </button>
                                <button 
                                    onClick={() => quickLogin(ROLES.DISPATCH)}
                                    className="btn btn-secondary"
                                    style={{ fontSize: '0.8rem', padding: '0.5rem' }}
                                    disabled={isLoading}
                                >
                                    üìã Dispatch
                                </button>
                                <button 
                                    onClick={() => quickLogin(ROLES.ACCOUNTING)}
                                    className="btn btn-secondary"
                                    style={{ fontSize: '0.8rem', padding: '0.5rem' }}
                                    disabled={isLoading}
                                >
                                    üí∞ Accounting
                                </button>
                                <button 
                                    onClick={() => quickLogin(ROLES.PAYROLL)}
                                    className="btn btn-secondary"
                                    style={{ fontSize: '0.8rem', padding: '0.5rem', gridColumn: 'span 2' }}
                                    disabled={isLoading}
                                >
                                    üìä Payroll Admin
                                </button>
                            </div>
                        </div>

                        <div style={{ marginTop: '1.5rem', padding: '1rem', background: 'var(--bg-dark)', borderRadius: '8px', fontSize: '0.75rem', color: 'var(--text-muted)' }}>
                            <strong style={{ color: 'var(--text-primary)' }}>Demo Credentials:</strong>
                            <div style={{ display: 'grid', gridTemplateColumns: '1fr 1fr', gap: '0.25rem', marginTop: '0.5rem' }}>
                                <span>admin / admin123</span>
                                <span>dispatch / dispatch123</span>
                                <span>jsmith / driver123</span>
                                <span>accounting / accounting123</span>
                                <span>payroll / payroll123</span>
                            </div>
                        </div>

                        <div style={{ marginTop: '1rem', textAlign: 'center', fontSize: '0.7rem', color: 'var(--text-muted)' }}>
                            <span style={{ 
                                display: 'inline-flex', 
                                alignItems: 'center', 
                                gap: '0.25rem',
                                padding: '0.25rem 0.5rem',
                                background: 'rgba(6, 214, 160, 0.1)',
                                border: '1px solid var(--success)',
                                borderRadius: '4px',
                                color: 'var(--success)'
                            }}>
                                üîó Database Connected
                            </span>
                            <div style={{ marginTop: '0.5rem', opacity: 0.7 }}>
                                Falls back to demo mode if API unavailable
                            </div>
                        </div>
                    </div>
                </div>
            );
        }

        // User Header Component (shows current user and role)
        function UserHeader({ user, permissions, onLogout }) {
            const [showDropdown, setShowDropdown] = useState(false);

            const roleColors = {
                admin: '#06D6A0',
                driver: '#FF6B35',
                dispatch: '#FCA311',
                accounting: '#8B5CF6',
                payroll: '#3B82F6'
            };

            return (
                <div style={{ 
                    position: 'relative',
                    display: 'flex',
                    alignItems: 'center',
                    gap: '0.75rem'
                }}>
                    <div 
                        onClick={() => setShowDropdown(!showDropdown)}
                        style={{ 
                            display: 'flex', 
                            alignItems: 'center', 
                            gap: '0.75rem',
                            cursor: 'pointer',
                            padding: '0.5rem 1rem',
                            background: 'var(--bg-dark)',
                            borderRadius: '8px',
                            border: `2px solid ${roleColors[user.role] || 'var(--border)'}`
                        }}
                    >
                        <span style={{ fontSize: '1.5rem' }}>{user.avatar}</span>
                        <div style={{ display: 'flex', flexDirection: 'column' }}>
                            <span style={{ fontWeight: '600', fontSize: '0.9rem' }}>{user.name}</span>
                            <span style={{ 
                                fontSize: '0.7rem', 
                                color: roleColors[user.role] || 'var(--primary)',
                                textTransform: 'uppercase',
                                letterSpacing: '0.5px',
                                fontWeight: '700'
                            }}>
                                {permissions.name}
                            </span>
                        </div>
                        <span style={{ marginLeft: '0.5rem' }}>‚ñº</span>
                    </div>

                    {showDropdown && (
                        <div style={{
                            position: 'absolute',
                            top: '100%',
                            right: 0,
                            marginTop: '0.5rem',
                            background: 'var(--bg-card)',
                            border: '1px solid var(--border)',
                            borderRadius: '12px',
                            boxShadow: '0 10px 40px rgba(0,0,0,0.3)',
                            minWidth: '300px',
                            zIndex: 1000
                        }}>
                            {/* User Info Header */}
                            <div style={{ padding: '1rem', borderBottom: '1px solid var(--border)', background: 'var(--bg-dark)', borderRadius: '12px 12px 0 0' }}>
                                <div style={{ display: 'flex', alignItems: 'center', gap: '1rem' }}>
                                    <span style={{ fontSize: '2.5rem' }}>{user.avatar}</span>
                                    <div>
                                        <div style={{ fontWeight: '700', fontSize: '1.1rem', marginBottom: '0.25rem' }}>{user.name}</div>
                                        <div style={{ fontSize: '0.8rem', color: 'var(--text-muted)' }}>{user.email}</div>
                                    </div>
                                </div>
                                <div style={{ 
                                    marginTop: '0.75rem',
                                    display: 'inline-block',
                                    padding: '0.35rem 0.75rem',
                                    background: roleColors[user.role] || 'var(--primary)',
                                    borderRadius: '6px',
                                    fontSize: '0.75rem',
                                    fontWeight: '700',
                                    textTransform: 'uppercase',
                                    letterSpacing: '0.5px'
                                }}>
                                    üîê {permissions.name}
                                </div>
                            </div>

                            {/* Role Description */}
                            <div style={{ padding: '0.75rem 1rem', borderBottom: '1px solid var(--border)', background: 'rgba(255,255,255,0.02)' }}>
                                <div style={{ fontSize: '0.75rem', color: 'var(--text-muted)', fontStyle: 'italic' }}>
                                    {permissions.description}
                                </div>
                            </div>

                            {/* Access Permissions */}
                            <div style={{ padding: '1rem', borderBottom: '1px solid var(--border)' }}>
                                <div style={{ fontSize: '0.7rem', color: 'var(--text-muted)', marginBottom: '0.5rem', textTransform: 'uppercase', letterSpacing: '0.5px', fontWeight: '600' }}>
                                    Access Permissions
                                </div>
                                <div style={{ display: 'flex', flexWrap: 'wrap', gap: '0.35rem' }}>
                                    {permissions.tabs.map(tab => (
                                        <span key={tab} style={{
                                            padding: '0.25rem 0.5rem',
                                            background: 'var(--bg-dark)',
                                            borderRadius: '4px',
                                            fontSize: '0.7rem',
                                            color: 'var(--success)',
                                            border: '1px solid var(--success)',
                                            textTransform: 'capitalize'
                                        }}>
                                            ‚úì {tab}
                                        </span>
                                    ))}
                                </div>
                            </div>

                            {/* Capabilities */}
                            <div style={{ padding: '1rem', borderBottom: '1px solid var(--border)' }}>
                                <div style={{ fontSize: '0.7rem', color: 'var(--text-muted)', marginBottom: '0.5rem', textTransform: 'uppercase', letterSpacing: '0.5px', fontWeight: '600' }}>
                                    Capabilities
                                </div>
                                <div style={{ display: 'grid', gridTemplateColumns: '1fr 1fr', gap: '0.25rem', fontSize: '0.75rem' }}>
                                    <div style={{ color: permissions.canCreate ? 'var(--success)' : 'var(--text-muted)' }}>
                                        {permissions.canCreate ? '‚úì' : '‚úó'} Create Records
                                    </div>
                                    <div style={{ color: permissions.canEdit ? 'var(--success)' : 'var(--text-muted)' }}>
                                        {permissions.canEdit ? '‚úì' : '‚úó'} Edit Records
                                    </div>
                                    <div style={{ color: permissions.canDelete ? 'var(--success)' : 'var(--text-muted)' }}>
                                        {permissions.canDelete ? '‚úì' : '‚úó'} Delete Records
                                    </div>
                                    <div style={{ color: permissions.canViewAllDCs ? 'var(--success)' : 'var(--text-muted)' }}>
                                        {permissions.canViewAllDCs ? '‚úì' : '‚úó'} View All DCs
                                    </div>
                                    <div style={{ color: permissions.canManageRoutes ? 'var(--success)' : 'var(--text-muted)' }}>
                                        {permissions.canManageRoutes ? '‚úì' : '‚úó'} Manage Routes
                                    </div>
                                    <div style={{ color: permissions.canCollectPayments ? 'var(--success)' : 'var(--text-muted)' }}>
                                        {permissions.canCollectPayments ? '‚úì' : '‚úó'} Collect Payments
                                    </div>
                                    <div style={{ color: permissions.canViewPayroll ? 'var(--success)' : 'var(--text-muted)' }}>
                                        {permissions.canViewPayroll ? '‚úì' : '‚úó'} View Payroll
                                    </div>
                                    <div style={{ color: permissions.canViewAccounting ? 'var(--success)' : 'var(--text-muted)' }}>
                                        {permissions.canViewAccounting ? '‚úì' : '‚úó'} View Accounting
                                    </div>
                                </div>
                            </div>

                            {/* DC Assignment */}
                            {user.dcId && (
                                <div style={{ padding: '0.75rem 1rem', borderBottom: '1px solid var(--border)', background: 'rgba(255,255,255,0.02)' }}>
                                    <div style={{ fontSize: '0.7rem', color: 'var(--text-muted)', marginBottom: '0.25rem' }}>Assigned Distribution Center</div>
                                    <div style={{ fontSize: '0.85rem', fontWeight: '600', color: 'var(--warning)' }}>üìç {user.dcId}</div>
                                </div>
                            )}

                            {/* Session Info */}
                            <div style={{ padding: '0.75rem 1rem', borderBottom: '1px solid var(--border)' }}>
                                <div style={{ fontSize: '0.75rem', color: 'var(--text-muted)' }}>
                                    üïê Last login: {user.lastLogin}
                                </div>
                            </div>

                            {/* Sign Out Button */}
                            <div style={{ padding: '0.75rem' }}>
                                <button
                                    onClick={onLogout}
                                    style={{
                                        width: '100%',
                                        padding: '0.75rem',
                                        background: 'linear-gradient(135deg, var(--danger) 0%, #c53030 100%)',
                                        border: 'none',
                                        borderRadius: '8px',
                                        color: 'white',
                                        fontWeight: '700',
                                        cursor: 'pointer',
                                        display: 'flex',
                                        alignItems: 'center',
                                        justifyContent: 'center',
                                        gap: '0.5rem'
                                    }}
                                >
                                    üö™ Sign Out
                                </button>
                            </div>
                        </div>
                    )}
                </div>
            );
        }

        function App() {
            const [currentUser, setCurrentUser] = useState(null);
            const [activeTab, setActiveTab] = useState('dashboard');
            const [data, setData] = useState(null);
            const [loading, setLoading] = useState(false);
            const [error, setError] = useState(null);
            const [showModal, setShowModal] = useState(false);
            const [modalType, setModalType] = useState(null);
            const [editingItem, setEditingItem] = useState(null);
            const [selectedTruck, setSelectedTruck] = useState(null);
            const [mobileMenuOpen, setMobileMenuOpen] = useState(false);
            const [driverMode, setDriverMode] = useState(false);

            // API base URL - empty for same-origin, or set for different server
            const API_BASE = '';  // Uses /api/* on same domain

            // Fetch all data from API
            const fetchData = async () => {
                setLoading(true);
                setError(null);
                try {
                    const response = await fetch(`${API_BASE}/api/data`);
                    if (!response.ok) throw new Error('Failed to fetch data');
                    const result = await response.json();
                    setData(result);
                } catch (err) {
                    console.error('Error fetching data:', err);
                    setError(err.message);
                    // Fall back to initial data if API fails
                    setData(initialData);
                } finally {
                    setLoading(false);
                }
            };

            // Get permissions for current user
            const permissions = currentUser ? ROLE_PERMISSIONS[currentUser.role] : null;

            // Handle login - now uses API
            const handleLogin = async (user) => {
                setCurrentUser(user);
                // Fetch data after login
                await fetchData();
                // Auto-enable driver mode for drivers
                if (user.role === ROLES.DRIVER) {
                    setDriverMode(true);
                    setActiveTab('dashboard');
                } else {
                    setDriverMode(false);
                }
            };

            // Handle logout
            const handleLogout = () => {
                setCurrentUser(null);
                setData(null);
                setDriverMode(false);
                setActiveTab('dashboard');
            };

            // Check if user has access to a tab
            const hasTabAccess = (tab) => {
                if (!permissions) return false;
                return permissions.tabs.includes(tab);
            };

            // Filter data based on user's DC access
            const getFilteredData = () => {
                if (!data) return { distributionCenters: [], trucks: [], drivers: [], customers: [], orders: [], routes: [] };
                if (!currentUser || !currentUser.dcId || permissions?.canViewAllDCs) {
                    return data;
                }
                // Filter data to only show user's DC
                return {
                    ...data,
                    trucks: data.trucks?.filter(t => t.dcId === currentUser.dcId) || [],
                    routes: data.routes?.filter(r => r.dcId === currentUser.dcId) || [],
                    orders: data.orders?.filter(o => o.preferredDC === currentUser.dcId) || [],
                    customers: data.customers?.filter(c => c.preferredDC === currentUser.dcId) || []
                };
            };

            // Simulate GPS updates every 5 seconds - MUST be before any conditional returns
            useEffect(() => {
                if (!currentUser || !data) return; // Don't run if not logged in or no data
                const interval = setInterval(() => {
                    setData(prev => {
                        if (!prev || !prev.trucks) return prev;
                        return {
                            ...prev,
                            trucks: prev.trucks.map(truck => {
                                if (truck.status === 'active' && Math.random() > 0.5) {
                                    return {
                                        ...truck,
                                        currentLat: truck.currentLat + (Math.random() - 0.5) * 0.002,
                                        currentLng: truck.currentLng + (Math.random() - 0.5) * 0.002,
                                        speed: Math.max(20, Math.min(60, (truck.speed || 30) + (Math.random() - 0.5) * 10)),
                                        lastUpdate: 'Just now'
                                    };
                                }
                                return truck;
                            })
                        };
                    });
                }, 5000);

                return () => clearInterval(interval);
            }, [currentUser, data]);

            // If not logged in, show login screen
            if (!currentUser) {
                return <LoginScreen onLogin={handleLogin} apiBase={API_BASE} />;
            }

            // Show loading state
            if (loading) {
                return (
                    <div style={{
                        minHeight: '100vh',
                        display: 'flex',
                        alignItems: 'center',
                        justifyContent: 'center',
                        background: 'linear-gradient(135deg, var(--bg-dark) 0%, var(--bg-darker) 100%)',
                        flexDirection: 'column',
                        gap: '1rem'
                    }}>
                        <div style={{ fontSize: '3rem' }}>üîÑ</div>
                        <div style={{ color: 'var(--text-primary)', fontSize: '1.2rem' }}>Loading data...</div>
                    </div>
                );
            }

            // Show error state with retry
            if (error && !data) {
                return (
                    <div style={{
                        minHeight: '100vh',
                        display: 'flex',
                        alignItems: 'center',
                        justifyContent: 'center',
                        background: 'linear-gradient(135deg, var(--bg-dark) 0%, var(--bg-darker) 100%)',
                        flexDirection: 'column',
                        gap: '1rem'
                    }}>
                        <div style={{ fontSize: '3rem' }}>‚ö†Ô∏è</div>
                        <div style={{ color: 'var(--danger)', fontSize: '1.2rem' }}>Error: {error}</div>
                        <button className="btn btn-primary" onClick={fetchData}>Retry</button>
                        <button className="btn btn-secondary" onClick={() => { setData(initialData); setError(null); }}>
                            Use Demo Data
                        </button>
                    </div>
                );
            }

            const filteredData = getFilteredData();

            const openModal = (type, item = null) => {
                setModalType(type);
                setEditingItem(item);
                setShowModal(true);
            };

            const closeModal = () => {
                setShowModal(false);
                setModalType(null);
                setEditingItem(null);
            };

            const handleSave = (type, newData) => {
                if (editingItem) {
                    setData(prev => ({
                        ...prev,
                        [type]: prev[type].map(item => 
                            item.id === editingItem.id ? { ...item, ...newData } : item
                        )
                    }));
                } else {
                    let id;
                    let fullData = { ...newData };
                    
                    if (type === 'routes') {
                        // Generate proper route ID
                        const dc = data.distributionCenters.find(d => d.id === newData.dcId);
                        const stateCode = dc?.state?.substring(0, 2).toUpperCase() || 'XX';
                        const routeCount = data.routes.filter(r => r.dcId === newData.dcId).length + 1;
                        id = `RT-${stateCode}-${String(routeCount).padStart(3, '0')}`;
                        
                        // Add default route fields
                        fullData = {
                            ...newData,
                            id,
                            startTime: newData.startTime || '08:00',
                            endTime: null,
                            initialLoad: {},
                            currentLoad: {},
                            emptyPickups: {},
                            stops: [],
                            totalDistance: 0,
                            totalDuration: 0,
                            totalRevenue: 0,
                            totalCost: 0
                        };
                    } else if (type === 'orders') {
                        // Generate proper order ID
                        const stateCode = newData.state?.substring(0, 2).toUpperCase() || 'XX';
                        const orderCount = data.orders.filter(o => o.state === newData.state).length + 1;
                        id = `ORD-${stateCode}-${String(orderCount).padStart(3, '0')}`;
                        fullData = { ...newData, id };
                    } else if (type === 'trucks') {
                        const dc = data.distributionCenters.find(d => d.id === newData.dcId);
                        const stateCode = dc?.state?.substring(0, 2).toUpperCase() || 'XX';
                        const truckCount = data.trucks.filter(t => t.dcId === newData.dcId).length + 1;
                        id = `TRK-${stateCode}-${String(truckCount).padStart(3, '0')}`;
                        fullData = { ...newData, id };
                    } else if (type === 'customers') {
                        const stateCode = newData.state?.substring(0, 2).toUpperCase() || 'XX';
                        const custCount = data.customers.filter(c => c.state === newData.state).length + 1;
                        id = `CUST-${stateCode}-${String(custCount).padStart(3, '0')}`;
                        fullData = { ...newData, id };
                    } else {
                        id = `${type.toUpperCase().slice(0, 3)}${String(data[type].length + 1).padStart(3, '0')}`;
                        fullData = { ...newData, id };
                    }
                    
                    setData(prev => ({
                        ...prev,
                        [type]: [...prev[type], fullData]
                    }));
                }
                closeModal();
            };

            const handleDelete = (type, id) => {
                if (confirm('Are you sure you want to delete this item?')) {
                    setData(prev => ({
                        ...prev,
                        [type]: prev[type].filter(item => item.id !== id)
                    }));
                }
            };

            const handleTruckClick = (truck) => {
                setSelectedTruck(truck);
            };

            const handleTabChange = (tab) => {
                setActiveTab(tab);
                setMobileMenuOpen(false);
            };

            const stats = {
                activeRoutes: data.routes.filter(r => r.status === 'in-progress').length,
                pendingOrders: data.orders.filter(o => o.status === 'pending').length,
                activeTrucks: data.trucks.filter(t => t.status === 'active').length,
                totalRevenue: data.routes.reduce((sum, r) => sum + r.totalRevenue, 0)
            };

            return (
                <div className="app-container">
                    <header className="header">
                        <div className="logo">
                            <div className="logo-icon">üî•</div>
                            <div className="logo-text">
                                <h1>RouteCRMPro</h1>
                                <p>Distribution Management <span style={{ fontSize: '0.65rem', color: 'var(--text-muted)', marginLeft: '0.5rem', padding: '0.15rem 0.4rem', background: 'var(--bg-dark)', borderRadius: '4px' }}>v1.0.0-beta</span></p>
                            </div>
                        </div>
                        <button 
                            className="mobile-menu-toggle"
                            onClick={() => setMobileMenuOpen(!mobileMenuOpen)}
                        >
                            ‚ò∞
                        </button>
                        {!driverMode && (
                            <nav className={`nav-tabs ${mobileMenuOpen ? 'mobile-open' : ''}`}>
                                {hasTabAccess('dashboard') && (
                                    <button 
                                        className={`nav-tab ${activeTab === 'dashboard' ? 'active' : ''}`}
                                        onClick={() => handleTabChange('dashboard')}
                                    >
                                        Dashboard
                                    </button>
                                )}
                                {hasTabAccess('orders') && (
                                    <button 
                                        className={`nav-tab ${activeTab === 'orders' ? 'active' : ''}`}
                                        onClick={() => handleTabChange('orders')}
                                    >
                                        Orders
                                    </button>
                                )}
                                {hasTabAccess('routes') && (
                                    <button 
                                        className={`nav-tab ${activeTab === 'routes' ? 'active' : ''}`}
                                        onClick={() => handleTabChange('routes')}
                                    >
                                        Routes
                                    </button>
                                )}
                                {hasTabAccess('fleet') && (
                                    <button 
                                        className={`nav-tab ${activeTab === 'fleet' ? 'active' : ''}`}
                                        onClick={() => handleTabChange('fleet')}
                                    >
                                        Fleet
                                    </button>
                                )}
                                {hasTabAccess('customers') && (
                                    <button 
                                        className={`nav-tab ${activeTab === 'customers' ? 'active' : ''}`}
                                        onClick={() => handleTabChange('customers')}
                                    >
                                        Customers
                                    </button>
                                )}
                                {hasTabAccess('employees') && (
                                    <button 
                                        className={`nav-tab ${activeTab === 'employees' ? 'active' : ''}`}
                                        onClick={() => handleTabChange('employees')}
                                    >
                                        Employees
                                    </button>
                                )}
                                {hasTabAccess('reports') && (
                                    <button 
                                        className={`nav-tab ${activeTab === 'reports' ? 'active' : ''}`}
                                        onClick={() => handleTabChange('reports')}
                                    >
                                        Reports
                                    </button>
                                )}
                                {hasTabAccess('payments') && (
                                    <button 
                                        className={`nav-tab ${activeTab === 'payments' ? 'active' : ''}`}
                                        onClick={() => handleTabChange('payments')}
                                    >
                                        Payments
                                    </button>
                                )}
                                {hasTabAccess('management') && (
                                    <button 
                                        className={`nav-tab ${activeTab === 'management' ? 'active' : ''}`}
                                        onClick={() => handleTabChange('management')}
                                    >
                                        Management
                                    </button>
                                )}
                            </nav>
                        )}
                        <UserHeader user={currentUser} permissions={permissions} onLogout={handleLogout} />
                    </header>

                    <main className="main-content">
                        {driverMode && (
                            <DriverModeInterface 
                                data={filteredData}
                                setData={setData}
                                setDriverMode={permissions?.driverModeOnly ? () => {} : setDriverMode}
                                currentUser={currentUser}
                            />
                        )}
                        {!driverMode && activeTab === 'dashboard' && hasTabAccess('dashboard') && (
                            <DashboardTab 
                                stats={stats} 
                                data={filteredData}
                                openModal={permissions?.canCreate ? openModal : () => {}}
                                selectedTruck={selectedTruck}
                                onTruckClick={handleTruckClick}
                                permissions={permissions}
                            />
                        )}
                        {!driverMode && activeTab === 'orders' && hasTabAccess('orders') && (
                            <OrdersTab 
                                orders={filteredData.orders}
                                openModal={permissions?.canCreate ? openModal : () => {}}
                                handleDelete={permissions?.canDelete ? handleDelete : () => {}}
                                permissions={permissions}
                            />
                        )}
                        {!driverMode && activeTab === 'routes' && hasTabAccess('routes') && (
                            <RoutesTab 
                                routes={filteredData.routes}
                                trucks={filteredData.trucks}
                                drivers={data.drivers}
                                orders={filteredData.orders}
                                distributionCenters={data.distributionCenters}
                                customers={filteredData.customers}
                                openModal={permissions?.canCreate ? openModal : () => {}}
                                handleDelete={permissions?.canDelete ? handleDelete : () => {}}
                                permissions={permissions}
                            />
                        )}
                        {!driverMode && activeTab === 'fleet' && hasTabAccess('fleet') && (
                            <FleetTab 
                                trucks={filteredData.trucks}
                                drivers={data.drivers}
                                distributionCenters={data.distributionCenters}
                                openModal={permissions?.canCreate ? openModal : () => {}}
                                handleDelete={permissions?.canDelete ? handleDelete : () => {}}
                                permissions={permissions}
                            />
                        )}
                        {!driverMode && activeTab === 'customers' && hasTabAccess('customers') && (
                            <CustomersTab 
                                customers={filteredData.customers}
                                distributionCenters={data.distributionCenters}
                                openModal={permissions?.canCreate ? openModal : () => {}}
                                handleDelete={permissions?.canDelete ? handleDelete : () => {}}
                                permissions={permissions}
                            />
                        )}
                        {!driverMode && activeTab === 'employees' && hasTabAccess('employees') && (
                            <EmployeesTab 
                                drivers={data.drivers}
                                openModal={permissions?.canCreate ? openModal : () => {}}
                                handleDelete={permissions?.canDelete ? handleDelete : () => {}}
                                permissions={permissions}
                            />
                        )}
                        {!driverMode && activeTab === 'reports' && hasTabAccess('reports') && (
                            <ReportsTab 
                                data={filteredData}
                                permissions={permissions}
                            />
                        )}
                        {!driverMode && activeTab === 'payments' && hasTabAccess('payments') && (
                            <PaymentsTab 
                                data={filteredData}
                                setData={setData}
                                permissions={permissions}
                            />
                        )}
                        {!driverMode && activeTab === 'management' && hasTabAccess('management') && (
                            <ManagementTab 
                                data={data}
                                openModal={permissions?.canCreate ? openModal : () => {}}
                                handleDelete={permissions?.canDelete ? handleDelete : () => {}}
                                setDriverMode={setDriverMode}
                                driverMode={driverMode}
                                permissions={permissions}
                            />
                        )}
                    </main>

                    {!driverMode && !permissions?.driverModeOnly && (
                        <div className="quick-actions">
                            <button 
                                className="fab-button"
                                onClick={() => setDriverMode(true)}
                                title="Enable Driver Mode"
                            >
                                üöõ
                            </button>
                        </div>
                    )}

                    {showModal && (
                        <Modal 
                            type={modalType}
                            item={editingItem}
                            data={data}
                            onClose={closeModal}
                            onSave={handleSave}
                        />
                    )}
                </div>
            );
        }

        function TruckRouteDetails({ truck, data, onClose }) {
            // Find the route assigned to this truck (any status except completed)
            const route = data.routes.find(r => r.truckId === truck.id && r.status !== 'completed');
            const driver = data.drivers.find(d => d.id === route?.driverId);
            const dc = data.distributionCenters.find(d => d.id === route?.dcId);
            
            // Get stops with order details
            const stopsWithDetails = route?.stops?.map((stop, idx) => {
                const order = data.orders.find(o => o.id === stop.orderId);
                const customer = order ? data.customers.find(c => c.id === order.customerId) : null;
                return {
                    ...stop,
                    order,
                    customer,
                    sequence: idx + 1
                };
            }) || [];

            const completedStops = stopsWithDetails.filter(s => s.status === 'completed');
            const remainingStops = stopsWithDetails.filter(s => s.status !== 'completed');
            const currentStop = remainingStops[0];

            // Calculate totals
            const totalDelivered = completedStops.reduce((sum, s) => sum + (s.order?.volume || 0), 0);
            const totalRemaining = remainingStops.reduce((sum, s) => sum + (s.order?.volume || 0), 0);
            const totalRevenue = completedStops.reduce((sum, s) => sum + (s.order?.revenue || 0), 0);
            const expectedRevenue = route?.totalRevenue || 0;

            // Product breakdown for completed stops
            const productBreakdown = {};
            completedStops.forEach(stop => {
                if (stop.delivered) {
                    Object.entries(stop.delivered).forEach(([sku, qty]) => {
                        productBreakdown[sku] = (productBreakdown[sku] || 0) + qty;
                    });
                }
            });

            return (
                <div className="card" style={{ border: '3px solid var(--primary)' }}>
                    {/* Header */}
                    <div className="card-header" style={{ background: 'linear-gradient(135deg, var(--primary) 0%, var(--primary-dark) 100%)', margin: '-1.5rem -1.5rem 1.5rem -1.5rem', padding: '1.5rem', borderRadius: '12px 12px 0 0' }}>
                        <div>
                            <h2 className="card-title" style={{ color: 'white', margin: 0 }}>üöõ {truck.name}</h2>
                            <div style={{ color: 'rgba(255,255,255,0.8)', fontSize: '0.9rem', marginTop: '0.25rem' }}>
                                {driver?.name || 'No Driver'} ‚Ä¢ {route?.id || 'No Active Route'}
                            </div>
                        </div>
                        <button className="btn btn-sm" style={{ background: 'rgba(255,255,255,0.2)', border: 'none', color: 'white' }} onClick={onClose}>
                            ‚úï Close
                        </button>
                    </div>

                    {!route ? (
                        <div style={{ textAlign: 'center', padding: '3rem', color: 'var(--text-muted)' }}>
                            <div style={{ fontSize: '3rem', marginBottom: '1rem' }}>üöõ</div>
                            <div style={{ fontSize: '1.2rem', fontWeight: '600' }}>No Active Route</div>
                            <div style={{ marginTop: '0.5rem' }}>This truck is not currently assigned to a route.</div>
                        </div>
                    ) : (
                        <>
                            {/* Route Info Bar */}
                            <div style={{ 
                                display: 'flex', 
                                flexWrap: 'wrap',
                                gap: '1.5rem', 
                                padding: '1rem 1.25rem', 
                                background: 'var(--bg-dark)', 
                                borderRadius: '12px', 
                                marginBottom: '1.5rem',
                                border: '2px solid var(--border)'
                            }}>
                                <div style={{ display: 'flex', alignItems: 'center', gap: '0.5rem' }}>
                                    <span style={{ fontSize: '1.2rem' }}>üìÖ</span>
                                    <div>
                                        <div style={{ fontSize: '0.7rem', color: 'var(--text-muted)', textTransform: 'uppercase' }}>Date</div>
                                        <div style={{ fontWeight: '700', fontSize: '0.95rem' }}>{route.date}</div>
                                    </div>
                                </div>
                                <div style={{ display: 'flex', alignItems: 'center', gap: '0.5rem' }}>
                                    <span style={{ fontSize: '1.2rem' }}>üïê</span>
                                    <div>
                                        <div style={{ fontSize: '0.7rem', color: 'var(--text-muted)', textTransform: 'uppercase' }}>Start Time</div>
                                        <div style={{ fontWeight: '700', fontSize: '0.95rem', color: 'var(--success)' }}>{route.startTime || 'Not Set'}</div>
                                    </div>
                                </div>
                                <div style={{ display: 'flex', alignItems: 'center', gap: '0.5rem' }}>
                                    <span style={{ fontSize: '1.2rem' }}>üèÅ</span>
                                    <div>
                                        <div style={{ fontSize: '0.7rem', color: 'var(--text-muted)', textTransform: 'uppercase' }}>End Time</div>
                                        <div style={{ fontWeight: '700', fontSize: '0.95rem' }}>{route.endTime || 'In Progress'}</div>
                                    </div>
                                </div>
                                <div style={{ display: 'flex', alignItems: 'center', gap: '0.5rem' }}>
                                    <span style={{ fontSize: '1.2rem' }}>üè≠</span>
                                    <div>
                                        <div style={{ fontSize: '0.7rem', color: 'var(--text-muted)', textTransform: 'uppercase' }}>Distribution Center</div>
                                        <div style={{ fontWeight: '700', fontSize: '0.95rem' }}>{dc?.name || 'Unknown'}</div>
                                    </div>
                                </div>
                                <div style={{ display: 'flex', alignItems: 'center', gap: '0.5rem' }}>
                                    <span style={{ fontSize: '1.2rem' }}>üë§</span>
                                    <div>
                                        <div style={{ fontSize: '0.7rem', color: 'var(--text-muted)', textTransform: 'uppercase' }}>Driver</div>
                                        <div style={{ fontWeight: '700', fontSize: '0.95rem' }}>{driver?.name || 'Unassigned'}</div>
                                    </div>
                                </div>
                                <div style={{ display: 'flex', alignItems: 'center', gap: '0.5rem' }}>
                                    <span style={{ fontSize: '1.2rem' }}>üìã</span>
                                    <div>
                                        <div style={{ fontSize: '0.7rem', color: 'var(--text-muted)', textTransform: 'uppercase' }}>Status</div>
                                        <span className={`badge badge-${route.status === 'completed' ? 'success' : route.status === 'in-progress' ? 'warning' : 'secondary'}`} style={{ fontSize: '0.8rem' }}>
                                            {route.status}
                                        </span>
                                    </div>
                                </div>
                            </div>

                            {/* Stats Row */}
                            <div style={{ display: 'grid', gridTemplateColumns: 'repeat(auto-fit, minmax(140px, 1fr))', gap: '1rem', marginBottom: '1.5rem' }}>
                                <div style={{ padding: '1rem', background: 'var(--bg-dark)', borderRadius: '12px', border: '2px solid var(--success)', textAlign: 'center' }}>
                                    <div style={{ fontSize: '0.8rem', color: 'var(--text-muted)', marginBottom: '0.25rem' }}>Completed</div>
                                    <div style={{ fontSize: '1.8rem', fontWeight: '800', color: 'var(--success)' }}>{completedStops.length}</div>
                                    <div style={{ fontSize: '0.75rem', color: 'var(--text-muted)' }}>of {stopsWithDetails.length} stops</div>
                                </div>
                                <div style={{ padding: '1rem', background: 'var(--bg-dark)', borderRadius: '12px', border: '2px solid var(--warning)', textAlign: 'center' }}>
                                    <div style={{ fontSize: '0.8rem', color: 'var(--text-muted)', marginBottom: '0.25rem' }}>Remaining</div>
                                    <div style={{ fontSize: '1.8rem', fontWeight: '800', color: 'var(--warning)' }}>{remainingStops.length}</div>
                                    <div style={{ fontSize: '0.75rem', color: 'var(--text-muted)' }}>stops left</div>
                                </div>
                                <div style={{ padding: '1rem', background: 'var(--bg-dark)', borderRadius: '12px', border: '2px solid var(--primary)', textAlign: 'center' }}>
                                    <div style={{ fontSize: '0.8rem', color: 'var(--text-muted)', marginBottom: '0.25rem' }}>Delivered</div>
                                    <div style={{ fontSize: '1.8rem', fontWeight: '800', color: 'var(--primary)' }}>{totalDelivered}</div>
                                    <div style={{ fontSize: '0.75rem', color: 'var(--text-muted)' }}>units</div>
                                </div>
                                <div style={{ padding: '1rem', background: 'var(--bg-dark)', borderRadius: '12px', border: '2px solid var(--accent)', textAlign: 'center' }}>
                                    <div style={{ fontSize: '0.8rem', color: 'var(--text-muted)', marginBottom: '0.25rem' }}>Revenue</div>
                                    <div style={{ fontSize: '1.5rem', fontWeight: '800', color: 'var(--accent)' }}>${totalRevenue.toLocaleString()}</div>
                                    <div style={{ fontSize: '0.75rem', color: 'var(--text-muted)' }}>of ${expectedRevenue.toLocaleString()}</div>
                                </div>
                                <div style={{ padding: '1rem', background: 'var(--bg-dark)', borderRadius: '12px', border: '2px solid var(--border)', textAlign: 'center' }}>
                                    <div style={{ fontSize: '0.8rem', color: 'var(--text-muted)', marginBottom: '0.25rem' }}>Speed</div>
                                    <div style={{ fontSize: '1.8rem', fontWeight: '800', fontFamily: "'JetBrains Mono', monospace" }}>{truck.speed}</div>
                                    <div style={{ fontSize: '0.75rem', color: 'var(--text-muted)' }}>mph</div>
                                </div>
                                <div style={{ padding: '1rem', background: 'var(--bg-dark)', borderRadius: '12px', border: '2px solid var(--border)', textAlign: 'center' }}>
                                    <div style={{ fontSize: '0.8rem', color: 'var(--text-muted)', marginBottom: '0.25rem' }}>Distance</div>
                                    <div style={{ fontSize: '1.8rem', fontWeight: '800', fontFamily: "'JetBrains Mono', monospace" }}>{route.distance}</div>
                                    <div style={{ fontSize: '0.75rem', color: 'var(--text-muted)' }}>miles</div>
                                </div>
                            </div>

                            {/* Progress Bar */}
                            <div style={{ marginBottom: '1.5rem' }}>
                                <div style={{ display: 'flex', justifyContent: 'space-between', marginBottom: '0.5rem' }}>
                                    <span style={{ fontSize: '0.85rem', fontWeight: '600' }}>Route Progress</span>
                                    <span style={{ fontSize: '0.85rem', color: 'var(--text-muted)' }}>{Math.round((completedStops.length / stopsWithDetails.length) * 100)}%</span>
                                </div>
                                <div style={{ height: '12px', background: 'var(--bg-dark)', borderRadius: '6px', overflow: 'hidden' }}>
                                    <div style={{ 
                                        height: '100%', 
                                        width: `${(completedStops.length / stopsWithDetails.length) * 100}%`,
                                        background: 'linear-gradient(90deg, var(--success) 0%, var(--accent) 100%)',
                                        borderRadius: '6px',
                                        transition: 'width 0.5s ease'
                                    }}></div>
                                </div>
                            </div>

                            {/* Product Delivery Summary */}
                            {Object.keys(productBreakdown).length > 0 && (
                                <div style={{ marginBottom: '1.5rem', padding: '1rem', background: 'var(--bg-dark)', borderRadius: '12px' }}>
                                    <div style={{ fontWeight: '700', marginBottom: '0.75rem', fontSize: '0.9rem' }}>üì¶ Products Delivered</div>
                                    <div style={{ display: 'flex', flexWrap: 'wrap', gap: '0.5rem' }}>
                                        {Object.entries(productBreakdown).map(([sku, qty]) => (
                                            <div key={sku} style={{ 
                                                padding: '0.5rem 1rem', 
                                                background: 'var(--bg-card)', 
                                                borderRadius: '8px',
                                                border: '1px solid var(--border)',
                                                display: 'flex',
                                                alignItems: 'center',
                                                gap: '0.5rem'
                                            }}>
                                                <span style={{ fontWeight: '600', color: 'var(--primary)' }}>{sku}</span>
                                                <span style={{ fontFamily: "'JetBrains Mono', monospace", fontWeight: '700' }}>√ó{qty}</span>
                                            </div>
                                        ))}
                                    </div>
                                </div>
                            )}

                            {/* Timeline */}
                            <div style={{ marginBottom: '1rem' }}>
                                <div style={{ fontWeight: '700', marginBottom: '1rem', fontSize: '0.9rem' }}>üìç Route Timeline</div>
                                
                                {/* Starting Point */}
                                <div style={{ display: 'flex', gap: '1rem', marginBottom: '0' }}>
                                    <div style={{ display: 'flex', flexDirection: 'column', alignItems: 'center', width: '40px' }}>
                                        <div style={{ 
                                            width: '40px', 
                                            height: '40px', 
                                            borderRadius: '50%', 
                                            background: 'linear-gradient(135deg, #004E89 0%, #003A6B 100%)',
                                            border: '3px solid #FFD23F',
                                            display: 'flex',
                                            alignItems: 'center',
                                            justifyContent: 'center',
                                            fontSize: '1.2rem'
                                        }}>üè≠</div>
                                        <div style={{ width: '3px', height: '30px', background: 'var(--success)' }}></div>
                                    </div>
                                    <div style={{ flex: 1, paddingBottom: '0.5rem' }}>
                                        <div style={{ fontWeight: '700' }}>{dc?.name || 'Distribution Center'}</div>
                                        <div style={{ fontSize: '0.85rem', color: 'var(--text-muted)' }}>Route Start ‚Ä¢ {route.date}</div>
                                    </div>
                                </div>

                                {/* Stops */}
                                {stopsWithDetails.map((stop, idx) => {
                                    const isCompleted = stop.status === 'completed';
                                    const isCurrent = stop === currentStop;
                                    const isLast = idx === stopsWithDetails.length - 1;
                                    
                                    return (
                                        <div key={stop.orderId || idx} style={{ display: 'flex', gap: '1rem' }}>
                                            <div style={{ display: 'flex', flexDirection: 'column', alignItems: 'center', width: '40px' }}>
                                                <div style={{ 
                                                    width: '40px', 
                                                    height: '40px', 
                                                    borderRadius: '50%', 
                                                    background: isCompleted 
                                                        ? 'linear-gradient(135deg, var(--success) 0%, #05B589 100%)'
                                                        : isCurrent 
                                                            ? 'linear-gradient(135deg, var(--warning) 0%, #E88A00 100%)'
                                                            : 'var(--bg-dark)',
                                                    border: `3px solid ${isCompleted ? 'var(--success)' : isCurrent ? 'var(--warning)' : 'var(--border)'}`,
                                                    display: 'flex',
                                                    alignItems: 'center',
                                                    justifyContent: 'center',
                                                    fontSize: '1rem',
                                                    fontWeight: '800',
                                                    color: isCompleted || isCurrent ? 'white' : 'var(--text-muted)'
                                                }}>
                                                    {isCompleted ? '‚úì' : stop.sequence}
                                                </div>
                                                {!isLast && (
                                                    <div style={{ 
                                                        width: '3px', 
                                                        height: '100%', 
                                                        minHeight: '60px',
                                                        background: isCompleted ? 'var(--success)' : 'var(--border)'
                                                    }}></div>
                                                )}
                                            </div>
                                            <div style={{ 
                                                flex: 1, 
                                                paddingBottom: '1rem',
                                                padding: '0.75rem',
                                                background: isCurrent ? 'rgba(255, 193, 7, 0.1)' : 'transparent',
                                                borderRadius: '8px',
                                                border: isCurrent ? '2px solid var(--warning)' : 'none',
                                                marginBottom: '0.5rem'
                                            }}>
                                                <div style={{ display: 'flex', justifyContent: 'space-between', alignItems: 'flex-start', marginBottom: '0.25rem' }}>
                                                    <div style={{ fontWeight: '700' }}>{stop.customer?.name || stop.order?.customer || 'Unknown'}</div>
                                                    <span className={`badge badge-sm ${isCompleted ? 'badge-success' : isCurrent ? 'badge-warning' : 'badge-secondary'}`}>
                                                        {isCompleted ? 'Completed' : isCurrent ? 'Next Stop' : 'Pending'}
                                                    </span>
                                                </div>
                                                <div style={{ fontSize: '0.85rem', color: 'var(--text-muted)', marginBottom: '0.5rem' }}>
                                                    {stop.order?.address || 'Address not available'}
                                                </div>
                                                <div style={{ display: 'flex', flexWrap: 'wrap', gap: '1rem', fontSize: '0.85rem' }}>
                                                    <span>üïê {stop.estimatedTime || 'TBD'}</span>
                                                    <span>üì¶ {stop.order?.volume || 0} units</span>
                                                    <span style={{ color: 'var(--success)', fontWeight: '600' }}>${stop.order?.revenue || 0}</span>
                                                </div>
                                                
                                                {/* Product details for completed stops */}
                                                {isCompleted && stop.delivered && (
                                                    <div style={{ marginTop: '0.75rem', padding: '0.5rem', background: 'var(--bg-dark)', borderRadius: '6px' }}>
                                                        <div style={{ fontSize: '0.75rem', color: 'var(--text-muted)', marginBottom: '0.25rem' }}>Delivered:</div>
                                                        <div style={{ display: 'flex', flexWrap: 'wrap', gap: '0.5rem' }}>
                                                            {Object.entries(stop.delivered).map(([sku, qty]) => (
                                                                <span key={sku} style={{ 
                                                                    fontSize: '0.8rem',
                                                                    padding: '0.25rem 0.5rem',
                                                                    background: 'var(--success)',
                                                                    color: 'white',
                                                                    borderRadius: '4px',
                                                                    fontWeight: '600'
                                                                }}>
                                                                    {sku}: {qty}
                                                                </span>
                                                            ))}
                                                        </div>
                                                        {stop.completedTime && (
                                                            <div style={{ fontSize: '0.75rem', color: 'var(--success)', marginTop: '0.5rem' }}>
                                                                ‚úì Completed at {stop.completedTime}
                                                            </div>
                                                        )}
                                                    </div>
                                                )}

                                                {/* Expected products for pending stops */}
                                                {!isCompleted && stop.order?.products && (
                                                    <div style={{ marginTop: '0.75rem', padding: '0.5rem', background: 'var(--bg-dark)', borderRadius: '6px' }}>
                                                        <div style={{ fontSize: '0.75rem', color: 'var(--text-muted)', marginBottom: '0.25rem' }}>Expected delivery:</div>
                                                        <div style={{ display: 'flex', flexWrap: 'wrap', gap: '0.5rem' }}>
                                                            {Object.entries(stop.order.products).map(([sku, qty]) => (
                                                                <span key={sku} style={{ 
                                                                    fontSize: '0.8rem',
                                                                    padding: '0.25rem 0.5rem',
                                                                    background: 'var(--border)',
                                                                    borderRadius: '4px',
                                                                    fontWeight: '600'
                                                                }}>
                                                                    {sku}: {qty}
                                                                </span>
                                                            ))}
                                                        </div>
                                                    </div>
                                                )}
                                            </div>
                                        </div>
                                    );
                                })}

                                {/* Return to DC */}
                                <div style={{ display: 'flex', gap: '1rem' }}>
                                    <div style={{ display: 'flex', flexDirection: 'column', alignItems: 'center', width: '40px' }}>
                                        <div style={{ 
                                            width: '40px', 
                                            height: '40px', 
                                            borderRadius: '50%', 
                                            background: completedStops.length === stopsWithDetails.length 
                                                ? 'linear-gradient(135deg, #004E89 0%, #003A6B 100%)'
                                                : 'var(--bg-dark)',
                                            border: `3px solid ${completedStops.length === stopsWithDetails.length ? '#FFD23F' : 'var(--border)'}`,
                                            display: 'flex',
                                            alignItems: 'center',
                                            justifyContent: 'center',
                                            fontSize: '1.2rem'
                                        }}>üèÅ</div>
                                    </div>
                                    <div style={{ flex: 1 }}>
                                        <div style={{ fontWeight: '700', color: completedStops.length === stopsWithDetails.length ? 'var(--success)' : 'var(--text-muted)' }}>
                                            Return to {dc?.name || 'Distribution Center'}
                                        </div>
                                        <div style={{ fontSize: '0.85rem', color: 'var(--text-muted)' }}>
                                            {completedStops.length === stopsWithDetails.length ? 'Route Complete!' : 'End of route'}
                                        </div>
                                    </div>
                                </div>
                            </div>

                            {/* GPS Info Footer */}
                            <div style={{ marginTop: '1rem', padding: '0.75rem', background: 'var(--bg-dark)', borderRadius: '8px', display: 'flex', justifyContent: 'space-between', alignItems: 'center', fontSize: '0.85rem' }}>
                                <span style={{ color: 'var(--text-muted)' }}>
                                    üìç GPS: {truck.currentLat.toFixed(5)}, {truck.currentLng.toFixed(5)}
                                </span>
                                <span style={{ color: 'var(--success)' }}>
                                    üü¢ Last update: {truck.lastUpdate}
                                </span>
                            </div>
                        </>
                    )}
                </div>
            );
        }

        function DashboardTab({ stats, data, openModal, selectedTruck, onTruckClick }) {
            return (
                <>
                    <div className="dashboard-grid">
                        <div className="stat-card">
                            <div className="stat-header">
                                <div>
                                    <div className="stat-label">Active Routes</div>
                                    <div className="stat-value">{stats.activeRoutes}</div>
                                    <div className="stat-change positive">‚Üë 2 from yesterday</div>
                                </div>
                                <div className="stat-icon" style={{ background: 'linear-gradient(135deg, #FF6B35 0%, #E85A2A 100%)' }}>
                                    üöõ
                                </div>
                            </div>
                        </div>

                        <div className="stat-card">
                            <div className="stat-header">
                                <div>
                                    <div className="stat-label">Pending Orders</div>
                                    <div className="stat-value">{stats.pendingOrders}</div>
                                    <div className="stat-change warning">‚ö† Needs attention</div>
                                </div>
                                <div className="stat-icon" style={{ background: 'linear-gradient(135deg, #FCA311 0%, #FF9500 100%)' }}>
                                    üì¶
                                </div>
                            </div>
                        </div>

                        <div className="stat-card">
                            <div className="stat-header">
                                <div>
                                    <div className="stat-label">Active Trucks</div>
                                    <div className="stat-value">{stats.activeTrucks}</div>
                                    <div className="stat-change positive">All operational</div>
                                </div>
                                <div className="stat-icon" style={{ background: 'linear-gradient(135deg, #06D6A0 0%, #05B589 100%)' }}>
                                    ‚úì
                                </div>
                            </div>
                        </div>

                        <div className="stat-card">
                            <div className="stat-header">
                                <div>
                                    <div className="stat-label">Today's Revenue</div>
                                    <div className="stat-value">${stats.totalRevenue.toLocaleString()}</div>
                                    <div className="stat-change positive">‚Üë 12% vs avg</div>
                                </div>
                                <div className="stat-icon" style={{ background: 'linear-gradient(135deg, #FFD23F 0%, #FFBB00 100%)' }}>
                                    üí∞
                                </div>
                            </div>
                        </div>
                    </div>

                    <div className="card">
                        <div className="card-header">
                            <h2 className="card-title">üåç Live GPS Tracking</h2>
                            <div style={{ fontSize: '0.85rem', color: 'var(--text-muted)' }}>
                                Real-time truck locations ‚Ä¢ Click markers for details
                            </div>
                        </div>
                        <GPSMap 
                            trucks={data.trucks}
                            routes={data.routes}
                            orders={data.orders}
                            drivers={data.drivers}
                            distributionCenters={data.distributionCenters}
                            onTruckClick={onTruckClick}
                        />
                    </div>

                    {selectedTruck && (
                        <TruckRouteDetails 
                            truck={selectedTruck}
                            data={data}
                            onClose={() => onTruckClick(null)}
                        />
                    )}

                    <div className="card">
                        <div className="card-header">
                            <h2 className="card-title">üìç Active Routes Today</h2>
                            <button className="btn btn-primary" onClick={() => openModal('route')}>
                                + Create Route
                            </button>
                        </div>
                        {data.routes.filter(r => r.status === 'in-progress').length > 0 ? (
                            <div className="table-container">
                                <table className="table">
                                    <thead>
                                        <tr>
                                            <th>Route ID</th>
                                            <th>DC</th>
                                            <th>Truck</th>
                                            <th>Driver</th>
                                            <th>Stops</th>
                                            <th>Distance</th>
                                            <th>Duration</th>
                                            <th>Fuel Cost</th>
                                            <th>Driver Cost</th>
                                            <th>Maint. Cost</th>
                                            <th>Total Cost</th>
                                            <th>Revenue</th>
                                            <th>Profit</th>
                                            <th>Status</th>
                                        </tr>
                                    </thead>
                                    <tbody>
                                        {data.routes.filter(r => r.status === 'in-progress').map(route => {
                                            const dc = data.distributionCenters.find(d => d.id === route.dcId);
                                            const truck = data.trucks.find(t => t.id === route.truckId);
                                            const driver = data.drivers.find(d => d.id === route.driverId);
                                            const costs = truck && driver ? calculateRouteCosts(route, truck, driver) : null;
                                            
                                            return (
                                            <tr key={route.id}>
                                                <td><strong>{route.id}</strong></td>
                                                <td>{dc?.city}, {dc?.state}</td>
                                                <td>{truck?.name}</td>
                                                <td>{driver?.name}</td>
                                                <td>{route.stops.length}</td>
                                                <td>{route.totalDistance} mi</td>
                                                <td>{route.totalDuration} min</td>
                                                <td style={{ fontFamily: "'JetBrains Mono', monospace", fontSize: '0.9rem', color: 'var(--warning)' }}>
                                                    ${costs?.fuelCost || '0.00'}
                                                </td>
                                                <td style={{ fontFamily: "'JetBrains Mono', monospace", fontSize: '0.9rem', color: 'var(--secondary)' }}>
                                                    ${costs?.driverCost || '0.00'}
                                                </td>
                                                <td style={{ fontFamily: "'JetBrains Mono', monospace", fontSize: '0.9rem', color: 'var(--text-muted)' }}>
                                                    ${costs?.maintenanceCost || '0.00'}
                                                </td>
                                                <td style={{ fontFamily: "'JetBrains Mono', monospace", fontSize: '0.9rem', fontWeight: '700', color: 'var(--danger)' }}>
                                                    ${costs?.totalCost || '0.00'}
                                                </td>
                                                <td style={{ fontFamily: "'JetBrains Mono', monospace", fontSize: '0.9rem', fontWeight: '700', color: 'var(--success)' }}>
                                                    ${costs?.revenue || '0.00'}
                                                </td>
                                                <td style={{ 
                                                    fontFamily: "'JetBrains Mono', monospace", 
                                                    fontSize: '0.9rem',
                                                    fontWeight: '700',
                                                    color: (costs?.profit || 0) > 0 ? 'var(--success)' : 'var(--danger)' 
                                                }}>
                                                    ${costs?.profit || '0.00'}
                                                </td>
                                                <td><span className="badge badge-success">{route.status}</span></td>
                                            </tr>
                                        )})}
                                    </tbody>
                                </table>
                            </div>
                        ) : (
                            <p style={{ color: 'var(--text-muted)', textAlign: 'center', padding: '2rem' }}>
                                No active routes today. Create a route to get started.
                            </p>
                        )}
                    </div>
                </>
            );
        }

        function OrdersTab({ orders, openModal, handleDelete }) {
            const [filterStatus, setFilterStatus] = useState('all');

            const filteredOrders = filterStatus === 'all' 
                ? orders 
                : orders.filter(o => o.status === filterStatus);

            return (
                <div className="card">
                    <div className="card-header">
                        <h2 className="card-title">üì¶ Customer Orders</h2>
                        <div style={{ display: 'flex', gap: '1rem' }}>
                            <select 
                                className="form-select" 
                                style={{ width: '200px' }}
                                value={filterStatus}
                                onChange={(e) => setFilterStatus(e.target.value)}
                            >
                                <option value="all">All Orders</option>
                                <option value="pending">Pending</option>
                                <option value="assigned">Assigned</option>
                                <option value="completed">Completed</option>
                            </select>
                            <button className="btn btn-primary" onClick={() => openModal('order')}>
                                + New Order
                            </button>
                        </div>
                    </div>
                    <div className="table-container">
                        <table className="table">
                            <thead>
                                <tr>
                                    <th>Order ID</th>
                                    <th>Customer</th>
                                    <th>Address</th>
                                    <th>Volume (gal)</th>
                                    <th>Revenue</th>
                                    <th>Priority</th>
                                    <th>Status</th>
                                    <th>Delivery Date</th>
                                    <th>Actions</th>
                                </tr>
                            </thead>
                            <tbody>
                                {filteredOrders.map(order => (
                                    <tr key={order.id}>
                                        <td><strong>{order.id}</strong></td>
                                        <td>{order.customer}</td>
                                        <td>{order.address}</td>
                                        <td>{order.volume}</td>
                                        <td>${order.revenue}</td>
                                        <td>
                                            <span className={`badge badge-${
                                                order.priority === 'high' ? 'danger' :
                                                order.priority === 'medium' ? 'warning' : 'info'
                                            }`}>
                                                {order.priority}
                                            </span>
                                        </td>
                                        <td>
                                            <span className={`badge badge-${
                                                order.status === 'completed' ? 'success' :
                                                order.status === 'assigned' ? 'info' : 'warning'
                                            }`}>
                                                {order.status}
                                            </span>
                                        </td>
                                        <td>{order.deliveryDate}</td>
                                        <td>
                                            <button 
                                                className="btn btn-sm btn-secondary"
                                                onClick={() => openModal('order', order)}
                                            >
                                                Edit
                                            </button>
                                        </td>
                                    </tr>
                                ))}
                            </tbody>
                        </table>
                    </div>
                </div>
            );
        }

        function RoutesTab({ routes, trucks, drivers, orders, distributionCenters, customers, openModal, handleDelete }) {
            const [selectedRoute, setSelectedRoute] = useState(null);
            const [managingRoute, setManagingRoute] = useState(null);
            const [fuelPrice, setFuelPrice] = useState(DIESEL_PRICE_PER_GALLON);
            const [showAddStopModal, setShowAddStopModal] = useState(false);
            const [newStop, setNewStop] = useState({ customerId: '', address: '', estimatedTime: '', notes: '' });
            const [optimizingRoute, setOptimizingRoute] = useState(null);
            const [optimizationResult, setOptimizationResult] = useState(null);

            const handleOptimizeRoute = (route) => {
                const dc = distributionCenters.find(d => d.id === route.dcId);
                if (!dc) return;

                // Calculate current route metrics
                const currentMetrics = calculateRouteMetrics(route.stops, orders, dc.lat, dc.lng);
                
                // Optimize the route
                const optimized = optimizeRouteStops(route.stops, orders, dc.lat, dc.lng);
                
                // Calculate optimized metrics
                const optimizedMetrics = calculateRouteMetrics(optimized.stops, orders, dc.lat, dc.lng);
                
                // Calculate savings
                const distanceSaved = currentMetrics.totalDistance - optimizedMetrics.totalDistance;
                const timeSaved = currentMetrics.totalTime - optimizedMetrics.totalTime;
                
                setOptimizingRoute(route);
                setOptimizationResult({
                    original: {
                        stops: route.stops,
                        distance: currentMetrics.totalDistance,
                        time: currentMetrics.totalTime
                    },
                    optimized: {
                        stops: optimized.stops,
                        distance: optimizedMetrics.totalDistance,
                        time: optimizedMetrics.totalTime
                    },
                    savings: {
                        distance: Math.max(0, distanceSaved),
                        time: Math.max(0, timeSaved),
                        fuelCost: Math.max(0, (distanceSaved / 6.5) * fuelPrice).toFixed(2) // Assuming 6.5 MPG
                    }
                });
            };

            const applyOptimization = () => {
                if (!optimizingRoute || !optimizationResult) return;
                alert(`Route ${optimizingRoute.id} optimized!\n\nSavings:\n‚Ä¢ ${optimizationResult.savings.distance} miles less\n‚Ä¢ ${optimizationResult.savings.time} minutes faster\n‚Ä¢ $${optimizationResult.savings.fuelCost} fuel saved\n\nIn production, this would update the route in the database.`);
                setOptimizingRoute(null);
                setOptimizationResult(null);
            };

            const getAvailableCustomers = () => {
                if (!managingRoute) return customers || [];
                // Only show customers assigned to the same DC as the route
                const routeDC = managingRoute.dcId;
                const dcCustomers = (customers || []).filter(c => c.preferredDC === routeDC);
                const existingCustomerIds = managingRoute.stops?.map(s => {
                    const order = orders.find(o => o.id === s.orderId);
                    return order?.customerId;
                }) || [];
                return dcCustomers.filter(c => !existingCustomerIds.includes(c.id));
            };

            const handleAddStop = () => {
                if (!newStop.customerId) return;
                const customer = customers.find(c => c.id === newStop.customerId);
                if (!customer) return;
                
                alert(`Stop added to route ${managingRoute.id}:\n\nCustomer: ${customer.name}\nAddress: ${customer.address}\nTime: ${newStop.estimatedTime || 'TBD'}\n\nIn production, this would update the route in the database.`);
                setShowAddStopModal(false);
                setNewStop({ customerId: '', address: '', estimatedTime: '', notes: '' });
            };

            const handleRemoveStop = (stopIndex) => {
                const stop = managingRoute.stops[stopIndex];
                const order = orders.find(o => o.id === stop.orderId);
                if (confirm(`Remove stop #${stopIndex + 1} (${order?.customer || 'Unknown'}) from this route?`)) {
                    alert(`Stop removed from route ${managingRoute.id}.\n\nIn production, this would update the route in the database.`);
                }
            };

            const handleReorderStop = (stopIndex, direction) => {
                alert(`Stop reordered ${direction}.\n\nIn production, this would update the stop sequence in the database.`);
            };

            return (
                <>
                    <div className="card">
                        <div className="card-header">
                            <h2 className="card-title">üó∫Ô∏è Route Management</h2>
                            <div style={{ display: 'flex', gap: '1rem', alignItems: 'center', flexWrap: 'wrap' }}>
                                <div style={{ display: 'flex', alignItems: 'center', gap: '0.5rem' }}>
                                    <label style={{ fontSize: '0.9rem', color: 'var(--text-secondary)' }}>
                                        ‚õΩ Fuel Price:
                                    </label>
                                    <input 
                                        type="number"
                                        step="0.01"
                                        value={fuelPrice}
                                        onChange={(e) => setFuelPrice(parseFloat(e.target.value))}
                                        style={{
                                            width: '80px',
                                            padding: '0.5rem',
                                            background: 'var(--bg-dark)',
                                            border: '2px solid var(--border)',
                                            borderRadius: '8px',
                                            color: 'var(--text-primary)',
                                            fontFamily: "'JetBrains Mono', monospace",
                                            fontSize: '0.9rem'
                                        }}
                                    />
                                    <span style={{ fontSize: '0.9rem', color: 'var(--text-muted)' }}>/gal</span>
                                </div>
                                <button className="btn btn-primary" onClick={() => openModal('route')}>
                                    + Create Route
                                </button>
                            </div>
                        </div>
                        <div className="table-container">
                            <table className="table">
                                <thead>
                                    <tr>
                                        <th>Route ID</th>
                                        <th>Distribution Center</th>
                                        <th>Date</th>
                                        <th>Truck</th>
                                        <th>Driver</th>
                                        <th>Stops</th>
                                        <th>Distance</th>
                                        <th>Total Cost</th>
                                        <th>Revenue</th>
                                        <th>Profit</th>
                                        <th>Status</th>
                                        <th>Actions</th>
                                    </tr>
                                </thead>
                                <tbody>
                                    {routes.map(route => {
                                        const truck = trucks.find(t => t.id === route.truckId);
                                        const driver = drivers.find(d => d.id === route.driverId);
                                        const dc = distributionCenters.find(d => d.id === route.dcId);
                                        const costs = truck && driver ? calculateRouteCosts(route, truck, driver) : null;
                                        
                                        return (
                                            <tr key={route.id}>
                                                <td><strong>{route.id}</strong></td>
                                                <td>{dc?.name || 'N/A'}<br/><span style={{fontSize: '0.8rem', color: 'var(--text-muted)'}}>{dc?.city}, {dc?.state}</span></td>
                                                <td>{route.date}</td>
                                                <td>{truck?.name}</td>
                                                <td>{driver?.name}</td>
                                                <td>{route.stops.length}</td>
                                                <td>{route.totalDistance} mi</td>
                                                <td style={{ fontFamily: "'JetBrains Mono', monospace", fontWeight: '700', color: 'var(--danger)' }}>
                                                    ${costs?.totalCost || '0.00'}
                                                </td>
                                                <td style={{ fontFamily: "'JetBrains Mono', monospace", fontWeight: '700', color: 'var(--success)' }}>
                                                    ${costs?.revenue || '0.00'}
                                                </td>
                                                <td style={{ 
                                                    fontFamily: "'JetBrains Mono', monospace", 
                                                    fontWeight: '700',
                                                    color: (costs?.profit || 0) > 0 ? 'var(--success)' : 'var(--danger)' 
                                                }}>
                                                    ${costs?.profit || '0.00'}
                                                </td>
                                                <td>
                                                    <span className={`badge badge-${
                                                        route.status === 'completed' ? 'success' :
                                                        route.status === 'in-progress' ? 'info' : 'warning'
                                                    }`}>
                                                        {route.status}
                                                    </span>
                                                </td>
                                                <td>
                                                    <div style={{ display: 'flex', gap: '0.5rem', flexWrap: 'wrap' }}>
                                                        <button 
                                                            className="btn btn-sm btn-primary"
                                                            onClick={() => setManagingRoute(route)}
                                                        >
                                                            Manage
                                                        </button>
                                                        <button 
                                                            className="btn btn-sm btn-secondary"
                                                            onClick={() => setSelectedRoute(route)}
                                                        >
                                                            View
                                                        </button>
                                                        {route.status !== 'completed' && (
                                                            <button 
                                                                className="btn btn-sm"
                                                                style={{ background: 'linear-gradient(135deg, #06D6A0 0%, #05B589 100%)' }}
                                                                onClick={() => handleOptimizeRoute(route)}
                                                                title="Optimize route for minimum mileage and time"
                                                            >
                                                                ‚ö° Optimize
                                                            </button>
                                                        )}
                                                    </div>
                                                </td>
                                            </tr>
                                        );
                                    })}
                                </tbody>
                            </table>
                        </div>
                    </div>

                    {selectedRoute && (() => {
                        const truck = trucks.find(t => t.id === selectedRoute.truckId);
                        const driver = drivers.find(d => d.id === selectedRoute.driverId);
                        const dc = distributionCenters.find(d => d.id === selectedRoute.dcId);
                        const costs = truck && driver ? calculateRouteCosts(selectedRoute, truck, driver) : null;
                        
                        return (
                            <div className="card">
                                <div className="card-header">
                                    <h2 className="card-title">üìç Route Details - {selectedRoute.id}</h2>
                                    <button className="btn btn-secondary" onClick={() => setSelectedRoute(null)}>
                                        Close
                                    </button>
                                </div>

                                {costs && (
                                    <div style={{ marginBottom: '2rem' }}>
                                        <h3 style={{ fontSize: '1.2rem', fontWeight: '700', marginBottom: '1rem', color: 'var(--primary)' }}>
                                            üí∞ Cost Breakdown & Profitability
                                        </h3>
                                        <div style={{ display: 'grid', gridTemplateColumns: 'repeat(auto-fit, minmax(200px, 1fr))', gap: '1rem' }}>
                                            <div style={{ 
                                                padding: '1rem', 
                                                background: 'var(--bg-dark)', 
                                                borderRadius: '12px', 
                                                border: '2px solid var(--border)' 
                                            }}>
                                                <div style={{ fontSize: '0.85rem', color: 'var(--text-muted)', marginBottom: '0.5rem' }}>
                                                    ‚õΩ Fuel Cost
                                                </div>
                                                <div style={{ fontSize: '1.5rem', fontWeight: '800', fontFamily: "'JetBrains Mono', monospace", color: 'var(--warning)' }}>
                                                    ${costs.fuelCost}
                                                </div>
                                                <div style={{ fontSize: '0.75rem', color: 'var(--text-muted)', marginTop: '0.25rem' }}>
                                                    {selectedRoute.totalDistance} mi √∑ {truck.fuelMPG} MPG √ó ${fuelPrice}/gal
                                                </div>
                                            </div>

                                            <div style={{ 
                                                padding: '1rem', 
                                                background: 'var(--bg-dark)', 
                                                borderRadius: '12px', 
                                                border: '2px solid var(--border)' 
                                            }}>
                                                <div style={{ fontSize: '0.85rem', color: 'var(--text-muted)', marginBottom: '0.5rem' }}>
                                                    üë®‚Äç‚úàÔ∏è Driver Cost
                                                </div>
                                                <div style={{ fontSize: '1.5rem', fontWeight: '800', fontFamily: "'JetBrains Mono', monospace", color: 'var(--secondary)' }}>
                                                    ${costs.driverCost}
                                                </div>
                                                <div style={{ fontSize: '0.75rem', color: 'var(--text-muted)', marginTop: '0.25rem' }}>
                                                    {(selectedRoute.totalDuration / 60).toFixed(2)} hrs √ó ${driver.hourlyRate}/hr
                                                </div>
                                            </div>

                                            <div style={{ 
                                                padding: '1rem', 
                                                background: 'var(--bg-dark)', 
                                                borderRadius: '12px', 
                                                border: '2px solid var(--border)' 
                                            }}>
                                                <div style={{ fontSize: '0.85rem', color: 'var(--text-muted)', marginBottom: '0.5rem' }}>
                                                    üîß Maintenance Cost
                                                </div>
                                                <div style={{ fontSize: '1.5rem', fontWeight: '800', fontFamily: "'JetBrains Mono', monospace", color: 'var(--text-muted)' }}>
                                                    ${costs.maintenanceCost}
                                                </div>
                                                <div style={{ fontSize: '0.75rem', color: 'var(--text-muted)', marginTop: '0.25rem' }}>
                                                    {selectedRoute.totalDistance} mi √ó ${truck.maintenanceCostPerMile}/mi
                                                </div>
                                            </div>

                                            <div style={{ 
                                                padding: '1rem', 
                                                background: 'var(--bg-dark)', 
                                                borderRadius: '12px', 
                                                border: '2px solid var(--border)' 
                                            }}>
                                                <div style={{ fontSize: '0.85rem', color: 'var(--text-muted)', marginBottom: '0.5rem' }}>
                                                    üõ°Ô∏è Insurance Cost
                                                </div>
                                                <div style={{ fontSize: '1.5rem', fontWeight: '800', fontFamily: "'JetBrains Mono', monospace", color: 'var(--text-secondary)' }}>
                                                    ${costs.insuranceCost}
                                                </div>
                                                <div style={{ fontSize: '0.75rem', color: 'var(--text-muted)', marginTop: '0.25rem' }}>
                                                    ${truck.insuranceCostPerDay}/day pro-rated
                                                </div>
                                            </div>

                                            <div style={{ 
                                                padding: '1rem', 
                                                background: 'var(--bg-dark)', 
                                                borderRadius: '12px', 
                                                border: '2px solid var(--danger)' 
                                            }}>
                                                <div style={{ fontSize: '0.85rem', color: 'var(--text-muted)', marginBottom: '0.5rem' }}>
                                                    üí∏ Total Cost
                                                </div>
                                                <div style={{ fontSize: '1.8rem', fontWeight: '800', fontFamily: "'JetBrains Mono', monospace", color: 'var(--danger)' }}>
                                                    ${costs.totalCost}
                                                </div>
                                            </div>

                                            <div style={{ 
                                                padding: '1rem', 
                                                background: 'var(--bg-dark)', 
                                                borderRadius: '12px', 
                                                border: '2px solid var(--success)' 
                                            }}>
                                                <div style={{ fontSize: '0.85rem', color: 'var(--text-muted)', marginBottom: '0.5rem' }}>
                                                    üíµ Revenue
                                                </div>
                                                <div style={{ fontSize: '1.8rem', fontWeight: '800', fontFamily: "'JetBrains Mono', monospace", color: 'var(--success)' }}>
                                                    ${costs.revenue}
                                                </div>
                                            </div>

                                            <div style={{ 
                                                padding: '1rem', 
                                                background: costs.profit > 0 ? 'rgba(6, 214, 160, 0.1)' : 'rgba(239, 71, 111, 0.1)', 
                                                borderRadius: '12px', 
                                                border: `2px solid ${costs.profit > 0 ? 'var(--success)' : 'var(--danger)'}` 
                                            }}>
                                                <div style={{ fontSize: '0.85rem', color: 'var(--text-muted)', marginBottom: '0.5rem' }}>
                                                    üìä Net Profit
                                                </div>
                                                <div style={{ 
                                                    fontSize: '2rem', 
                                                    fontWeight: '800', 
                                                    fontFamily: "'JetBrains Mono', monospace", 
                                                    color: costs.profit > 0 ? 'var(--success)' : 'var(--danger)' 
                                                }}>
                                                    ${costs.profit}
                                                </div>
                                                <div style={{ fontSize: '0.9rem', fontWeight: '700', marginTop: '0.25rem' }}>
                                                    Margin: {costs.profitMargin}%
                                                </div>
                                            </div>

                                            <div style={{ 
                                                padding: '1rem', 
                                                background: 'var(--bg-dark)', 
                                                borderRadius: '12px', 
                                                border: '2px solid var(--border)' 
                                            }}>
                                                <div style={{ fontSize: '0.85rem', color: 'var(--text-muted)', marginBottom: '0.5rem' }}>
                                                    üìè Cost per Mile
                                                </div>
                                                <div style={{ fontSize: '1.5rem', fontWeight: '800', fontFamily: "'JetBrains Mono', monospace", color: 'var(--accent)' }}>
                                                    ${(costs.totalCost / selectedRoute.totalDistance).toFixed(2)}
                                                </div>
                                                <div style={{ fontSize: '0.75rem', color: 'var(--text-muted)', marginTop: '0.25rem' }}>
                                                    per mile traveled
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                )}

                                {/* Truck Load Tracking Section */}
                                {selectedRoute.initialLoad && (
                                    <div style={{ marginBottom: '2rem' }}>
                                        <h3 style={{ fontSize: '1.2rem', fontWeight: '700', marginBottom: '1rem', color: 'var(--warning)' }}>
                                            üöõ Truck Load Tracking
                                        </h3>
                                        
                                        {/* Load Summary Cards */}
                                        <div style={{ display: 'grid', gridTemplateColumns: 'repeat(auto-fit, minmax(200px, 1fr))', gap: '1rem', marginBottom: '1.5rem' }}>
                                            {(() => {
                                                // Calculate total weights
                                                const productUnitSpecs = {
                                                    'SKU-20': { fullWeight: 37, emptyWeight: 17, units: 4.7 },
                                                    'SKU-30': { fullWeight: 55, emptyWeight: 25, units: 7.1 },
                                                    'SKU-33': { fullWeight: 61, emptyWeight: 28, units: 7.8 },
                                                    'SKU-40': { fullWeight: 72, emptyWeight: 32, units: 9.4 },
                                                    'SKU-100': { fullWeight: 167, emptyWeight: 67, units: 23.6 },
                                                    'SKU-420': { fullWeight: 705, emptyWeight: 285, units: 100 }
                                                };
                                                
                                                let initialWeight = 0, currentWeight = 0, initialUnits = 0, currentUnits = 0;
                                                let totalDelivered = 0, totalEmpties = 0;
                                                
                                                Object.entries(selectedRoute.initialLoad || {}).forEach(([cyl, count]) => {
                                                    if (productUnitSpecs[cyl]) {
                                                        initialWeight += count * productUnitSpecs[cyl].fullWeight;
                                                        initialUnits += count * productUnitSpecs[cyl].units;
                                                    }
                                                });
                                                
                                                Object.entries(selectedRoute.currentLoad || {}).forEach(([cyl, count]) => {
                                                    if (productUnitSpecs[cyl]) {
                                                        currentWeight += count * productUnitSpecs[cyl].fullWeight;
                                                        currentUnits += count * productUnitSpecs[cyl].units;
                                                    }
                                                });
                                                
                                                Object.entries(selectedRoute.emptyPickups || {}).forEach(([cyl, count]) => {
                                                    if (productUnitSpecs[cyl]) {
                                                        currentWeight += count * productUnitSpecs[cyl].emptyWeight;
                                                        totalEmpties += count;
                                                    }
                                                });
                                                
                                                Object.entries(selectedRoute.initialLoad || {}).forEach(([cyl, count]) => {
                                                    const current = selectedRoute.currentLoad?.[cyl] || 0;
                                                    totalDelivered += (count - current);
                                                });
                                                
                                                const deliveredUnits = initialUnits - currentUnits;
                                                const truckCapacity = truck?.capacity || 14000;
                                                const loadPercent = ((currentWeight / truckCapacity) * 100).toFixed(1);
                                                
                                                return (
                                                    <>
                                                        <div style={{ padding: '1rem', background: 'var(--bg-dark)', borderRadius: '12px', border: '2px solid var(--border)' }}>
                                                            <div style={{ color: 'var(--text-muted)', fontSize: '0.85rem', marginBottom: '0.5rem' }}>Initial Load Weight</div>
                                                            <div style={{ fontSize: '1.5rem', fontWeight: '800', fontFamily: "'JetBrains Mono', monospace", color: 'var(--primary)' }}>
                                                                {initialWeight.toLocaleString()} lbs
                                                            </div>
                                                            <div style={{ fontSize: '0.75rem', color: 'var(--text-muted)' }}>{initialUnits.toFixed(1)} units</div>
                                                        </div>
                                                        <div style={{ padding: '1rem', background: 'var(--bg-dark)', borderRadius: '12px', border: '2px solid var(--success)' }}>
                                                            <div style={{ color: 'var(--text-muted)', fontSize: '0.85rem', marginBottom: '0.5rem' }}>Current Load Weight</div>
                                                            <div style={{ fontSize: '1.5rem', fontWeight: '800', fontFamily: "'JetBrains Mono', monospace", color: 'var(--success)' }}>
                                                                {currentWeight.toLocaleString()} lbs
                                                            </div>
                                                            <div style={{ fontSize: '0.75rem', color: 'var(--text-muted)' }}>{loadPercent}% capacity</div>
                                                        </div>
                                                        <div style={{ padding: '1rem', background: 'var(--bg-dark)', borderRadius: '12px', border: '2px solid var(--accent)' }}>
                                                            <div style={{ color: 'var(--text-muted)', fontSize: '0.85rem', marginBottom: '0.5rem' }}>Product Units Delivered</div>
                                                            <div style={{ fontSize: '1.5rem', fontWeight: '800', fontFamily: "'JetBrains Mono', monospace", color: 'var(--accent)' }}>
                                                                {totalDelivered}
                                                            </div>
                                                            <div style={{ fontSize: '0.75rem', color: 'var(--text-muted)' }}>{deliveredUnits.toFixed(1)} units distributed</div>
                                                        </div>
                                                        <div style={{ padding: '1rem', background: 'var(--bg-dark)', borderRadius: '12px', border: '2px solid var(--warning)' }}>
                                                            <div style={{ color: 'var(--text-muted)', fontSize: '0.85rem', marginBottom: '0.5rem' }}>Empties Collected</div>
                                                            <div style={{ fontSize: '1.5rem', fontWeight: '800', fontFamily: "'JetBrains Mono', monospace", color: 'var(--warning)' }}>
                                                                {totalEmpties}
                                                            </div>
                                                            <div style={{ fontSize: '0.75rem', color: 'var(--text-muted)' }}>For refilling at DC</div>
                                                        </div>
                                                    </>
                                                );
                                            })()}
                                        </div>

                                        {/* Product Unit Inventory Table */}
                                        <div className="table-container" style={{ marginBottom: '1rem' }}>
                                            <table className="table">
                                                <thead>
                                                    <tr>
                                                        <th>Product Unit Type</th>
                                                        <th>Initial Load</th>
                                                        <th>Current Load</th>
                                                        <th>Delivered</th>
                                                        <th>Empties Picked Up</th>
                                                        <th>Net Change</th>
                                                    </tr>
                                                </thead>
                                                <tbody>
                                                    {Object.keys(selectedRoute.initialLoad || {}).map(cylType => {
                                                        const initial = selectedRoute.initialLoad[cylType] || 0;
                                                        const current = selectedRoute.currentLoad?.[cylType] || 0;
                                                        const empties = selectedRoute.emptyPickups?.[cylType] || 0;
                                                        const delivered = initial - current;
                                                        const netChange = empties - delivered;
                                                        
                                                        return (
                                                            <tr key={cylType}>
                                                                <td><strong>{cylType}</strong></td>
                                                                <td style={{ fontFamily: "'JetBrains Mono', monospace" }}>{initial}</td>
                                                                <td style={{ fontFamily: "'JetBrains Mono', monospace", fontWeight: '700', color: 'var(--success)' }}>{current}</td>
                                                                <td style={{ fontFamily: "'JetBrains Mono', monospace", color: 'var(--accent)' }}>-{delivered}</td>
                                                                <td style={{ fontFamily: "'JetBrains Mono', monospace", color: 'var(--warning)' }}>+{empties}</td>
                                                                <td style={{ fontFamily: "'JetBrains Mono', monospace", fontWeight: '700', color: netChange >= 0 ? 'var(--success)' : 'var(--danger)' }}>
                                                                    {netChange >= 0 ? '+' : ''}{netChange}
                                                                </td>
                                                            </tr>
                                                        );
                                                    })}
                                                </tbody>
                                            </table>
                                        </div>
                                    </div>
                                )}

                                <h3 style={{ fontSize: '1.2rem', fontWeight: '700', marginBottom: '1rem', color: 'var(--primary)' }}>
                                    üìç Route Stops & Deliveries
                                </h3>
                                <div className="route-map">
                                    {selectedRoute.stops.map((stop, index) => {
                                        const order = orders.find(o => o.id === stop.orderId);
                                        const hasDeliveryData = stop.delivered && Object.keys(stop.delivered).length > 0;
                                        
                                        return (
                                            <div key={stop.orderId} style={{ 
                                                background: 'var(--bg-dark)', 
                                                borderRadius: '12px', 
                                                padding: '1.5rem',
                                                marginBottom: '1rem',
                                                border: `2px solid ${stop.status === 'completed' ? 'var(--success)' : 'var(--border)'}`
                                            }}>
                                                <div style={{ display: 'flex', justifyContent: 'space-between', alignItems: 'flex-start', marginBottom: '1rem' }}>
                                                    <div style={{ display: 'flex', alignItems: 'center', gap: '1rem' }}>
                                                        <div style={{
                                                            width: '40px',
                                                            height: '40px',
                                                            borderRadius: '50%',
                                                            background: stop.status === 'completed' ? 'var(--success)' : 'var(--primary)',
                                                            display: 'flex',
                                                            alignItems: 'center',
                                                            justifyContent: 'center',
                                                            fontWeight: '800',
                                                            fontSize: '1.2rem'
                                                        }}>
                                                            {stop.status === 'completed' ? '‚úì' : stop.sequence}
                                                        </div>
                                                        <div>
                                                            <div style={{ fontWeight: '700', fontSize: '1.1rem' }}>{order?.customer}</div>
                                                            <div style={{ color: 'var(--text-muted)', fontSize: '0.9rem' }}>{order?.address}</div>
                                                        </div>
                                                    </div>
                                                    <span className={`badge badge-${stop.status === 'completed' ? 'success' : stop.status === 'in-progress' ? 'info' : 'warning'}`}>
                                                        {stop.status || 'pending'}
                                                    </span>
                                                </div>
                                                
                                                <div style={{ display: 'grid', gridTemplateColumns: 'repeat(auto-fit, minmax(150px, 1fr))', gap: '1rem', marginBottom: hasDeliveryData ? '1rem' : '0' }}>
                                                    <div>
                                                        <div style={{ fontSize: '0.75rem', color: 'var(--text-muted)', textTransform: 'uppercase' }}>Scheduled</div>
                                                        <div style={{ fontFamily: "'JetBrains Mono', monospace" }}>{stop.estimatedTime}</div>
                                                    </div>
                                                    {stop.actualTime && (
                                                        <div>
                                                            <div style={{ fontSize: '0.75rem', color: 'var(--text-muted)', textTransform: 'uppercase' }}>Actual</div>
                                                            <div style={{ fontFamily: "'JetBrains Mono', monospace", color: 'var(--success)' }}>{stop.actualTime}</div>
                                                        </div>
                                                    )}
                                                    <div>
                                                        <div style={{ fontSize: '0.75rem', color: 'var(--text-muted)', textTransform: 'uppercase' }}>Duration</div>
                                                        <div>{stop.duration} min</div>
                                                    </div>
                                                    <div>
                                                        <div style={{ fontSize: '0.75rem', color: 'var(--text-muted)', textTransform: 'uppercase' }}>Distance</div>
                                                        <div>{stop.distance} mi</div>
                                                    </div>
                                                    {stop.signature && (
                                                        <div>
                                                            <div style={{ fontSize: '0.75rem', color: 'var(--text-muted)', textTransform: 'uppercase' }}>Signed By</div>
                                                            <div style={{ fontStyle: 'italic' }}>{stop.signature}</div>
                                                        </div>
                                                    )}
                                                </div>

                                                {hasDeliveryData && (
                                                    <div style={{ background: 'var(--bg-card)', padding: '1rem', borderRadius: '8px', marginTop: '1rem' }}>
                                                        <div style={{ display: 'grid', gridTemplateColumns: '1fr 1fr', gap: '1rem' }}>
                                                            <div>
                                                                <div style={{ fontWeight: '700', color: 'var(--accent)', marginBottom: '0.5rem', fontSize: '0.9rem' }}>üì¶ Delivered</div>
                                                                <div style={{ display: 'flex', flexWrap: 'wrap', gap: '0.5rem' }}>
                                                                    {Object.entries(stop.delivered || {}).map(([cyl, count]) => (
                                                                        <span key={cyl} style={{
                                                                            background: 'var(--bg-dark)',
                                                                            padding: '0.25rem 0.5rem',
                                                                            borderRadius: '4px',
                                                                            fontSize: '0.8rem',
                                                                            fontFamily: "'JetBrains Mono', monospace"
                                                                        }}>
                                                                            {cyl}: <strong style={{ color: 'var(--accent)' }}>{count}</strong>
                                                                        </span>
                                                                    ))}
                                                                </div>
                                                            </div>
                                                            <div>
                                                                <div style={{ fontWeight: '700', color: 'var(--warning)', marginBottom: '0.5rem', fontSize: '0.9rem' }}>‚ôªÔ∏è Empties Collected</div>
                                                                <div style={{ display: 'flex', flexWrap: 'wrap', gap: '0.5rem' }}>
                                                                    {Object.entries(stop.emptiesCollected || {}).map(([cyl, count]) => (
                                                                        <span key={cyl} style={{
                                                                            background: 'var(--bg-dark)',
                                                                            padding: '0.25rem 0.5rem',
                                                                            borderRadius: '4px',
                                                                            fontSize: '0.8rem',
                                                                            fontFamily: "'JetBrains Mono', monospace"
                                                                        }}>
                                                                            {cyl}: <strong style={{ color: 'var(--warning)' }}>{count}</strong>
                                                                        </span>
                                                                    ))}
                                                                </div>
                                                            </div>
                                                        </div>
                                                        {stop.notes && (
                                                            <div style={{ marginTop: '0.75rem', fontSize: '0.85rem', color: 'var(--text-muted)', fontStyle: 'italic' }}>
                                                                üìù {stop.notes}
                                                            </div>
                                                        )}
                                                    </div>
                                                )}
                                            </div>
                                        );
                                    })}
                                </div>
                            </div>
                        );
                    })()}

                    {/* Manage Route Modal */}
                    {managingRoute && (
                        <div className="modal-overlay" onClick={() => setManagingRoute(null)}>
                            <div className="modal" onClick={(e) => e.stopPropagation()} style={{ maxWidth: '900px', maxHeight: '90vh', overflow: 'auto' }}>
                                <div className="modal-header">
                                    <h2 className="modal-title">üó∫Ô∏è Manage Route - {managingRoute.id}</h2>
                                    <button className="modal-close" onClick={() => setManagingRoute(null)}>√ó</button>
                                </div>
                                
                                <div style={{ padding: '1rem 0' }}>
                                    {/* Route Summary */}
                                    <div style={{ display: 'grid', gridTemplateColumns: 'repeat(auto-fit, minmax(150px, 1fr))', gap: '1rem', marginBottom: '1.5rem' }}>
                                        <div style={{ background: 'var(--bg-dark)', padding: '1rem', borderRadius: '8px' }}>
                                            <div style={{ fontSize: '0.8rem', color: 'var(--text-muted)', marginBottom: '0.25rem' }}>Date</div>
                                            <div style={{ fontWeight: '700' }}>{managingRoute.date}</div>
                                        </div>
                                        <div style={{ background: 'var(--bg-dark)', padding: '1rem', borderRadius: '8px' }}>
                                            <div style={{ fontSize: '0.8rem', color: 'var(--text-muted)', marginBottom: '0.25rem' }}>Truck</div>
                                            <div style={{ fontWeight: '700' }}>{trucks.find(t => t.id === managingRoute.truckId)?.name || 'N/A'}</div>
                                        </div>
                                        <div style={{ background: 'var(--bg-dark)', padding: '1rem', borderRadius: '8px' }}>
                                            <div style={{ fontSize: '0.8rem', color: 'var(--text-muted)', marginBottom: '0.25rem' }}>Driver</div>
                                            <div style={{ fontWeight: '700' }}>{drivers.find(d => d.id === managingRoute.driverId)?.name || 'N/A'}</div>
                                        </div>
                                        <div style={{ background: 'var(--bg-dark)', padding: '1rem', borderRadius: '8px' }}>
                                            <div style={{ fontSize: '0.8rem', color: 'var(--text-muted)', marginBottom: '0.25rem' }}>Status</div>
                                            <span className={`badge badge-${managingRoute.status === 'completed' ? 'success' : managingRoute.status === 'in-progress' ? 'info' : 'warning'}`}>
                                                {managingRoute.status}
                                            </span>
                                        </div>
                                        <div style={{ background: 'var(--bg-dark)', padding: '1rem', borderRadius: '8px' }}>
                                            <div style={{ fontSize: '0.8rem', color: 'var(--text-muted)', marginBottom: '0.25rem' }}>Total Stops</div>
                                            <div style={{ fontWeight: '700', fontSize: '1.5rem', color: 'var(--primary)' }}>{managingRoute.stops?.length || 0}</div>
                                        </div>
                                        <div style={{ background: 'var(--bg-dark)', padding: '1rem', borderRadius: '8px' }}>
                                            <div style={{ fontSize: '0.8rem', color: 'var(--text-muted)', marginBottom: '0.25rem' }}>Total Distance</div>
                                            <div style={{ fontWeight: '700', fontSize: '1.5rem', color: 'var(--accent)' }}>{managingRoute.totalDistance} mi</div>
                                        </div>
                                    </div>

                                    {/* Stops List */}
                                    <div style={{ display: 'flex', justifyContent: 'space-between', alignItems: 'center', marginBottom: '1rem' }}>
                                        <h3 style={{ fontSize: '1.1rem', fontWeight: '700', margin: 0 }}>üìç Route Stops ({managingRoute.stops?.length || 0})</h3>
                                        <button 
                                            className="btn btn-primary btn-sm"
                                            onClick={() => setShowAddStopModal(true)}
                                            disabled={managingRoute.status === 'completed'}
                                        >
                                            + Add Stop
                                        </button>
                                    </div>

                                    {managingRoute.stops?.length > 0 ? (
                                        <div style={{ display: 'grid', gap: '0.75rem' }}>
                                            {managingRoute.stops.map((stop, index) => {
                                                const order = orders.find(o => o.id === stop.orderId);
                                                const customer = order ? (customers || []).find(c => c.id === order.customerId) : null;
                                                
                                                return (
                                                    <div 
                                                        key={index}
                                                        style={{ 
                                                            background: 'var(--bg-dark)', 
                                                            borderRadius: '12px', 
                                                            padding: '1rem',
                                                            border: `2px solid ${stop.status === 'completed' ? 'var(--success)' : 'var(--border)'}`,
                                                            display: 'flex',
                                                            alignItems: 'center',
                                                            gap: '1rem'
                                                        }}
                                                    >
                                                        {/* Sequence Number */}
                                                        <div style={{
                                                            width: '40px',
                                                            height: '40px',
                                                            borderRadius: '50%',
                                                            background: stop.status === 'completed' ? 'var(--success)' : 'var(--primary)',
                                                            display: 'flex',
                                                            alignItems: 'center',
                                                            justifyContent: 'center',
                                                            fontWeight: '800',
                                                            fontSize: '1.1rem',
                                                            flexShrink: 0
                                                        }}>
                                                            {stop.status === 'completed' ? '‚úì' : stop.sequence}
                                                        </div>

                                                        {/* Stop Details */}
                                                        <div style={{ flex: 1, minWidth: 0 }}>
                                                            <div style={{ fontWeight: '700', marginBottom: '0.25rem' }}>
                                                                {order?.customer || 'Unknown Customer'}
                                                            </div>
                                                            <div style={{ fontSize: '0.85rem', color: 'var(--text-muted)', marginBottom: '0.5rem' }}>
                                                                {order?.address || 'No address'}
                                                            </div>
                                                            <div style={{ display: 'flex', gap: '1rem', flexWrap: 'wrap', fontSize: '0.8rem' }}>
                                                                <span>üïê {stop.estimatedTime}</span>
                                                                <span>üìè {stop.distance} mi</span>
                                                                <span>‚è±Ô∏è {stop.duration} min</span>
                                                                {order?.volume && <span style={{ color: 'var(--accent)' }}>‚õΩ {order.volume} units</span>}
                                                            </div>
                                                        </div>

                                                        {/* Reorder & Remove Buttons */}
                                                        <div style={{ display: 'flex', gap: '0.5rem', flexShrink: 0 }}>
                                                            {managingRoute.status !== 'completed' && (
                                                                <>
                                                                    <button 
                                                                        className="btn btn-sm btn-secondary"
                                                                        onClick={() => handleReorderStop(index, 'up')}
                                                                        disabled={index === 0}
                                                                        style={{ padding: '0.25rem 0.5rem' }}
                                                                    >
                                                                        ‚Üë
                                                                    </button>
                                                                    <button 
                                                                        className="btn btn-sm btn-secondary"
                                                                        onClick={() => handleReorderStop(index, 'down')}
                                                                        disabled={index === managingRoute.stops.length - 1}
                                                                        style={{ padding: '0.25rem 0.5rem' }}
                                                                    >
                                                                        ‚Üì
                                                                    </button>
                                                                    <button 
                                                                        className="btn btn-sm btn-danger"
                                                                        onClick={() => handleRemoveStop(index)}
                                                                        style={{ padding: '0.25rem 0.5rem' }}
                                                                    >
                                                                        ‚úï
                                                                    </button>
                                                                </>
                                                            )}
                                                            <span className={`badge badge-${stop.status === 'completed' ? 'success' : 'warning'}`} style={{ alignSelf: 'center' }}>
                                                                {stop.status || 'pending'}
                                                            </span>
                                                        </div>
                                                    </div>
                                                );
                                            })}
                                        </div>
                                    ) : (
                                        <div style={{ textAlign: 'center', padding: '2rem', background: 'var(--bg-dark)', borderRadius: '12px', color: 'var(--text-muted)' }}>
                                            No stops added to this route yet. Click "Add Stop" to add customers.
                                        </div>
                                    )}

                                    {/* Route Actions */}
                                    <div style={{ display: 'flex', gap: '1rem', marginTop: '1.5rem', paddingTop: '1.5rem', borderTop: '2px solid var(--border)' }}>
                                        <button 
                                            className="btn btn-secondary"
                                            onClick={() => alert('Optimize route for shortest distance.\n\nIn production, this would use Google Maps API to reorder stops optimally.')}
                                        >
                                            üîÑ Optimize Route
                                        </button>
                                        <button 
                                            className="btn btn-secondary"
                                            onClick={() => alert('Route directions would open in Google Maps.')}
                                        >
                                            üó∫Ô∏è Get Directions
                                        </button>
                                        <button 
                                            className="btn btn-secondary"
                                            onClick={() => alert('Route manifest PDF would be generated.')}
                                        >
                                            üìÑ Print Manifest
                                        </button>
                                        {managingRoute.status === 'pending' && (
                                            <button className="btn btn-success">
                                                ‚ñ∂Ô∏è Start Route
                                            </button>
                                        )}
                                        {managingRoute.status === 'in-progress' && (
                                            <button className="btn btn-success">
                                                ‚úì Complete Route
                                            </button>
                                        )}
                                    </div>
                                </div>

                                <div className="modal-footer">
                                    <button className="btn btn-secondary" onClick={() => setManagingRoute(null)}>
                                        Close
                                    </button>
                                    <button className="btn btn-primary" onClick={() => {
                                        alert('Route changes saved!');
                                        setManagingRoute(null);
                                    }}>
                                        Save Changes
                                    </button>
                                </div>
                            </div>
                        </div>
                    )}

                    {/* Add Stop Modal */}
                    {showAddStopModal && managingRoute && (
                        <div className="modal-overlay" onClick={() => setShowAddStopModal(false)} style={{ zIndex: 1001 }}>
                            <div className="modal" onClick={(e) => e.stopPropagation()} style={{ maxWidth: '500px' }}>
                                <div className="modal-header">
                                    <h2 className="modal-title">‚ûï Add Stop to Route</h2>
                                    <button className="modal-close" onClick={() => setShowAddStopModal(false)}>√ó</button>
                                </div>
                                
                                <div style={{ padding: '1rem 0' }}>
                                    <div className="form-group">
                                        <label className="form-label">Select Customer *</label>
                                        <select 
                                            className="form-select"
                                            value={newStop.customerId}
                                            onChange={(e) => {
                                                const cust = (customers || []).find(c => c.id === e.target.value);
                                                setNewStop(prev => ({ 
                                                    ...prev, 
                                                    customerId: e.target.value,
                                                    address: cust?.address || ''
                                                }));
                                            }}
                                        >
                                            <option value="">-- Select Customer --</option>
                                            {getAvailableCustomers().map(customer => (
                                                <option key={customer.id} value={customer.id}>
                                                    {customer.name} - {customer.city}, {customer.state}
                                                </option>
                                            ))}
                                        </select>
                                    </div>

                                    {newStop.customerId && (
                                        <>
                                            <div className="form-group">
                                                <label className="form-label">Delivery Address</label>
                                                <input 
                                                    type="text"
                                                    className="form-input"
                                                    value={newStop.address}
                                                    onChange={(e) => setNewStop(prev => ({ ...prev, address: e.target.value }))}
                                                    placeholder="Address will be auto-filled from customer"
                                                />
                                            </div>

                                            <div className="form-row">
                                                <div className="form-group">
                                                    <label className="form-label">Estimated Arrival Time</label>
                                                    <input 
                                                        type="time"
                                                        className="form-input"
                                                        value={newStop.estimatedTime}
                                                        onChange={(e) => setNewStop(prev => ({ ...prev, estimatedTime: e.target.value }))}
                                                    />
                                                </div>
                                                <div className="form-group">
                                                    <label className="form-label">Est. Duration (min)</label>
                                                    <input 
                                                        type="number"
                                                        className="form-input"
                                                        value={newStop.duration || ''}
                                                        onChange={(e) => setNewStop(prev => ({ ...prev, duration: e.target.value }))}
                                                        placeholder="30"
                                                    />
                                                </div>
                                            </div>

                                            <div className="form-group">
                                                <label className="form-label">Delivery Notes</label>
                                                <textarea 
                                                    className="form-input"
                                                    rows="2"
                                                    value={newStop.notes}
                                                    onChange={(e) => setNewStop(prev => ({ ...prev, notes: e.target.value }))}
                                                    placeholder="Special instructions, gate codes, contact info..."
                                                />
                                            </div>
                                        </>
                                    )}
                                </div>

                                <div className="modal-footer">
                                    <button className="btn btn-secondary" onClick={() => setShowAddStopModal(false)}>
                                        Cancel
                                    </button>
                                    <button 
                                        className="btn btn-primary" 
                                        onClick={handleAddStop}
                                        disabled={!newStop.customerId}
                                    >
                                        Add Stop
                                    </button>
                                </div>
                            </div>
                        </div>
                    )}

                    {/* Route Optimization Modal */}
                    {optimizingRoute && optimizationResult && (() => {
                        const dc = distributionCenters.find(d => d.id === optimizingRoute.dcId);
                        return (
                        <div className="modal-overlay" onClick={() => { setOptimizingRoute(null); setOptimizationResult(null); }}>
                            <div className="modal" onClick={(e) => e.stopPropagation()} style={{ maxWidth: '900px', maxHeight: '90vh', overflow: 'auto' }}>
                                <div className="modal-header">
                                    <div>
                                        <h2 className="modal-title">‚ö° Route Optimization - {optimizingRoute.id}</h2>
                                        <div style={{ fontSize: '0.85rem', color: 'var(--text-muted)', marginTop: '0.25rem' }}>
                                            Starting from: <strong style={{ color: 'var(--primary)' }}>{dc?.name}</strong> ({dc?.city}, {dc?.state})
                                        </div>
                                    </div>
                                    <button className="modal-close" onClick={() => { setOptimizingRoute(null); setOptimizationResult(null); }}>√ó</button>
                                </div>

                                {/* Savings Summary */}
                                <div style={{ 
                                    background: 'linear-gradient(135deg, rgba(6, 214, 160, 0.1) 0%, rgba(5, 181, 137, 0.1) 100%)',
                                    border: '2px solid var(--success)',
                                    borderRadius: '12px',
                                    padding: '1.5rem',
                                    marginBottom: '1.5rem'
                                }}>
                                    <h3 style={{ fontSize: '1.2rem', fontWeight: '700', marginBottom: '1rem', color: 'var(--success)', display: 'flex', alignItems: 'center', gap: '0.5rem' }}>
                                        üí∞ Optimization Savings
                                    </h3>
                                    <div style={{ display: 'grid', gridTemplateColumns: 'repeat(3, 1fr)', gap: '1rem' }}>
                                        <div style={{ textAlign: 'center', padding: '1rem', background: 'var(--bg-dark)', borderRadius: '8px' }}>
                                            <div style={{ fontSize: '2rem', fontWeight: '800', color: 'var(--success)', fontFamily: "'JetBrains Mono', monospace" }}>
                                                {optimizationResult.savings.distance} mi
                                            </div>
                                            <div style={{ fontSize: '0.85rem', color: 'var(--text-muted)' }}>Miles Saved</div>
                                        </div>
                                        <div style={{ textAlign: 'center', padding: '1rem', background: 'var(--bg-dark)', borderRadius: '8px' }}>
                                            <div style={{ fontSize: '2rem', fontWeight: '800', color: 'var(--success)', fontFamily: "'JetBrains Mono', monospace" }}>
                                                {optimizationResult.savings.time} min
                                            </div>
                                            <div style={{ fontSize: '0.85rem', color: 'var(--text-muted)' }}>Time Saved</div>
                                        </div>
                                        <div style={{ textAlign: 'center', padding: '1rem', background: 'var(--bg-dark)', borderRadius: '8px' }}>
                                            <div style={{ fontSize: '2rem', fontWeight: '800', color: 'var(--success)', fontFamily: "'JetBrains Mono', monospace" }}>
                                                ${optimizationResult.savings.fuelCost}
                                            </div>
                                            <div style={{ fontSize: '0.85rem', color: 'var(--text-muted)' }}>Fuel Cost Saved</div>
                                        </div>
                                    </div>
                                </div>

                                {/* Comparison */}
                                <div style={{ display: 'grid', gridTemplateColumns: '1fr 1fr', gap: '1.5rem' }}>
                                    {/* Original Route */}
                                    <div style={{ background: 'var(--bg-dark)', borderRadius: '12px', padding: '1.25rem', border: '2px solid var(--danger)' }}>
                                        <h4 style={{ fontSize: '1rem', fontWeight: '700', marginBottom: '1rem', color: 'var(--danger)', display: 'flex', alignItems: 'center', gap: '0.5rem' }}>
                                            üìç Original Route
                                        </h4>
                                        <div style={{ display: 'flex', gap: '1rem', marginBottom: '1rem' }}>
                                            <div style={{ padding: '0.5rem 1rem', background: 'var(--bg-card)', borderRadius: '6px' }}>
                                                <span style={{ color: 'var(--text-muted)', fontSize: '0.8rem' }}>Distance: </span>
                                                <span style={{ fontWeight: '700', fontFamily: "'JetBrains Mono', monospace" }}>{optimizationResult.original.distance} mi</span>
                                            </div>
                                            <div style={{ padding: '0.5rem 1rem', background: 'var(--bg-card)', borderRadius: '6px' }}>
                                                <span style={{ color: 'var(--text-muted)', fontSize: '0.8rem' }}>Time: </span>
                                                <span style={{ fontWeight: '700', fontFamily: "'JetBrains Mono', monospace" }}>{optimizationResult.original.time} min</span>
                                            </div>
                                        </div>
                                        <div style={{ fontSize: '0.85rem' }}>
                                            {optimizationResult.original.stops.map((stop, idx) => {
                                                const order = orders.find(o => o.id === stop.orderId);
                                                return (
                                                    <div key={idx} style={{ 
                                                        padding: '0.5rem', 
                                                        borderLeft: '3px solid var(--danger)',
                                                        marginBottom: '0.5rem',
                                                        paddingLeft: '0.75rem',
                                                        background: 'var(--bg-card)',
                                                        borderRadius: '0 6px 6px 0'
                                                    }}>
                                                        <span style={{ fontWeight: '600' }}>{idx + 1}.</span> {order?.customer || 'Unknown'}
                                                        <div style={{ fontSize: '0.75rem', color: 'var(--text-muted)' }}>{stop.estimatedTime}</div>
                                                    </div>
                                                );
                                            })}
                                        </div>
                                    </div>

                                    {/* Optimized Route */}
                                    <div style={{ background: 'var(--bg-dark)', borderRadius: '12px', padding: '1.25rem', border: '2px solid var(--success)' }}>
                                        <h4 style={{ fontSize: '1rem', fontWeight: '700', marginBottom: '1rem', color: 'var(--success)', display: 'flex', alignItems: 'center', gap: '0.5rem' }}>
                                            ‚ö° Optimized Route
                                        </h4>
                                        <div style={{ display: 'flex', gap: '1rem', marginBottom: '1rem' }}>
                                            <div style={{ padding: '0.5rem 1rem', background: 'var(--bg-card)', borderRadius: '6px' }}>
                                                <span style={{ color: 'var(--text-muted)', fontSize: '0.8rem' }}>Distance: </span>
                                                <span style={{ fontWeight: '700', fontFamily: "'JetBrains Mono', monospace", color: 'var(--success)' }}>{optimizationResult.optimized.distance} mi</span>
                                            </div>
                                            <div style={{ padding: '0.5rem 1rem', background: 'var(--bg-card)', borderRadius: '6px' }}>
                                                <span style={{ color: 'var(--text-muted)', fontSize: '0.8rem' }}>Time: </span>
                                                <span style={{ fontWeight: '700', fontFamily: "'JetBrains Mono', monospace", color: 'var(--success)' }}>{optimizationResult.optimized.time} min</span>
                                            </div>
                                        </div>
                                        <div style={{ fontSize: '0.85rem' }}>
                                            {optimizationResult.optimized.stops.map((stop, idx) => {
                                                const order = orders.find(o => o.id === stop.orderId);
                                                return (
                                                    <div key={idx} style={{ 
                                                        padding: '0.5rem', 
                                                        borderLeft: '3px solid var(--success)',
                                                        marginBottom: '0.5rem',
                                                        paddingLeft: '0.75rem',
                                                        background: 'var(--bg-card)',
                                                        borderRadius: '0 6px 6px 0'
                                                    }}>
                                                        <span style={{ fontWeight: '600' }}>{idx + 1}.</span> {order?.customer || stop.customer || 'Unknown'}
                                                        <div style={{ fontSize: '0.75rem', color: 'var(--text-muted)' }}>
                                                            {stop.estimatedTime} ‚Ä¢ {stop.distance} mi from prev
                                                        </div>
                                                    </div>
                                                );
                                            })}
                                        </div>
                                    </div>
                                </div>

                                <div className="modal-footer" style={{ marginTop: '1.5rem' }}>
                                    <button className="btn btn-secondary" onClick={() => { setOptimizingRoute(null); setOptimizationResult(null); }}>
                                        Cancel
                                    </button>
                                    <button 
                                        className="btn btn-primary"
                                        style={{ background: 'linear-gradient(135deg, #06D6A0 0%, #05B589 100%)' }}
                                        onClick={applyOptimization}
                                    >
                                        ‚úì Apply Optimized Route
                                    </button>
                                </div>
                            </div>
                        </div>
                        );
                    })()}
                </>
            );
        }

        function FleetTab({ trucks, drivers, distributionCenters, openModal, handleDelete }) {
            return (
                <>
                    <div className="card">
                        <div className="card-header">
                            <h2 className="card-title">üöõ Trucks</h2>
                            <button className="btn btn-primary" onClick={() => openModal('truck')}>
                                + Add Truck
                            </button>
                        </div>
                        <div className="table-container">
                            <table className="table">
                                <thead>
                                    <tr>
                                        <th>Truck ID</th>
                                        <th>Name</th>
                                        <th>GPS Device ID</th>
                                        <th>GPS Provider</th>
                                        <th>Capacity (gal)</th>
                                        <th>Distribution Center</th>
                                        <th>Current Speed</th>
                                        <th>Last Update</th>
                                        <th>Status</th>
                                        <th>Actions</th>
                                    </tr>
                                </thead>
                                <tbody>
                                    {trucks.map(truck => {
                                        const dc = distributionCenters.find(d => d.id === truck.dcId);
                                        return (
                                            <tr key={truck.id}>
                                                <td><strong>{truck.id}</strong></td>
                                                <td>{truck.name}</td>
                                                <td>
                                                    <span style={{ 
                                                        fontFamily: "'JetBrains Mono', monospace", 
                                                        fontSize: '0.85rem',
                                                        color: truck.gpsDeviceId ? 'var(--success)' : 'var(--text-muted)'
                                                    }}>
                                                        {truck.gpsDeviceId || 'Not Mapped'}
                                                    </span>
                                                </td>
                                                <td>
                                                    <span style={{ fontSize: '0.85rem' }}>
                                                        {truck.gpsProvider || '-'}
                                                    </span>
                                                </td>
                                                <td>{truck.capacity}</td>
                                                <td>{dc?.name}</td>
                                                <td>{truck.speed} mph</td>
                                                <td>{truck.lastUpdate}</td>
                                                <td>
                                                    <span className={`badge badge-${
                                                        truck.status === 'active' ? 'success' : 'warning'
                                                    }`}>
                                                        {truck.status}
                                                    </span>
                                                </td>
                                                <td>
                                                    <button 
                                                        className="btn btn-sm btn-secondary"
                                                        onClick={() => openModal('truck', truck)}
                                                    >
                                                        Edit
                                                    </button>
                                                </td>
                                            </tr>
                                        );
                                    })}
                                </tbody>
                            </table>
                        </div>
                    </div>

                    <div className="card">
                        <div className="card-header">
                            <h2 className="card-title">üë• Drivers</h2>
                            <button className="btn btn-primary" onClick={() => openModal('driver')}>
                                + Add Driver
                            </button>
                        </div>
                        <div className="table-container">
                            <table className="table">
                                <thead>
                                    <tr>
                                        <th>Driver ID</th>
                                        <th>Name</th>
                                        <th>License Number</th>
                                        <th>Hourly Rate</th>
                                        <th>Status</th>
                                        <th>Actions</th>
                                    </tr>
                                </thead>
                                <tbody>
                                    {drivers.map(driver => (
                                        <tr key={driver.id}>
                                            <td><strong>{driver.id}</strong></td>
                                            <td>{driver.name}</td>
                                            <td>{driver.licenseNumber}</td>
                                            <td>${driver.hourlyRate}/hr</td>
                                            <td>
                                                <span className={`badge badge-${
                                                    driver.status === 'available' ? 'success' :
                                                    driver.status === 'on-route' ? 'info' : 'warning'
                                                }`}>
                                                    {driver.status}
                                                </span>
                                            </td>
                                            <td>
                                                <button 
                                                    className="btn btn-sm btn-secondary"
                                                    onClick={() => openModal('driver', driver)}
                                                >
                                                    Edit
                                                </button>
                                            </td>
                                        </tr>
                                    ))}
                                </tbody>
                            </table>
                        </div>
                    </div>

                    <div className="card">
                        <div className="card-header">
                            <h2 className="card-title">üè≠ Distribution Centers</h2>
                            <button className="btn btn-primary" onClick={() => openModal('dc')}>
                                + Add Center
                            </button>
                        </div>
                        <div className="table-container">
                            <table className="table">
                                <thead>
                                    <tr>
                                        <th>Center ID</th>
                                        <th>Name</th>
                                        <th>Address</th>
                                        <th>City</th>
                                        <th>State</th>
                                        <th>Actions</th>
                                    </tr>
                                </thead>
                                <tbody>
                                    {distributionCenters.map(dc => (
                                        <tr key={dc.id}>
                                            <td><strong>{dc.id}</strong></td>
                                            <td>{dc.name}</td>
                                            <td>{dc.address}</td>
                                            <td>{dc.city}</td>
                                            <td>{dc.state}</td>
                                            <td>
                                                <button 
                                                    className="btn btn-sm btn-secondary"
                                                    onClick={() => openModal('dc', dc)}
                                                >
                                                    Edit
                                                </button>
                                            </td>
                                        </tr>
                                    ))}
                                </tbody>
                            </table>
                        </div>
                    </div>
                </>
            );
        }

        function CustomersTab({ customers, distributionCenters, openModal, handleDelete }) {
            const [filterState, setFilterState] = useState('all');
            const [filterDC, setFilterDC] = useState('all');
            const [filterStatus, setFilterStatus] = useState('all');
            const [filterAccountType, setFilterAccountType] = useState('all');
            const [selectedCustomer, setSelectedCustomer] = useState(null);
            const [searchTerm, setSearchTerm] = useState('');
            const [currentPage, setCurrentPage] = useState(1);
            const [itemsPerPage, setItemsPerPage] = useState(25);
            const [sortField, setSortField] = useState('name');
            const [sortDirection, setSortDirection] = useState('asc');
            const [showLocationsModal, setShowLocationsModal] = useState(false);
            const [selectedCustomerLocations, setSelectedCustomerLocations] = useState(null);

            // Filter customers
            const filteredCustomers = customers.filter(customer => {
                if (filterState !== 'all' && customer.state !== filterState) return false;
                if (filterDC !== 'all' && customer.preferredDC !== filterDC) return false;
                if (filterStatus !== 'all' && customer.status !== filterStatus) return false;
                if (filterAccountType !== 'all' && customer.accountType !== filterAccountType) return false;
                if (searchTerm) {
                    const search = searchTerm.toLowerCase();
                    return (
                        customer.name?.toLowerCase().includes(search) ||
                        customer.id?.toLowerCase().includes(search) ||
                        customer.storeId?.toLowerCase().includes(search) ||
                        customer.city?.toLowerCase().includes(search) ||
                        customer.contact?.toLowerCase().includes(search) ||
                        customer.email?.toLowerCase().includes(search)
                    );
                }
                return true;
            });

            // Sort customers
            const sortedCustomers = [...filteredCustomers].sort((a, b) => {
                let aVal = a[sortField] || '';
                let bVal = b[sortField] || '';
                if (typeof aVal === 'string') aVal = aVal.toLowerCase();
                if (typeof bVal === 'string') bVal = bVal.toLowerCase();
                if (sortDirection === 'asc') return aVal > bVal ? 1 : -1;
                return aVal < bVal ? 1 : -1;
            });

            // Paginate
            const totalPages = Math.ceil(sortedCustomers.length / itemsPerPage);
            const startIndex = (currentPage - 1) * itemsPerPage;
            const paginatedCustomers = sortedCustomers.slice(startIndex, startIndex + itemsPerPage);

            // Get unique values for filters
            const states = [...new Set(customers.map(c => c.state))].sort();
            const accountTypes = [...new Set(customers.map(c => c.accountType))].sort();

            const handleSort = (field) => {
                if (sortField === field) {
                    setSortDirection(sortDirection === 'asc' ? 'desc' : 'asc');
                } else {
                    setSortField(field);
                    setSortDirection('asc');
                }
            };

            const SortIcon = ({ field }) => (
                <span style={{ marginLeft: '0.25rem', opacity: sortField === field ? 1 : 0.3 }}>
                    {sortField === field && sortDirection === 'desc' ? '‚ñº' : '‚ñ≤'}
                </span>
            );

            const viewLocations = (customer) => {
                setSelectedCustomerLocations(customer);
                setShowLocationsModal(true);
            };

            return (
                <>
                    <div className="card">
                        <div className="card-header">
                            <h2 className="card-title">üë• Customer Management (CRM)</h2>
                            <div style={{ display: 'flex', gap: '0.5rem' }}>
                                <button className="btn btn-secondary" onClick={() => alert('Import customers from CSV/Excel')}>
                                    üì• Import
                                </button>
                                <button className="btn btn-secondary" onClick={() => alert('Export customers to CSV')}>
                                    üì§ Export
                                </button>
                                <button className="btn btn-primary" onClick={() => openModal('customer')}>
                                    + Add Customer
                                </button>
                            </div>
                        </div>

                        {/* Search Bar */}
                        <div style={{ marginBottom: '1rem' }}>
                            <input 
                                type="text"
                                placeholder="üîç Search by name, ID, store ID, city, contact, or email..."
                                className="form-input"
                                value={searchTerm}
                                onChange={(e) => { setSearchTerm(e.target.value); setCurrentPage(1); }}
                                style={{ width: '100%', maxWidth: '500px' }}
                            />
                        </div>

                        {/* Filters */}
                        <div style={{ display: 'flex', gap: '1rem', marginBottom: '1.5rem', flexWrap: 'wrap' }}>
                            <div style={{ flex: '1', minWidth: '150px', maxWidth: '200px' }}>
                                <label className="form-label">State</label>
                                <select className="form-select" value={filterState} onChange={(e) => { setFilterState(e.target.value); setCurrentPage(1); }}>
                                    <option value="all">All States ({states.length})</option>
                                    {states.map(state => (
                                        <option key={state} value={state}>{state}</option>
                                    ))}
                                </select>
                            </div>
                            <div style={{ flex: '1', minWidth: '150px', maxWidth: '200px' }}>
                                <label className="form-label">Distribution Center</label>
                                <select className="form-select" value={filterDC} onChange={(e) => { setFilterDC(e.target.value); setCurrentPage(1); }}>
                                    <option value="all">All DCs</option>
                                    {distributionCenters.map(dc => (
                                        <option key={dc.id} value={dc.id}>{dc.name}</option>
                                    ))}
                                </select>
                            </div>
                            <div style={{ flex: '1', minWidth: '150px', maxWidth: '200px' }}>
                                <label className="form-label">Account Type</label>
                                <select className="form-select" value={filterAccountType} onChange={(e) => { setFilterAccountType(e.target.value); setCurrentPage(1); }}>
                                    <option value="all">All Types</option>
                                    {accountTypes.map(type => (
                                        <option key={type} value={type}>{type}</option>
                                    ))}
                                </select>
                            </div>
                            <div style={{ flex: '1', minWidth: '150px', maxWidth: '200px' }}>
                                <label className="form-label">Status</label>
                                <select className="form-select" value={filterStatus} onChange={(e) => { setFilterStatus(e.target.value); setCurrentPage(1); }}>
                                    <option value="all">All Statuses</option>
                                    <option value="Active">Active</option>
                                    <option value="Inactive">Inactive</option>
                                </select>
                            </div>
                            <div style={{ flex: '1', minWidth: '100px', maxWidth: '150px' }}>
                                <label className="form-label">Per Page</label>
                                <select className="form-select" value={itemsPerPage} onChange={(e) => { setItemsPerPage(Number(e.target.value)); setCurrentPage(1); }}>
                                    <option value={10}>10</option>
                                    <option value={25}>25</option>
                                    <option value={50}>50</option>
                                    <option value={100}>100</option>
                                    <option value={250}>250</option>
                                </select>
                            </div>
                        </div>

                        {/* Stats */}
                        <div style={{ display: 'grid', gridTemplateColumns: 'repeat(auto-fill, minmax(200px, 1fr))', gap: '1rem', marginBottom: '1.5rem' }}>
                            <div style={{ padding: '1rem', background: 'var(--bg-dark)', borderRadius: '12px', border: '2px solid var(--border)' }}>
                                <div style={{ color: 'var(--text-muted)', fontSize: '0.85rem', marginBottom: '0.5rem' }}>Total Customers</div>
                                <div style={{ fontSize: '2rem', fontWeight: '800', fontFamily: "'JetBrains Mono', monospace", color: 'var(--primary)' }}>
                                    {customers.length.toLocaleString()}
                                </div>
                            </div>
                            <div style={{ padding: '1rem', background: 'var(--bg-dark)', borderRadius: '12px', border: '2px solid var(--border)' }}>
                                <div style={{ color: 'var(--text-muted)', fontSize: '0.85rem', marginBottom: '0.5rem' }}>Filtered Results</div>
                                <div style={{ fontSize: '2rem', fontWeight: '800', fontFamily: "'JetBrains Mono', monospace", color: 'var(--accent)' }}>
                                    {filteredCustomers.length.toLocaleString()}
                                </div>
                            </div>
                            <div style={{ padding: '1rem', background: 'var(--bg-dark)', borderRadius: '12px', border: '2px solid var(--border)' }}>
                                <div style={{ color: 'var(--text-muted)', fontSize: '0.85rem', marginBottom: '0.5rem' }}>Active Accounts</div>
                                <div style={{ fontSize: '2rem', fontWeight: '800', fontFamily: "'JetBrains Mono', monospace", color: 'var(--success)' }}>
                                    {filteredCustomers.filter(c => c.status === 'Active').length.toLocaleString()}
                                </div>
                            </div>
                            <div style={{ padding: '1rem', background: 'var(--bg-dark)', borderRadius: '12px', border: '2px solid var(--border)' }}>
                                <div style={{ color: 'var(--text-muted)', fontSize: '0.85rem', marginBottom: '0.5rem' }}>Total Yearly Volume</div>
                                <div style={{ fontSize: '2rem', fontWeight: '800', fontFamily: "'JetBrains Mono', monospace", color: 'var(--warning)' }}>
                                    {filteredCustomers.reduce((sum, c) => sum + (c.yearlyVolume || 0), 0).toLocaleString()}
                                </div>
                            </div>
                        </div>

                        {/* Table */}
                        <div className="table-container">
                            <table className="table">
                                <thead>
                                    <tr>
                                        <th onClick={() => handleSort('id')} style={{ cursor: 'pointer' }}>ID <SortIcon field="id" /></th>
                                        <th onClick={() => handleSort('storeId')} style={{ cursor: 'pointer' }}>Store ID <SortIcon field="storeId" /></th>
                                        <th onClick={() => handleSort('name')} style={{ cursor: 'pointer' }}>Name <SortIcon field="name" /></th>
                                        <th onClick={() => handleSort('city')} style={{ cursor: 'pointer' }}>Location <SortIcon field="city" /></th>
                                        <th>Locations</th>
                                        <th onClick={() => handleSort('accountType')} style={{ cursor: 'pointer' }}>Type <SortIcon field="accountType" /></th>
                                        <th>Contact</th>
                                        <th onClick={() => handleSort('yearlyVolume')} style={{ cursor: 'pointer' }}>Volume <SortIcon field="yearlyVolume" /></th>
                                        <th onClick={() => handleSort('status')} style={{ cursor: 'pointer' }}>Status <SortIcon field="status" /></th>
                                        <th>Actions</th>
                                    </tr>
                                </thead>
                                <tbody>
                                    {paginatedCustomers.map(customer => {
                                        const dc = distributionCenters.find(d => d.id === customer.preferredDC);
                                        const locationCount = customer.locations?.length || 1;
                                        return (
                                            <tr key={customer.id}>
                                                <td><strong style={{ fontSize: '0.85rem' }}>{customer.id}</strong></td>
                                                <td style={{ fontFamily: "'JetBrains Mono', monospace", fontSize: '0.85rem' }}>{customer.storeId}</td>
                                                <td>
                                                    <div style={{ fontWeight: '600' }}>{customer.name}</div>
                                                </td>
                                                <td>
                                                    <div>{customer.city}, {customer.state}</div>
                                                    <div style={{ fontSize: '0.75rem', color: 'var(--text-muted)' }}>{customer.address}</div>
                                                </td>
                                                <td>
                                                    <button 
                                                        className="btn btn-sm btn-secondary"
                                                        onClick={() => viewLocations(customer)}
                                                        style={{ padding: '0.25rem 0.5rem', fontSize: '0.8rem' }}
                                                    >
                                                        üìç {locationCount} {locationCount === 1 ? 'Location' : 'Locations'}
                                                    </button>
                                                </td>
                                                <td>
                                                    <span className="badge badge-info" style={{ fontSize: '0.75rem' }}>
                                                        {customer.accountType}
                                                    </span>
                                                </td>
                                                <td>
                                                    <div style={{ fontSize: '0.85rem' }}>{customer.contactPerson}</div>
                                                    <div style={{ fontSize: '0.7rem', color: 'var(--text-muted)' }}>{customer.phone}</div>
                                                </td>
                                                <td style={{ fontFamily: "'JetBrains Mono', monospace", fontSize: '0.85rem' }}>
                                                    {(customer.yearlyVolume || 0).toLocaleString()}
                                                </td>
                                                <td>
                                                    <span className={`badge badge-${customer.status === 'Active' ? 'success' : 'warning'}`}>
                                                        {customer.status}
                                                    </span>
                                                </td>
                                                <td>
                                                    <div style={{ display: 'flex', gap: '0.25rem' }}>
                                                        <button className="btn btn-sm btn-secondary" onClick={() => setSelectedCustomer(customer)}>View</button>
                                                        <button className="btn btn-sm btn-secondary" onClick={() => openModal('customer', customer)}>Edit</button>
                                                    </div>
                                                </td>
                                            </tr>
                                        );
                                    })}
                                </tbody>
                            </table>
                        </div>

                        {/* Pagination */}
                        {totalPages > 1 && (
                            <div style={{ display: 'flex', justifyContent: 'space-between', alignItems: 'center', marginTop: '1.5rem', flexWrap: 'wrap', gap: '1rem' }}>
                                <div style={{ color: 'var(--text-muted)', fontSize: '0.9rem' }}>
                                    Showing {startIndex + 1}-{Math.min(startIndex + itemsPerPage, sortedCustomers.length)} of {sortedCustomers.length.toLocaleString()} customers
                                </div>
                                <div style={{ display: 'flex', gap: '0.5rem', alignItems: 'center' }}>
                                    <button 
                                        className="btn btn-sm btn-secondary"
                                        onClick={() => setCurrentPage(1)}
                                        disabled={currentPage === 1}
                                    >
                                        ¬´¬´
                                    </button>
                                    <button 
                                        className="btn btn-sm btn-secondary"
                                        onClick={() => setCurrentPage(p => Math.max(1, p - 1))}
                                        disabled={currentPage === 1}
                                    >
                                        ‚Äπ Prev
                                    </button>
                                    <span style={{ padding: '0 1rem', fontFamily: "'JetBrains Mono', monospace" }}>
                                        Page {currentPage} of {totalPages}
                                    </span>
                                    <button 
                                        className="btn btn-sm btn-secondary"
                                        onClick={() => setCurrentPage(p => Math.min(totalPages, p + 1))}
                                        disabled={currentPage === totalPages}
                                    >
                                        Next ‚Ä∫
                                    </button>
                                    <button 
                                        className="btn btn-sm btn-secondary"
                                        onClick={() => setCurrentPage(totalPages)}
                                        disabled={currentPage === totalPages}
                                    >
                                        ¬ª¬ª
                                    </button>
                                </div>
                            </div>
                        )}
                    </div>

                    {/* Locations Modal */}
                    {showLocationsModal && selectedCustomerLocations && (
                        <div className="modal-overlay" onClick={() => setShowLocationsModal(false)}>
                            <div className="modal" onClick={(e) => e.stopPropagation()} style={{ maxWidth: '800px' }}>
                                <div className="modal-header">
                                    <h2 className="modal-title">üìç Locations - {selectedCustomerLocations.name}</h2>
                                    <button className="modal-close" onClick={() => setShowLocationsModal(false)}>√ó</button>
                                </div>
                                <div style={{ padding: '1rem 0' }}>
                                    <div style={{ display: 'flex', justifyContent: 'space-between', alignItems: 'center', marginBottom: '1rem' }}>
                                        <span style={{ color: 'var(--text-muted)' }}>
                                            {selectedCustomerLocations.locations?.length || 1} location(s) for this customer
                                        </span>
                                        <button className="btn btn-primary btn-sm">+ Add Location</button>
                                    </div>

                                    <div style={{ display: 'grid', gap: '1rem' }}>
                                        {/* Primary Location */}
                                        <div style={{ background: 'var(--bg-dark)', padding: '1rem', borderRadius: '12px', border: '2px solid var(--primary)' }}>
                                            <div style={{ display: 'flex', justifyContent: 'space-between', alignItems: 'flex-start' }}>
                                                <div>
                                                    <span className="badge badge-primary" style={{ marginBottom: '0.5rem' }}>Primary</span>
                                                    <div style={{ fontWeight: '700', marginBottom: '0.25rem' }}>{selectedCustomerLocations.address}</div>
                                                    <div style={{ color: 'var(--text-muted)' }}>{selectedCustomerLocations.city}, {selectedCustomerLocations.state} {selectedCustomerLocations.zipCode}</div>
                                                    <div style={{ fontSize: '0.85rem', marginTop: '0.5rem' }}>
                                                        <span style={{ color: 'var(--text-muted)' }}>Contact:</span> {selectedCustomerLocations.contactPerson} ‚Ä¢ {selectedCustomerLocations.phone}
                                                    </div>
                                                </div>
                                                <div style={{ display: 'flex', gap: '0.5rem' }}>
                                                    <button className="btn btn-sm btn-secondary">Edit</button>
                                                </div>
                                            </div>
                                        </div>

                                        {/* Additional Locations */}
                                        {selectedCustomerLocations.locations?.map((loc, idx) => (
                                            <div key={idx} style={{ background: 'var(--bg-dark)', padding: '1rem', borderRadius: '12px', border: '2px solid var(--border)' }}>
                                                <div style={{ display: 'flex', justifyContent: 'space-between', alignItems: 'flex-start' }}>
                                                    <div>
                                                        <span className="badge badge-secondary" style={{ marginBottom: '0.5rem' }}>Location #{idx + 2}</span>
                                                        <div style={{ fontWeight: '700', marginBottom: '0.25rem' }}>{loc.address}</div>
                                                        <div style={{ color: 'var(--text-muted)' }}>{loc.city}, {loc.state} {loc.zipCode}</div>
                                                        {loc.contact && (
                                                            <div style={{ fontSize: '0.85rem', marginTop: '0.5rem' }}>
                                                                <span style={{ color: 'var(--text-muted)' }}>Contact:</span> {loc.contact} ‚Ä¢ {loc.phone}
                                                            </div>
                                                        )}
                                                    </div>
                                                    <div style={{ display: 'flex', gap: '0.5rem' }}>
                                                        <button className="btn btn-sm btn-secondary">Edit</button>
                                                        <button className="btn btn-sm btn-danger">Remove</button>
                                                    </div>
                                                </div>
                                            </div>
                                        ))}
                                    </div>
                                </div>
                                <div className="modal-footer">
                                    <button className="btn btn-secondary" onClick={() => setShowLocationsModal(false)}>Close</button>
                                </div>
                            </div>
                        </div>
                    )}

                    {selectedCustomer && (
                        <div className="card">
                            <div className="card-header">
                                <h2 className="card-title">üìã Customer Details - {selectedCustomer.name}</h2>
                                <div style={{ display: 'flex', gap: '0.5rem' }}>
                                    <button 
                                        className="btn btn-secondary btn-sm"
                                        onClick={() => openModal('customer', selectedCustomer)}
                                    >
                                        Edit
                                    </button>
                                    <button 
                                        className="btn btn-secondary btn-sm" 
                                        onClick={() => setSelectedCustomer(null)}
                                    >
                                        Close
                                    </button>
                                </div>
                            </div>

                            <div style={{ display: 'grid', gridTemplateColumns: 'repeat(auto-fit, minmax(250px, 1fr))', gap: '1.5rem' }}>
                                <div>
                                    <h3 style={{ fontSize: '1.1rem', fontWeight: '700', marginBottom: '1rem', color: 'var(--primary)' }}>
                                        Contact Information
                                    </h3>
                                    <div style={{ display: 'flex', flexDirection: 'column', gap: '0.75rem' }}>
                                        <div>
                                            <div style={{ fontSize: '0.85rem', color: 'var(--text-muted)' }}>Contact Person</div>
                                            <div style={{ fontWeight: '600' }}>{selectedCustomer.contactPerson}</div>
                                        </div>
                                        <div>
                                            <div style={{ fontSize: '0.85rem', color: 'var(--text-muted)' }}>Email</div>
                                            <div style={{ fontFamily: "'JetBrains Mono', monospace", fontSize: '0.9rem' }}>
                                                {selectedCustomer.email}
                                            </div>
                                        </div>
                                        <div>
                                            <div style={{ fontSize: '0.85rem', color: 'var(--text-muted)' }}>Phone</div>
                                            <div style={{ fontFamily: "'JetBrains Mono', monospace" }}>{selectedCustomer.phone}</div>
                                        </div>
                                    </div>
                                </div>

                                <div>
                                    <h3 style={{ fontSize: '1.1rem', fontWeight: '700', marginBottom: '1rem', color: 'var(--primary)' }}>
                                        Location Details
                                    </h3>
                                    <div style={{ display: 'flex', flexDirection: 'column', gap: '0.75rem' }}>
                                        <div>
                                            <div style={{ fontSize: '0.85rem', color: 'var(--text-muted)' }}>Address</div>
                                            <div>{selectedCustomer.address}</div>
                                        </div>
                                        <div>
                                            <div style={{ fontSize: '0.85rem', color: 'var(--text-muted)' }}>City, State ZIP</div>
                                            <div>{selectedCustomer.city}, {selectedCustomer.state} {selectedCustomer.zipCode}</div>
                                        </div>
                                        <div>
                                            <div style={{ fontSize: '0.85rem', color: 'var(--text-muted)' }}>GPS Coordinates</div>
                                            <div style={{ fontFamily: "'JetBrains Mono', monospace", fontSize: '0.85rem' }}>
                                                {selectedCustomer.lat.toFixed(4)}, {selectedCustomer.lng.toFixed(4)}
                                            </div>
                                        </div>
                                    </div>
                                </div>

                                <div>
                                    <h3 style={{ fontSize: '1.1rem', fontWeight: '700', marginBottom: '1rem', color: 'var(--primary)' }}>
                                        Account Information
                                    </h3>
                                    <div style={{ display: 'flex', flexDirection: 'column', gap: '0.75rem' }}>
                                        <div>
                                            <div style={{ fontSize: '0.85rem', color: 'var(--text-muted)' }}>Account Type</div>
                                            <span className="badge badge-info">{selectedCustomer.accountType}</span>
                                        </div>
                                        <div>
                                            <div style={{ fontSize: '0.85rem', color: 'var(--text-muted)' }}>Store ID</div>
                                            <div style={{ fontFamily: "'JetBrains Mono', monospace", fontWeight: '700' }}>
                                                {selectedCustomer.storeId}
                                            </div>
                                        </div>
                                        <div>
                                            <div style={{ fontSize: '0.85rem', color: 'var(--text-muted)' }}>Preferred DC</div>
                                            <div>{distributionCenters.find(d => d.id === selectedCustomer.preferredDC)?.name}</div>
                                        </div>
                                        <div>
                                            <div style={{ fontSize: '0.85rem', color: 'var(--text-muted)' }}>Status</div>
                                            <span className={`badge badge-${
                                                selectedCustomer.status === 'Active' ? 'success' : 'warning'
                                            }`}>
                                                {selectedCustomer.status}
                                            </span>
                                        </div>
                                    </div>
                                </div>

                                <div>
                                    <h3 style={{ fontSize: '1.1rem', fontWeight: '700', marginBottom: '1rem', color: 'var(--primary)' }}>
                                        Order Statistics
                                    </h3>
                                    <div style={{ display: 'flex', flexDirection: 'column', gap: '0.75rem' }}>
                                        <div>
                                            <div style={{ fontSize: '0.85rem', color: 'var(--text-muted)' }}>Total Orders</div>
                                            <div style={{ fontSize: '1.5rem', fontWeight: '800', fontFamily: "'JetBrains Mono', monospace", color: 'var(--accent)' }}>
                                                {selectedCustomer.totalOrders}
                                            </div>
                                        </div>
                                        <div>
                                            <div style={{ fontSize: '0.85rem', color: 'var(--text-muted)' }}>Yearly Volume</div>
                                            <div style={{ fontSize: '1.5rem', fontWeight: '800', fontFamily: "'JetBrains Mono', monospace", color: 'var(--success)' }}>
                                                {selectedCustomer.yearlyVolume.toLocaleString()} units
                                            </div>
                                        </div>
                                        <div>
                                            <div style={{ fontSize: '0.85rem', color: 'var(--text-muted)' }}>Last Order</div>
                                            <div style={{ fontFamily: "'JetBrains Mono', monospace" }}>{selectedCustomer.lastOrderDate}</div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    )}
                </>
            );
        }

        function EmployeesTab({ drivers, openModal, handleDelete, permissions }) {
            const [selectedEmployee, setSelectedEmployee] = useState(null);
            const [filterStatus, setFilterStatus] = useState('all');
            const [showBackgroundCheckModal, setShowBackgroundCheckModal] = useState(false);
            const [showLicenseVerifyModal, setShowLicenseVerifyModal] = useState(false);
            const [verifyingEmployee, setVerifyingEmployee] = useState(null);

            // Field-level access control
            const canViewSSN = permissions?.canViewSSN || permissions?.canManageUsers;
            const canViewPayroll = permissions?.canViewPayroll || permissions?.canManageUsers;
            const canEditPayRates = permissions?.canEditPayRates || permissions?.canManageUsers;
            const canEditBenefits = permissions?.canEditBenefits || permissions?.canManageUsers;
            const canManageDirectDeposit = permissions?.canManageDirectDeposit || permissions?.canManageUsers;

            const filteredDrivers = drivers.filter(driver => {
                if (filterStatus !== 'all' && driver.status !== filterStatus) return false;
                return true;
            });

            const initiateBackgroundCheck = (employee) => {
                setVerifyingEmployee(employee);
                setShowBackgroundCheckModal(true);
            };

            const initiateLicenseVerification = (employee) => {
                setVerifyingEmployee(employee);
                setShowLicenseVerifyModal(true);
            };

            const getExpirationStatus = (dateStr) => {
                if (!dateStr) return { status: 'unknown', badge: 'secondary' };
                const expDate = new Date(dateStr);
                const today = new Date();
                const daysUntil = Math.ceil((expDate - today) / (1000 * 60 * 60 * 24));
                
                if (daysUntil < 0) return { status: 'Expired', badge: 'danger', days: daysUntil };
                if (daysUntil < 30) return { status: 'Expiring Soon', badge: 'danger', days: daysUntil };
                if (daysUntil < 90) return { status: 'Expiring', badge: 'warning', days: daysUntil };
                return { status: 'Valid', badge: 'success', days: daysUntil };
            };

            return (
                <>
                    <div className="card">
                        <div className="card-header">
                            <h2 className="card-title">üë• Employee / Driver Profiles</h2>
                            <button className="btn btn-primary" onClick={() => openModal('driver')}>
                                + Add Employee
                            </button>
                        </div>

                        <div style={{ display: 'flex', gap: '1rem', marginBottom: '1.5rem', flexWrap: 'wrap' }}>
                            <div style={{ flex: '1', minWidth: '200px' }}>
                                <label className="form-label">Filter by Status</label>
                                <select 
                                    className="form-select"
                                    value={filterStatus}
                                    onChange={(e) => setFilterStatus(e.target.value)}
                                >
                                    <option value="all">All Statuses</option>
                                    <option value="available">Available</option>
                                    <option value="on-route">On Route</option>
                                    <option value="off-duty">Off Duty</option>
                                </select>
                            </div>
                        </div>

                        <div style={{ display: 'grid', gridTemplateColumns: 'repeat(auto-fit, minmax(200px, 1fr))', gap: '1rem', marginBottom: '2rem' }}>
                            <div style={{ padding: '1rem', background: 'var(--bg-dark)', borderRadius: '12px', border: '2px solid var(--border)' }}>
                                <div style={{ color: 'var(--text-muted)', fontSize: '0.85rem', marginBottom: '0.5rem' }}>Total Employees</div>
                                <div style={{ fontSize: '2rem', fontWeight: '800', fontFamily: "'JetBrains Mono', monospace", color: 'var(--primary)' }}>
                                    {filteredDrivers.length}
                                </div>
                            </div>
                            <div style={{ padding: '1rem', background: 'var(--bg-dark)', borderRadius: '12px', border: '2px solid var(--border)' }}>
                                <div style={{ color: 'var(--text-muted)', fontSize: '0.85rem', marginBottom: '0.5rem' }}>Available</div>
                                <div style={{ fontSize: '2rem', fontWeight: '800', fontFamily: "'JetBrains Mono', monospace", color: 'var(--success)' }}>
                                    {drivers.filter(d => d.status === 'available').length}
                                </div>
                            </div>
                            <div style={{ padding: '1rem', background: 'var(--bg-dark)', borderRadius: '12px', border: '2px solid var(--border)' }}>
                                <div style={{ color: 'var(--text-muted)', fontSize: '0.85rem', marginBottom: '0.5rem' }}>On Route</div>
                                <div style={{ fontSize: '2rem', fontWeight: '800', fontFamily: "'JetBrains Mono', monospace", color: 'var(--accent)' }}>
                                    {drivers.filter(d => d.status === 'on-route').length}
                                </div>
                            </div>
                            <div style={{ padding: '1rem', background: 'var(--bg-dark)', borderRadius: '12px', border: '2px solid var(--border)' }}>
                                <div style={{ color: 'var(--text-muted)', fontSize: '0.85rem', marginBottom: '0.5rem' }}>License Expiring</div>
                                <div style={{ fontSize: '2rem', fontWeight: '800', fontFamily: "'JetBrains Mono', monospace", color: 'var(--warning)' }}>
                                    {drivers.filter(d => getExpirationStatus(d.licenseExpiration).days < 90).length}
                                </div>
                            </div>
                        </div>

                        <div className="table-container">
                            <table className="table">
                                <thead>
                                    <tr>
                                        <th>Employee ID</th>
                                        <th>Name</th>
                                        <th>CDL Number</th>
                                        <th>CDL Class</th>
                                        <th>State</th>
                                        <th>License Status</th>
                                        <th>Background</th>
                                        <th>Medical Card</th>
                                        <th>Status</th>
                                        <th>Actions</th>
                                    </tr>
                                </thead>
                                <tbody>
                                    {filteredDrivers.map(driver => {
                                        const licenseStatus = getExpirationStatus(driver.licenseExpiration);
                                        const medicalStatus = getExpirationStatus(driver.medicalCardExpiration);
                                        
                                        return (
                                            <tr key={driver.id}>
                                                <td><strong>{driver.id}</strong></td>
                                                <td>
                                                    <div>{driver.name}</div>
                                                    <div style={{ fontSize: '0.75rem', color: 'var(--text-muted)' }}>{driver.email}</div>
                                                </td>
                                                <td style={{ fontFamily: "'JetBrains Mono', monospace" }}>{driver.licenseNumber}</td>
                                                <td>{driver.licenseClass}</td>
                                                <td>{driver.licenseState}</td>
                                                <td>
                                                    <span className={`badge badge-${driver.licenseVerificationStatus === 'Verified' ? 'success' : 'warning'}`}>
                                                        {driver.licenseVerificationStatus}
                                                    </span>
                                                    <div style={{ fontSize: '0.7rem', color: 'var(--text-muted)', marginTop: '0.25rem' }}>
                                                        Exp: {driver.licenseExpiration}
                                                    </div>
                                                </td>
                                                <td>
                                                    <span className={`badge badge-${driver.backgroundCheckStatus === 'Cleared' ? 'success' : 'danger'}`}>
                                                        {driver.backgroundCheckStatus}
                                                    </span>
                                                </td>
                                                <td>
                                                    <span className={`badge badge-${medicalStatus.badge}`}>
                                                        {medicalStatus.status}
                                                    </span>
                                                </td>
                                                <td>
                                                    <span className={`badge badge-${
                                                        driver.status === 'available' ? 'success' :
                                                        driver.status === 'on-route' ? 'info' : 'warning'
                                                    }`}>
                                                        {driver.status}
                                                    </span>
                                                </td>
                                                <td>
                                                    <button 
                                                        className="btn btn-sm btn-secondary"
                                                        onClick={() => setSelectedEmployee(driver)}
                                                    >
                                                        View Profile
                                                    </button>
                                                </td>
                                            </tr>
                                        );
                                    })}
                                </tbody>
                            </table>
                        </div>
                    </div>

                    {selectedEmployee && (
                        <div className="card">
                            <div className="card-header">
                                <h2 className="card-title">üë§ Employee Profile - {selectedEmployee.name}</h2>
                                <div style={{ display: 'flex', gap: '0.5rem' }}>
                                    <button 
                                        className="btn btn-secondary btn-sm"
                                        onClick={() => openModal('driver', selectedEmployee)}
                                    >
                                        Edit Profile
                                    </button>
                                    <button 
                                        className="btn btn-secondary btn-sm" 
                                        onClick={() => setSelectedEmployee(null)}
                                    >
                                        Close
                                    </button>
                                </div>
                            </div>

                            <div style={{ display: 'grid', gridTemplateColumns: 'repeat(auto-fit, minmax(300px, 1fr))', gap: '1.5rem' }}>
                                {/* Personal Information */}
                                <div style={{ background: 'var(--bg-dark)', padding: '1.5rem', borderRadius: '12px', border: '2px solid var(--border)' }}>
                                    <h3 style={{ fontSize: '1.1rem', fontWeight: '700', marginBottom: '1rem', color: 'var(--primary)', display: 'flex', alignItems: 'center', gap: '0.5rem' }}>
                                        üìã Personal Information
                                    </h3>
                                    <div style={{ display: 'grid', gap: '0.75rem' }}>
                                        <div style={{ display: 'flex', justifyContent: 'space-between' }}>
                                            <span style={{ color: 'var(--text-muted)' }}>Full Name:</span>
                                            <span style={{ fontWeight: '600' }}>{selectedEmployee.firstName} {selectedEmployee.lastName}</span>
                                        </div>
                                        <div style={{ display: 'flex', justifyContent: 'space-between' }}>
                                            <span style={{ color: 'var(--text-muted)' }}>Email:</span>
                                            <span style={{ fontFamily: "'JetBrains Mono', monospace", fontSize: '0.9rem' }}>{selectedEmployee.email}</span>
                                        </div>
                                        <div style={{ display: 'flex', justifyContent: 'space-between' }}>
                                            <span style={{ color: 'var(--text-muted)' }}>Phone:</span>
                                            <span>{selectedEmployee.phone}</span>
                                        </div>
                                        <div style={{ display: 'flex', justifyContent: 'space-between' }}>
                                            <span style={{ color: 'var(--text-muted)' }}>Date of Birth:</span>
                                            <span>{selectedEmployee.dateOfBirth}</span>
                                        </div>
                                        <div style={{ display: 'flex', justifyContent: 'space-between' }}>
                                            <span style={{ color: 'var(--text-muted)' }}>SSN:</span>
                                            <span style={{ fontFamily: "'JetBrains Mono', monospace" }}>
                                                {canViewSSN ? selectedEmployee.ssn : '***-**-****'}
                                                {!canViewSSN && <span style={{ fontSize: '0.7rem', color: 'var(--danger)', marginLeft: '0.5rem' }}>üîí</span>}
                                            </span>
                                        </div>
                                        <div style={{ display: 'flex', justifyContent: 'space-between' }}>
                                            <span style={{ color: 'var(--text-muted)' }}>Address:</span>
                                            <span style={{ textAlign: 'right' }}>{selectedEmployee.address}<br/>{selectedEmployee.city}, {selectedEmployee.state} {selectedEmployee.zipCode}</span>
                                        </div>
                                    </div>
                                </div>

                                {/* Emergency Contact */}
                                <div style={{ background: 'var(--bg-dark)', padding: '1.5rem', borderRadius: '12px', border: '2px solid var(--border)' }}>
                                    <h3 style={{ fontSize: '1.1rem', fontWeight: '700', marginBottom: '1rem', color: 'var(--danger)', display: 'flex', alignItems: 'center', gap: '0.5rem' }}>
                                        üö® Emergency Contact
                                    </h3>
                                    <div style={{ display: 'grid', gap: '0.75rem' }}>
                                        <div style={{ display: 'flex', justifyContent: 'space-between' }}>
                                            <span style={{ color: 'var(--text-muted)' }}>Contact Name:</span>
                                            <span style={{ fontWeight: '600' }}>{selectedEmployee.emergencyContact}</span>
                                        </div>
                                        <div style={{ display: 'flex', justifyContent: 'space-between' }}>
                                            <span style={{ color: 'var(--text-muted)' }}>Phone:</span>
                                            <span>{selectedEmployee.emergencyPhone}</span>
                                        </div>
                                    </div>

                                    <h3 style={{ fontSize: '1.1rem', fontWeight: '700', marginTop: '1.5rem', marginBottom: '1rem', color: 'var(--accent)', display: 'flex', alignItems: 'center', gap: '0.5rem' }}>
                                        üíº Employment Details
                                    </h3>
                                    <div style={{ display: 'grid', gap: '0.75rem' }}>
                                        <div style={{ display: 'flex', justifyContent: 'space-between' }}>
                                            <span style={{ color: 'var(--text-muted)' }}>Employee ID:</span>
                                            <span style={{ fontFamily: "'JetBrains Mono', monospace", fontWeight: '700' }}>{selectedEmployee.id}</span>
                                        </div>
                                        <div style={{ display: 'flex', justifyContent: 'space-between' }}>
                                            <span style={{ color: 'var(--text-muted)' }}>Hire Date:</span>
                                            <span>{selectedEmployee.hireDate}</span>
                                        </div>
                                        <div style={{ display: 'flex', justifyContent: 'space-between' }}>
                                            <span style={{ color: 'var(--text-muted)' }}>Type:</span>
                                            <span>{selectedEmployee.employeeType}</span>
                                        </div>
                                        <div style={{ display: 'flex', justifyContent: 'space-between' }}>
                                            <span style={{ color: 'var(--text-muted)' }}>Department:</span>
                                            <span>{selectedEmployee.department}</span>
                                        </div>
                                        <div style={{ display: 'flex', justifyContent: 'space-between' }}>
                                            <span style={{ color: 'var(--text-muted)' }}>Hourly Rate:</span>
                                            {canViewPayroll ? (
                                                <span style={{ fontWeight: '700', color: 'var(--success)' }}>${selectedEmployee.hourlyRate}/hr</span>
                                            ) : (
                                                <span style={{ color: 'var(--text-muted)' }}>
                                                    $---.--/hr
                                                    <span style={{ fontSize: '0.7rem', color: 'var(--danger)', marginLeft: '0.5rem' }}>üîí Restricted</span>
                                                </span>
                                            )}
                                        </div>
                                    </div>
                                </div>

                                {/* CDL Information */}
                                <div style={{ background: 'var(--bg-dark)', padding: '1.5rem', borderRadius: '12px', border: '2px solid var(--success)' }}>
                                    <h3 style={{ fontSize: '1.1rem', fontWeight: '700', marginBottom: '1rem', color: 'var(--success)', display: 'flex', alignItems: 'center', gap: '0.5rem' }}>
                                        ü™™ CDL Information
                                    </h3>
                                    <div style={{ display: 'grid', gap: '0.75rem' }}>
                                        <div style={{ display: 'flex', justifyContent: 'space-between' }}>
                                            <span style={{ color: 'var(--text-muted)' }}>License Number:</span>
                                            <span style={{ fontFamily: "'JetBrains Mono', monospace", fontWeight: '700', fontSize: '1.1rem' }}>{selectedEmployee.licenseNumber}</span>
                                        </div>
                                        <div style={{ display: 'flex', justifyContent: 'space-between' }}>
                                            <span style={{ color: 'var(--text-muted)' }}>License Class:</span>
                                            <span className="badge badge-info">{selectedEmployee.licenseClass}</span>
                                        </div>
                                        <div style={{ display: 'flex', justifyContent: 'space-between' }}>
                                            <span style={{ color: 'var(--text-muted)' }}>Issuing State:</span>
                                            <span>{selectedEmployee.licenseState}</span>
                                        </div>
                                        <div style={{ display: 'flex', justifyContent: 'space-between' }}>
                                            <span style={{ color: 'var(--text-muted)' }}>Expiration:</span>
                                            <span className={`badge badge-${getExpirationStatus(selectedEmployee.licenseExpiration).badge}`}>
                                                {selectedEmployee.licenseExpiration}
                                            </span>
                                        </div>
                                        <div style={{ display: 'flex', justifyContent: 'space-between', alignItems: 'flex-start' }}>
                                            <span style={{ color: 'var(--text-muted)' }}>Endorsements:</span>
                                            <div style={{ display: 'flex', gap: '0.25rem', flexWrap: 'wrap', justifyContent: 'flex-end' }}>
                                                {selectedEmployee.endorsements?.map((e, i) => (
                                                    <span key={i} className="badge badge-success" style={{ fontSize: '0.75rem' }}>{e}</span>
                                                ))}
                                            </div>
                                        </div>
                                        {selectedEmployee.restrictions?.length > 0 && (
                                            <div style={{ display: 'flex', justifyContent: 'space-between', alignItems: 'flex-start' }}>
                                                <span style={{ color: 'var(--text-muted)' }}>Restrictions:</span>
                                                <div style={{ display: 'flex', gap: '0.25rem', flexWrap: 'wrap', justifyContent: 'flex-end' }}>
                                                    {selectedEmployee.restrictions.map((r, i) => (
                                                        <span key={i} className="badge badge-warning" style={{ fontSize: '0.75rem' }}>{r}</span>
                                                    ))}
                                                </div>
                                            </div>
                                        )}
                                    </div>
                                    <button 
                                        className="btn btn-success btn-sm"
                                        style={{ width: '100%', marginTop: '1rem' }}
                                        onClick={() => initiateLicenseVerification(selectedEmployee)}
                                    >
                                        üîç Verify License with State DMV
                                    </button>
                                </div>

                                {/* Compliance & Verification */}
                                <div style={{ background: 'var(--bg-dark)', padding: '1.5rem', borderRadius: '12px', border: '2px solid var(--warning)' }}>
                                    <h3 style={{ fontSize: '1.1rem', fontWeight: '700', marginBottom: '1rem', color: 'var(--warning)', display: 'flex', alignItems: 'center', gap: '0.5rem' }}>
                                        ‚úÖ Compliance & Verification
                                    </h3>
                                    <div style={{ display: 'grid', gap: '0.75rem' }}>
                                        <div style={{ display: 'flex', justifyContent: 'space-between', alignItems: 'center' }}>
                                            <span style={{ color: 'var(--text-muted)' }}>Background Check:</span>
                                            <span className={`badge badge-${selectedEmployee.backgroundCheckStatus === 'Cleared' ? 'success' : 'danger'}`}>
                                                {selectedEmployee.backgroundCheckStatus}
                                            </span>
                                        </div>
                                        <div style={{ display: 'flex', justifyContent: 'space-between' }}>
                                            <span style={{ color: 'var(--text-muted)' }}>Check Date:</span>
                                            <span style={{ fontSize: '0.9rem' }}>{selectedEmployee.backgroundCheckDate}</span>
                                        </div>
                                        <div style={{ display: 'flex', justifyContent: 'space-between' }}>
                                            <span style={{ color: 'var(--text-muted)' }}>Provider:</span>
                                            <span>{selectedEmployee.backgroundCheckProvider}</span>
                                        </div>
                                        <hr style={{ border: 'none', borderTop: '1px solid var(--border)', margin: '0.5rem 0' }} />
                                        <div style={{ display: 'flex', justifyContent: 'space-between', alignItems: 'center' }}>
                                            <span style={{ color: 'var(--text-muted)' }}>License Verification:</span>
                                            <span className={`badge badge-${selectedEmployee.licenseVerificationStatus === 'Verified' ? 'success' : 'warning'}`}>
                                                {selectedEmployee.licenseVerificationStatus}
                                            </span>
                                        </div>
                                        <div style={{ display: 'flex', justifyContent: 'space-between' }}>
                                            <span style={{ color: 'var(--text-muted)' }}>Verified Date:</span>
                                            <span style={{ fontSize: '0.9rem' }}>{selectedEmployee.licenseVerificationDate}</span>
                                        </div>
                                        <hr style={{ border: 'none', borderTop: '1px solid var(--border)', margin: '0.5rem 0' }} />
                                        <div style={{ display: 'flex', justifyContent: 'space-between', alignItems: 'center' }}>
                                            <span style={{ color: 'var(--text-muted)' }}>Drug Test:</span>
                                            <span className={`badge badge-${selectedEmployee.drugTestStatus === 'Passed' ? 'success' : 'danger'}`}>
                                                {selectedEmployee.drugTestStatus}
                                            </span>
                                        </div>
                                        <div style={{ display: 'flex', justifyContent: 'space-between' }}>
                                            <span style={{ color: 'var(--text-muted)' }}>Test Date:</span>
                                            <span style={{ fontSize: '0.9rem' }}>{selectedEmployee.drugTestDate}</span>
                                        </div>
                                        <hr style={{ border: 'none', borderTop: '1px solid var(--border)', margin: '0.5rem 0' }} />
                                        <div style={{ display: 'flex', justifyContent: 'space-between', alignItems: 'center' }}>
                                            <span style={{ color: 'var(--text-muted)' }}>MVR (Motor Vehicle Record):</span>
                                            <span className={`badge badge-${selectedEmployee.mvrStatus === 'Clear' ? 'success' : 'danger'}`}>
                                                {selectedEmployee.mvrStatus}
                                            </span>
                                        </div>
                                        <div style={{ display: 'flex', justifyContent: 'space-between' }}>
                                            <span style={{ color: 'var(--text-muted)' }}>MVR Date:</span>
                                            <span style={{ fontSize: '0.9rem' }}>{selectedEmployee.mvrDate}</span>
                                        </div>
                                    </div>
                                    <button 
                                        className="btn btn-warning btn-sm"
                                        style={{ width: '100%', marginTop: '1rem' }}
                                        onClick={() => initiateBackgroundCheck(selectedEmployee)}
                                    >
                                        üîé Run New Background Check
                                    </button>
                                </div>

                                {/* Medical Card */}
                                <div style={{ background: 'var(--bg-dark)', padding: '1.5rem', borderRadius: '12px', border: '2px solid var(--secondary)' }}>
                                    <h3 style={{ fontSize: '1.1rem', fontWeight: '700', marginBottom: '1rem', color: 'var(--secondary)', display: 'flex', alignItems: 'center', gap: '0.5rem' }}>
                                        üè• Medical Certification
                                    </h3>
                                    <div style={{ display: 'grid', gap: '0.75rem' }}>
                                        <div style={{ display: 'flex', justifyContent: 'space-between', alignItems: 'center' }}>
                                            <span style={{ color: 'var(--text-muted)' }}>Medical Card Status:</span>
                                            <span className={`badge badge-${selectedEmployee.medicalCardStatus === 'Valid' ? 'success' : 'danger'}`}>
                                                {selectedEmployee.medicalCardStatus}
                                            </span>
                                        </div>
                                        <div style={{ display: 'flex', justifyContent: 'space-between' }}>
                                            <span style={{ color: 'var(--text-muted)' }}>Expiration:</span>
                                            <span className={`badge badge-${getExpirationStatus(selectedEmployee.medicalCardExpiration).badge}`}>
                                                {selectedEmployee.medicalCardExpiration}
                                            </span>
                                        </div>
                                    </div>

                                    <h3 style={{ fontSize: '1.1rem', fontWeight: '700', marginTop: '1.5rem', marginBottom: '1rem', color: 'var(--accent)', display: 'flex', alignItems: 'center', gap: '0.5rem' }}>
                                        üìö Training & Certifications
                                    </h3>
                                    <div style={{ display: 'flex', flexWrap: 'wrap', gap: '0.5rem' }}>
                                        {selectedEmployee.trainingCompleted?.map((training, i) => (
                                            <span 
                                                key={i} 
                                                style={{ 
                                                    background: 'var(--bg-card)', 
                                                    border: '1px solid var(--success)',
                                                    padding: '0.5rem 0.75rem',
                                                    borderRadius: '8px',
                                                    fontSize: '0.85rem',
                                                    display: 'flex',
                                                    alignItems: 'center',
                                                    gap: '0.25rem'
                                                }}
                                            >
                                                ‚úì {training}
                                            </span>
                                        ))}
                                    </div>
                                </div>

                                {/* Payroll & Direct Deposit - SECURED SECTION */}
                                {canViewPayroll ? (
                                <div style={{ background: 'var(--bg-dark)', padding: '1.5rem', borderRadius: '12px', border: '2px solid var(--success)' }}>
                                    <h3 style={{ fontSize: '1.1rem', fontWeight: '700', marginBottom: '1rem', color: 'var(--success)', display: 'flex', alignItems: 'center', gap: '0.5rem' }}>
                                        üíµ Payroll Information
                                    </h3>
                                    <div style={{ display: 'grid', gap: '0.75rem' }}>
                                        <div style={{ display: 'flex', justifyContent: 'space-between' }}>
                                            <span style={{ color: 'var(--text-muted)' }}>Payroll ID:</span>
                                            <span style={{ fontFamily: "'JetBrains Mono', monospace", fontWeight: '700' }}>{selectedEmployee.payrollId}</span>
                                        </div>
                                        <div style={{ display: 'flex', justifyContent: 'space-between' }}>
                                            <span style={{ color: 'var(--text-muted)' }}>Pay Frequency:</span>
                                            <span className="badge badge-info">{selectedEmployee.payFrequency}</span>
                                        </div>
                                        <div style={{ display: 'flex', justifyContent: 'space-between' }}>
                                            <span style={{ color: 'var(--text-muted)' }}>Hourly Rate:</span>
                                            <span style={{ fontWeight: '700', color: 'var(--success)' }}>${selectedEmployee.hourlyRate}/hr</span>
                                        </div>
                                        <div style={{ display: 'flex', justifyContent: 'space-between' }}>
                                            <span style={{ color: 'var(--text-muted)' }}>Overtime Rate:</span>
                                            <span style={{ fontWeight: '700', color: 'var(--warning)' }}>${selectedEmployee.overtimeRate}/hr</span>
                                        </div>
                                        <hr style={{ border: 'none', borderTop: '1px solid var(--border)', margin: '0.5rem 0' }} />
                                        <div style={{ display: 'flex', justifyContent: 'space-between' }}>
                                            <span style={{ color: 'var(--text-muted)' }}>Federal Filing:</span>
                                            <span>{selectedEmployee.federalFilingStatus}</span>
                                        </div>
                                        <div style={{ display: 'flex', justifyContent: 'space-between' }}>
                                            <span style={{ color: 'var(--text-muted)' }}>Federal Allowances:</span>
                                            <span>{selectedEmployee.federalAllowances}</span>
                                        </div>
                                        <div style={{ display: 'flex', justifyContent: 'space-between' }}>
                                            <span style={{ color: 'var(--text-muted)' }}>State Filing:</span>
                                            <span>{selectedEmployee.stateFilingStatus}</span>
                                        </div>
                                    </div>

                                    {canManageDirectDeposit && selectedEmployee.directDeposit?.enabled && (
                                        <>
                                            <h4 style={{ fontSize: '1rem', fontWeight: '700', marginTop: '1.5rem', marginBottom: '0.75rem', color: 'var(--primary)' }}>
                                                üè¶ Direct Deposit
                                            </h4>
                                            <div style={{ display: 'grid', gap: '0.5rem', fontSize: '0.9rem' }}>
                                                <div style={{ display: 'flex', justifyContent: 'space-between' }}>
                                                    <span style={{ color: 'var(--text-muted)' }}>Bank:</span>
                                                    <span>{selectedEmployee.directDeposit.bankName}</span>
                                                </div>
                                                <div style={{ display: 'flex', justifyContent: 'space-between' }}>
                                                    <span style={{ color: 'var(--text-muted)' }}>Account Type:</span>
                                                    <span>{selectedEmployee.directDeposit.accountType}</span>
                                                </div>
                                                <div style={{ display: 'flex', justifyContent: 'space-between' }}>
                                                    <span style={{ color: 'var(--text-muted)' }}>Routing:</span>
                                                    <span style={{ fontFamily: "'JetBrains Mono', monospace" }}>{selectedEmployee.directDeposit.routingNumber}</span>
                                                </div>
                                                <div style={{ display: 'flex', justifyContent: 'space-between' }}>
                                                    <span style={{ color: 'var(--text-muted)' }}>Account:</span>
                                                    <span style={{ fontFamily: "'JetBrains Mono', monospace" }}>{selectedEmployee.directDeposit.accountNumber}</span>
                                                </div>
                                                <div style={{ display: 'flex', justifyContent: 'space-between' }}>
                                                    <span style={{ color: 'var(--text-muted)' }}>Deposit %:</span>
                                                    <span style={{ fontWeight: '700' }}>{selectedEmployee.directDeposit.depositPercent}%</span>
                                                </div>
                                            </div>
                                        </>
                                    )}

                                    {canManageDirectDeposit && selectedEmployee.secondaryDeposit?.enabled && (
                                        <>
                                            <h4 style={{ fontSize: '1rem', fontWeight: '700', marginTop: '1rem', marginBottom: '0.75rem', color: 'var(--secondary)' }}>
                                                üè¶ Secondary Account
                                            </h4>
                                            <div style={{ display: 'grid', gap: '0.5rem', fontSize: '0.9rem' }}>
                                                <div style={{ display: 'flex', justifyContent: 'space-between' }}>
                                                    <span style={{ color: 'var(--text-muted)' }}>Bank:</span>
                                                    <span>{selectedEmployee.secondaryDeposit.bankName}</span>
                                                </div>
                                                <div style={{ display: 'flex', justifyContent: 'space-between' }}>
                                                    <span style={{ color: 'var(--text-muted)' }}>Account:</span>
                                                    <span style={{ fontFamily: "'JetBrains Mono', monospace" }}>{selectedEmployee.secondaryDeposit.accountNumber}</span>
                                                </div>
                                                <div style={{ display: 'flex', justifyContent: 'space-between' }}>
                                                    <span style={{ color: 'var(--text-muted)' }}>Deposit %:</span>
                                                    <span style={{ fontWeight: '700' }}>{selectedEmployee.secondaryDeposit.depositPercent}%</span>
                                                </div>
                                            </div>
                                        </>
                                    )}
                                </div>
                                ) : (
                                <div style={{ background: 'var(--bg-dark)', padding: '1.5rem', borderRadius: '12px', border: '2px solid var(--danger)', opacity: 0.7 }}>
                                    <h3 style={{ fontSize: '1.1rem', fontWeight: '700', marginBottom: '1rem', color: 'var(--danger)', display: 'flex', alignItems: 'center', gap: '0.5rem' }}>
                                        üîí Payroll Information
                                    </h3>
                                    <div style={{ textAlign: 'center', padding: '2rem', color: 'var(--text-muted)' }}>
                                        <div style={{ fontSize: '2rem', marginBottom: '0.5rem' }}>üîê</div>
                                        <p style={{ marginBottom: '0.5rem', fontWeight: '600' }}>Access Restricted</p>
                                        <p style={{ fontSize: '0.85rem' }}>You don't have permission to view payroll information.</p>
                                        <p style={{ fontSize: '0.8rem', marginTop: '0.5rem' }}>Contact Payroll Admin or System Administrator.</p>
                                    </div>
                                </div>
                                )}

                                {/* YTD Earnings - SECURED */}
                                {canViewPayroll && selectedEmployee.ytdEarnings && (
                                    <div style={{ background: 'var(--bg-dark)', padding: '1.5rem', borderRadius: '12px', border: '2px solid var(--primary)' }}>
                                        <h3 style={{ fontSize: '1.1rem', fontWeight: '700', marginBottom: '1rem', color: 'var(--primary)', display: 'flex', alignItems: 'center', gap: '0.5rem' }}>
                                            üìä Year-to-Date Earnings (2026)
                                        </h3>
                                        <div style={{ display: 'grid', gap: '0.75rem' }}>
                                            <div style={{ display: 'flex', justifyContent: 'space-between' }}>
                                                <span style={{ color: 'var(--text-muted)' }}>Gross Pay:</span>
                                                <span style={{ fontFamily: "'JetBrains Mono', monospace", fontWeight: '700', color: 'var(--success)' }}>
                                                    ${selectedEmployee.ytdEarnings.grossPay.toLocaleString()}
                                                </span>
                                            </div>
                                            <div style={{ display: 'flex', justifyContent: 'space-between' }}>
                                                <span style={{ color: 'var(--text-muted)' }}>Regular Hours:</span>
                                                <span style={{ fontFamily: "'JetBrains Mono', monospace" }}>{selectedEmployee.ytdEarnings.regularHours.toLocaleString()}</span>
                                            </div>
                                            <div style={{ display: 'flex', justifyContent: 'space-between' }}>
                                                <span style={{ color: 'var(--text-muted)' }}>Overtime Hours:</span>
                                                <span style={{ fontFamily: "'JetBrains Mono', monospace", color: 'var(--warning)' }}>{selectedEmployee.ytdEarnings.overtimeHours}</span>
                                            </div>
                                            <div style={{ display: 'flex', justifyContent: 'space-between' }}>
                                                <span style={{ color: 'var(--text-muted)' }}>Overtime Pay:</span>
                                                <span style={{ fontFamily: "'JetBrains Mono', monospace", color: 'var(--warning)' }}>${selectedEmployee.ytdEarnings.overtimePay.toLocaleString()}</span>
                                            </div>
                                            <hr style={{ border: 'none', borderTop: '1px solid var(--border)', margin: '0.5rem 0' }} />
                                            <div style={{ display: 'flex', justifyContent: 'space-between' }}>
                                                <span style={{ color: 'var(--text-muted)' }}>Federal Tax:</span>
                                                <span style={{ fontFamily: "'JetBrains Mono', monospace", color: 'var(--danger)' }}>-${selectedEmployee.ytdEarnings.federalTax.toLocaleString()}</span>
                                            </div>
                                            <div style={{ display: 'flex', justifyContent: 'space-between' }}>
                                                <span style={{ color: 'var(--text-muted)' }}>State Tax:</span>
                                                <span style={{ fontFamily: "'JetBrains Mono', monospace", color: 'var(--danger)' }}>-${selectedEmployee.ytdEarnings.stateTax.toLocaleString()}</span>
                                            </div>
                                            <div style={{ display: 'flex', justifyContent: 'space-between' }}>
                                                <span style={{ color: 'var(--text-muted)' }}>Social Security:</span>
                                                <span style={{ fontFamily: "'JetBrains Mono', monospace", color: 'var(--danger)' }}>-${selectedEmployee.ytdEarnings.socialSecurity.toLocaleString()}</span>
                                            </div>
                                            <div style={{ display: 'flex', justifyContent: 'space-between' }}>
                                                <span style={{ color: 'var(--text-muted)' }}>Medicare:</span>
                                                <span style={{ fontFamily: "'JetBrains Mono', monospace", color: 'var(--danger)' }}>-${selectedEmployee.ytdEarnings.medicare.toLocaleString()}</span>
                                            </div>
                                            <hr style={{ border: 'none', borderTop: '1px solid var(--border)', margin: '0.5rem 0' }} />
                                            <div style={{ display: 'flex', justifyContent: 'space-between' }}>
                                                <span style={{ fontWeight: '700' }}>Net Pay (YTD):</span>
                                                <span style={{ fontFamily: "'JetBrains Mono', monospace", fontWeight: '800', fontSize: '1.2rem', color: 'var(--success)' }}>
                                                    ${selectedEmployee.ytdEarnings.netPay.toLocaleString()}
                                                </span>
                                            </div>
                                        </div>
                                    </div>
                                )}
                            </div>
                        </div>
                    )}

                    {/* Background Check Modal */}
                    {showBackgroundCheckModal && verifyingEmployee && (
                        <div className="modal-overlay" onClick={() => setShowBackgroundCheckModal(false)}>
                            <div className="modal" onClick={(e) => e.stopPropagation()} style={{ maxWidth: '600px' }}>
                                <div className="modal-header">
                                    <h2 className="modal-title">üîé Run Background Check</h2>
                                    <button className="modal-close" onClick={() => setShowBackgroundCheckModal(false)}>√ó</button>
                                </div>
                                <div style={{ padding: '1rem 0' }}>
                                    <div style={{ background: 'var(--bg-dark)', padding: '1rem', borderRadius: '8px', marginBottom: '1rem' }}>
                                        <div style={{ fontWeight: '700', marginBottom: '0.5rem' }}>Employee: {verifyingEmployee.name}</div>
                                        <div style={{ fontSize: '0.9rem', color: 'var(--text-muted)' }}>ID: {verifyingEmployee.id}</div>
                                    </div>

                                    <div className="form-group">
                                        <label className="form-label">Background Check Provider</label>
                                        <select className="form-select">
                                            <option value="checkr">Checkr (Recommended)</option>
                                            <option value="goodhire">GoodHire</option>
                                            <option value="sterling">Sterling</option>
                                            <option value="hireright">HireRight</option>
                                            <option value="accuratebackground">Accurate Background</option>
                                        </select>
                                    </div>

                                    <div className="form-group">
                                        <label className="form-label">Check Type</label>
                                        <div style={{ display: 'grid', gap: '0.5rem' }}>
                                            <label style={{ display: 'flex', alignItems: 'center', gap: '0.5rem', cursor: 'pointer' }}>
                                                <input type="checkbox" defaultChecked /> Criminal History (7-year)
                                            </label>
                                            <label style={{ display: 'flex', alignItems: 'center', gap: '0.5rem', cursor: 'pointer' }}>
                                                <input type="checkbox" defaultChecked /> SSN Verification
                                            </label>
                                            <label style={{ display: 'flex', alignItems: 'center', gap: '0.5rem', cursor: 'pointer' }}>
                                                <input type="checkbox" defaultChecked /> Sex Offender Registry
                                            </label>
                                            <label style={{ display: 'flex', alignItems: 'center', gap: '0.5rem', cursor: 'pointer' }}>
                                                <input type="checkbox" defaultChecked /> Motor Vehicle Records (MVR)
                                            </label>
                                            <label style={{ display: 'flex', alignItems: 'center', gap: '0.5rem', cursor: 'pointer' }}>
                                                <input type="checkbox" /> Drug Screening
                                            </label>
                                            <label style={{ display: 'flex', alignItems: 'center', gap: '0.5rem', cursor: 'pointer' }}>
                                                <input type="checkbox" /> Employment Verification
                                            </label>
                                            <label style={{ display: 'flex', alignItems: 'center', gap: '0.5rem', cursor: 'pointer' }}>
                                                <input type="checkbox" /> Education Verification
                                            </label>
                                        </div>
                                    </div>

                                    <div style={{ background: 'rgba(255, 210, 63, 0.1)', border: '1px solid var(--warning)', padding: '1rem', borderRadius: '8px', marginTop: '1rem' }}>
                                        <div style={{ fontWeight: '700', color: 'var(--warning)', marginBottom: '0.5rem' }}>‚ö†Ô∏è Important Notice</div>
                                        <div style={{ fontSize: '0.85rem', color: 'var(--text-secondary)' }}>
                                            Background checks require employee consent. An authorization form will be sent to {verifyingEmployee.email} for digital signature before the check is initiated.
                                        </div>
                                    </div>
                                </div>
                                <div className="modal-footer">
                                    <button className="btn btn-secondary" onClick={() => setShowBackgroundCheckModal(false)}>
                                        Cancel
                                    </button>
                                    <button 
                                        className="btn btn-warning" 
                                        onClick={() => {
                                            alert(`Background check request submitted for ${verifyingEmployee.name}.\n\nAuthorization email sent to: ${verifyingEmployee.email}\n\nEstimated completion: 2-5 business days`);
                                            setShowBackgroundCheckModal(false);
                                        }}
                                    >
                                        Submit Background Check Request
                                    </button>
                                </div>
                            </div>
                        </div>
                    )}

                    {/* License Verification Modal */}
                    {showLicenseVerifyModal && verifyingEmployee && (
                        <div className="modal-overlay" onClick={() => setShowLicenseVerifyModal(false)}>
                            <div className="modal" onClick={(e) => e.stopPropagation()} style={{ maxWidth: '600px' }}>
                                <div className="modal-header">
                                    <h2 className="modal-title">ü™™ CDL License Verification</h2>
                                    <button className="modal-close" onClick={() => setShowLicenseVerifyModal(false)}>√ó</button>
                                </div>
                                <div style={{ padding: '1rem 0' }}>
                                    <div style={{ background: 'var(--bg-dark)', padding: '1rem', borderRadius: '8px', marginBottom: '1rem' }}>
                                        <div style={{ display: 'grid', gap: '0.5rem' }}>
                                            <div style={{ display: 'flex', justifyContent: 'space-between' }}>
                                                <span style={{ color: 'var(--text-muted)' }}>Driver Name:</span>
                                                <span style={{ fontWeight: '700' }}>{verifyingEmployee.name}</span>
                                            </div>
                                            <div style={{ display: 'flex', justifyContent: 'space-between' }}>
                                                <span style={{ color: 'var(--text-muted)' }}>CDL Number:</span>
                                                <span style={{ fontFamily: "'JetBrains Mono', monospace", fontWeight: '700' }}>{verifyingEmployee.licenseNumber}</span>
                                            </div>
                                            <div style={{ display: 'flex', justifyContent: 'space-between' }}>
                                                <span style={{ color: 'var(--text-muted)' }}>Issuing State:</span>
                                                <span>{verifyingEmployee.licenseState}</span>
                                            </div>
                                            <div style={{ display: 'flex', justifyContent: 'space-between' }}>
                                                <span style={{ color: 'var(--text-muted)' }}>License Class:</span>
                                                <span className="badge badge-info">{verifyingEmployee.licenseClass}</span>
                                            </div>
                                        </div>
                                    </div>

                                    <div className="form-group">
                                        <label className="form-label">Verification Service</label>
                                        <select className="form-select">
                                            <option value="cdlis">CDLIS (Commercial Driver's License Information System)</option>
                                            <option value="state">Direct State DMV Verification</option>
                                            <option value="samba">SAMBA Safety</option>
                                            <option value="tenstreet">Tenstreet Xchange</option>
                                        </select>
                                    </div>

                                    <div className="form-group">
                                        <label className="form-label">Verification Type</label>
                                        <div style={{ display: 'grid', gap: '0.5rem' }}>
                                            <label style={{ display: 'flex', alignItems: 'center', gap: '0.5rem', cursor: 'pointer' }}>
                                                <input type="checkbox" defaultChecked /> License Status (Valid/Suspended/Revoked)
                                            </label>
                                            <label style={{ display: 'flex', alignItems: 'center', gap: '0.5rem', cursor: 'pointer' }}>
                                                <input type="checkbox" defaultChecked /> Endorsements Verification
                                            </label>
                                            <label style={{ display: 'flex', alignItems: 'center', gap: '0.5rem', cursor: 'pointer' }}>
                                                <input type="checkbox" defaultChecked /> Restrictions Check
                                            </label>
                                            <label style={{ display: 'flex', alignItems: 'center', gap: '0.5rem', cursor: 'pointer' }}>
                                                <input type="checkbox" defaultChecked /> Expiration Date Confirmation
                                            </label>
                                            <label style={{ display: 'flex', alignItems: 'center', gap: '0.5rem', cursor: 'pointer' }}>
                                                <input type="checkbox" defaultChecked /> Medical Certificate Status
                                            </label>
                                            <label style={{ display: 'flex', alignItems: 'center', gap: '0.5rem', cursor: 'pointer' }}>
                                                <input type="checkbox" /> Previous State License History
                                            </label>
                                        </div>
                                    </div>

                                    <div style={{ background: 'var(--bg-dark)', padding: '1rem', borderRadius: '8px', marginTop: '1rem' }}>
                                        <div style={{ fontWeight: '700', marginBottom: '0.75rem' }}>State DMV API Endpoints</div>
                                        <div style={{ fontSize: '0.85rem', color: 'var(--text-muted)' }}>
                                            <div>Alabama: <span style={{ fontFamily: "'JetBrains Mono', monospace" }}>https://api.alea.gov/cdl/verify</span></div>
                                            <div>Georgia: <span style={{ fontFamily: "'JetBrains Mono', monospace" }}>https://api.dds.ga.gov/license/verify</span></div>
                                            <div>Florida: <span style={{ fontFamily: "'JetBrains Mono', monospace" }}>https://api.flhsmv.gov/cdl/verify</span></div>
                                            <div>Tennessee: <span style={{ fontFamily: "'JetBrains Mono', monospace" }}>https://api.tn.gov/safety/cdl</span></div>
                                        </div>
                                    </div>
                                </div>
                                <div className="modal-footer">
                                    <button className="btn btn-secondary" onClick={() => setShowLicenseVerifyModal(false)}>
                                        Cancel
                                    </button>
                                    <button 
                                        className="btn btn-success" 
                                        onClick={() => {
                                            alert(`License verification initiated for ${verifyingEmployee.name}\n\nState: ${verifyingEmployee.licenseState}\nCDL: ${verifyingEmployee.licenseNumber}\n\nVerification results will be updated automatically.`);
                                            setShowLicenseVerifyModal(false);
                                        }}
                                    >
                                        Verify License Now
                                    </button>
                                </div>
                            </div>
                        </div>
                    )}
                </>
            );
        }

        function DriverModeInterface({ data, setData, setDriverMode }) {
            const [activeScreen, setActiveScreen] = useState('stops');
            const [selectedStop, setSelectedStop] = useState(null);
            const [showPaymentModal, setShowPaymentModal] = useState(false);
            const [paymentData, setPaymentData] = useState({
                cardNumber: '',
                expiry: '',
                cvv: '',
                nameOnCard: '',
                amount: '',
                tip: ''
            });
            const [paymentProcessing, setPaymentProcessing] = useState(false);
            const [paymentComplete, setPaymentComplete] = useState(false);

            // Get today's route for the driver (simulated)
            const todayRoute = data.routes.find(r => r.status === 'in-progress') || data.routes[0];
            const routeStops = todayRoute?.stops || [];

            const processPayment = () => {
                setPaymentProcessing(true);
                setTimeout(() => {
                    setPaymentProcessing(false);
                    setPaymentComplete(true);
                    
                    // Update customer payment history
                    if (selectedStop) {
                        const order = data.orders.find(o => o.id === selectedStop.orderId);
                        if (order) {
                            const newPayment = {
                                id: `PAY-${Date.now()}`,
                                date: new Date().toISOString().split('T')[0],
                                amount: parseFloat(paymentData.amount) + parseFloat(paymentData.tip || 0),
                                method: 'Credit Card',
                                last4: paymentData.cardNumber.slice(-4),
                                type: paymentData.cardNumber.startsWith('4') ? 'Visa' : 'Mastercard',
                                orderId: order.id,
                                status: 'Completed'
                            };
                            
                            setData(prev => ({
                                ...prev,
                                customers: prev.customers.map(c => 
                                    c.id === order.customerId 
                                        ? { 
                                            ...c, 
                                            paymentHistory: [...(c.paymentHistory || []), newPayment],
                                            accountBalance: Math.max(0, (c.accountBalance || 0) - newPayment.amount)
                                        }
                                        : c
                                )
                            }));
                        }
                    }

                    setTimeout(() => {
                        setShowPaymentModal(false);
                        setPaymentComplete(false);
                        setPaymentData({ cardNumber: '', expiry: '', cvv: '', nameOnCard: '', amount: '', tip: '' });
                        setSelectedStop(null);
                    }, 2000);
                }, 2000);
            };

            return (
                <div style={{ 
                    position: 'fixed', 
                    top: 0, 
                    left: 0, 
                    right: 0, 
                    bottom: 0, 
                    background: 'var(--bg-dark)', 
                    zIndex: 9999,
                    display: 'flex',
                    flexDirection: 'column'
                }}>
                    {/* Header */}
                    <div style={{ 
                        background: 'linear-gradient(135deg, var(--primary) 0%, var(--primary-dark) 100%)',
                        padding: '1rem',
                        display: 'flex',
                        justifyContent: 'space-between',
                        alignItems: 'center'
                    }}>
                        <div>
                            <div style={{ fontSize: '1.2rem', fontWeight: '800' }}>üöõ Driver Mode</div>
                            <div style={{ fontSize: '0.85rem', opacity: 0.9 }}>Route: {todayRoute?.id || 'No active route'}</div>
                        </div>
                        <button 
                            className="btn btn-sm"
                            style={{ background: 'rgba(255,255,255,0.2)', border: 'none' }}
                            onClick={() => setDriverMode(false)}
                        >
                            Exit
                        </button>
                    </div>

                    {/* Navigation Tabs */}
                    <div style={{ display: 'flex', background: 'var(--bg-card)', borderBottom: '2px solid var(--border)' }}>
                        {[
                            { id: 'stops', label: 'üìç Stops', count: routeStops.length },
                            { id: 'payment', label: 'üí≥ Payment' },
                            { id: 'history', label: 'üìú History' }
                        ].map(tab => (
                            <button
                                key={tab.id}
                                onClick={() => setActiveScreen(tab.id)}
                                style={{
                                    flex: 1,
                                    padding: '1rem',
                                    background: activeScreen === tab.id ? 'var(--primary)' : 'transparent',
                                    border: 'none',
                                    color: 'var(--text-primary)',
                                    fontWeight: activeScreen === tab.id ? '700' : '500',
                                    fontSize: '0.9rem'
                                }}
                            >
                                {tab.label} {tab.count !== undefined && `(${tab.count})`}
                            </button>
                        ))}
                    </div>

                    {/* Content Area */}
                    <div style={{ flex: 1, overflow: 'auto', padding: '1rem' }}>
                        {activeScreen === 'stops' && (
                            <div>
                                <h3 style={{ marginBottom: '1rem' }}>Today's Stops</h3>
                                {routeStops.map((stop, idx) => {
                                    const order = data.orders.find(o => o.id === stop.orderId);
                                    const customer = order ? data.customers.find(c => c.id === order.customerId) : null;
                                    
                                    return (
                                        <div 
                                            key={idx}
                                            style={{
                                                background: 'var(--bg-card)',
                                                borderRadius: '12px',
                                                padding: '1rem',
                                                marginBottom: '1rem',
                                                border: `2px solid ${stop.status === 'completed' ? 'var(--success)' : 'var(--border)'}`
                                            }}
                                        >
                                            <div style={{ display: 'flex', justifyContent: 'space-between', alignItems: 'flex-start', marginBottom: '0.75rem' }}>
                                                <div>
                                                    <div style={{ fontWeight: '700', fontSize: '1.1rem' }}>{order?.customer || 'Unknown'}</div>
                                                    <div style={{ color: 'var(--text-muted)', fontSize: '0.85rem' }}>{order?.address}</div>
                                                </div>
                                                <span className={`badge badge-${stop.status === 'completed' ? 'success' : 'warning'}`}>
                                                    {stop.status || 'pending'}
                                                </span>
                                            </div>
                                            <div style={{ display: 'flex', gap: '1rem', marginBottom: '1rem', fontSize: '0.85rem' }}>
                                                <span>üïê {stop.estimatedTime}</span>
                                                <span>üì¶ {order?.volume || 0} units</span>
                                                <span style={{ color: 'var(--success)', fontWeight: '700' }}>${order?.revenue || 0}</span>
                                            </div>
                                            {stop.status !== 'completed' && (
                                                <div style={{ display: 'flex', gap: '0.5rem' }}>
                                                    <button 
                                                        className="btn btn-success btn-sm"
                                                        style={{ flex: 1 }}
                                                        onClick={() => {
                                                            setSelectedStop(stop);
                                                            setPaymentData(prev => ({ ...prev, amount: (order?.revenue || 0).toString() }));
                                                            setShowPaymentModal(true);
                                                        }}
                                                    >
                                                        üí≥ Collect Payment
                                                    </button>
                                                    <button className="btn btn-secondary btn-sm">
                                                        üìû Call
                                                    </button>
                                                    <button className="btn btn-secondary btn-sm">
                                                        üó∫Ô∏è Navigate
                                                    </button>
                                                </div>
                                            )}
                                        </div>
                                    );
                                })}
                            </div>
                        )}

                        {activeScreen === 'payment' && (
                            <div>
                                <h3 style={{ marginBottom: '1rem' }}>Quick Payment</h3>
                                <div style={{ background: 'var(--bg-card)', borderRadius: '12px', padding: '1.5rem' }}>
                                    <div className="form-group">
                                        <label className="form-label">Select Customer</label>
                                        <select 
                                            className="form-select"
                                            onChange={(e) => {
                                                const cust = data.customers.find(c => c.id === e.target.value);
                                                if (cust) {
                                                    setSelectedStop({ customerId: cust.id, customerName: cust.name });
                                                }
                                            }}
                                        >
                                            <option value="">-- Select Customer --</option>
                                            {data.customers.map(c => (
                                                <option key={c.id} value={c.id}>{c.name} - {c.city}</option>
                                            ))}
                                        </select>
                                    </div>
                                    <div className="form-group">
                                        <label className="form-label">Amount ($)</label>
                                        <input 
                                            type="number"
                                            className="form-input"
                                            placeholder="0.00"
                                            value={paymentData.amount}
                                            onChange={(e) => setPaymentData(prev => ({ ...prev, amount: e.target.value }))}
                                            style={{ fontSize: '1.5rem', textAlign: 'center' }}
                                        />
                                    </div>
                                    <button 
                                        className="btn btn-success"
                                        style={{ width: '100%', padding: '1rem', fontSize: '1.1rem' }}
                                        onClick={() => setShowPaymentModal(true)}
                                        disabled={!paymentData.amount}
                                    >
                                        üí≥ Process Payment
                                    </button>
                                </div>
                            </div>
                        )}

                        {activeScreen === 'history' && (
                            <div>
                                <h3 style={{ marginBottom: '1rem' }}>Today's Payments</h3>
                                {data.customers.flatMap(c => 
                                    (c.paymentHistory || [])
                                        .filter(p => p.date === new Date().toISOString().split('T')[0])
                                        .map(p => ({ ...p, customerName: c.name }))
                                ).length === 0 ? (
                                    <div style={{ textAlign: 'center', padding: '2rem', color: 'var(--text-muted)' }}>
                                        No payments collected today yet.
                                    </div>
                                ) : (
                                    data.customers.flatMap(c => 
                                        (c.paymentHistory || [])
                                            .filter(p => p.date === new Date().toISOString().split('T')[0])
                                            .map(p => (
                                                <div key={p.id} style={{ background: 'var(--bg-card)', borderRadius: '12px', padding: '1rem', marginBottom: '0.75rem' }}>
                                                    <div style={{ display: 'flex', justifyContent: 'space-between' }}>
                                                        <div>
                                                            <div style={{ fontWeight: '700' }}>{c.name}</div>
                                                            <div style={{ fontSize: '0.85rem', color: 'var(--text-muted)' }}>{p.type} ‚Ä¢‚Ä¢‚Ä¢‚Ä¢ {p.last4}</div>
                                                        </div>
                                                        <div style={{ textAlign: 'right' }}>
                                                            <div style={{ fontSize: '1.2rem', fontWeight: '800', color: 'var(--success)' }}>${p.amount.toFixed(2)}</div>
                                                            <span className="badge badge-success">{p.status}</span>
                                                        </div>
                                                    </div>
                                                </div>
                                            ))
                                    )
                                )}
                            </div>
                        )}
                    </div>

                    {/* Payment Modal */}
                    {showPaymentModal && (
                        <div style={{
                            position: 'fixed',
                            top: 0,
                            left: 0,
                            right: 0,
                            bottom: 0,
                            background: 'rgba(0,0,0,0.9)',
                            zIndex: 10000,
                            display: 'flex',
                            flexDirection: 'column',
                            padding: '1rem'
                        }}>
                            <div style={{ display: 'flex', justifyContent: 'space-between', alignItems: 'center', marginBottom: '1rem' }}>
                                <h2 style={{ margin: 0 }}>üí≥ Process Payment</h2>
                                <button 
                                    className="btn btn-secondary btn-sm"
                                    onClick={() => {
                                        setShowPaymentModal(false);
                                        setPaymentComplete(false);
                                    }}
                                >
                                    ‚úï
                                </button>
                            </div>

                            {paymentComplete ? (
                                <div style={{ flex: 1, display: 'flex', flexDirection: 'column', alignItems: 'center', justifyContent: 'center' }}>
                                    <div style={{ fontSize: '4rem', marginBottom: '1rem' }}>‚úÖ</div>
                                    <div style={{ fontSize: '1.5rem', fontWeight: '800', color: 'var(--success)', marginBottom: '0.5rem' }}>
                                        Payment Successful!
                                    </div>
                                    <div style={{ fontSize: '2rem', fontWeight: '800' }}>
                                        ${(parseFloat(paymentData.amount) + parseFloat(paymentData.tip || 0)).toFixed(2)}
                                    </div>
                                </div>
                            ) : paymentProcessing ? (
                                <div style={{ flex: 1, display: 'flex', flexDirection: 'column', alignItems: 'center', justifyContent: 'center' }}>
                                    <div style={{ fontSize: '3rem', marginBottom: '1rem', animation: 'pulse 1s infinite' }}>üí≥</div>
                                    <div style={{ fontSize: '1.2rem' }}>Processing payment...</div>
                                </div>
                            ) : (
                                <div style={{ flex: 1, overflow: 'auto' }}>
                                    {/* Amount Display */}
                                    <div style={{ background: 'var(--bg-card)', borderRadius: '12px', padding: '1.5rem', marginBottom: '1rem', textAlign: 'center' }}>
                                        <div style={{ color: 'var(--text-muted)', marginBottom: '0.5rem' }}>Amount Due</div>
                                        <div style={{ fontSize: '2.5rem', fontWeight: '800', color: 'var(--success)' }}>
                                            ${parseFloat(paymentData.amount || 0).toFixed(2)}
                                        </div>
                                    </div>

                                    {/* Card Input */}
                                    <div style={{ background: 'var(--bg-card)', borderRadius: '12px', padding: '1.5rem', marginBottom: '1rem' }}>
                                        <div className="form-group">
                                            <label className="form-label">Card Number</label>
                                            <input 
                                                type="text"
                                                className="form-input"
                                                placeholder="1234 5678 9012 3456"
                                                value={paymentData.cardNumber}
                                                onChange={(e) => setPaymentData(prev => ({ ...prev, cardNumber: e.target.value.replace(/\D/g, '').slice(0, 16) }))}
                                                style={{ fontSize: '1.2rem', letterSpacing: '2px' }}
                                            />
                                        </div>
                                        <div style={{ display: 'grid', gridTemplateColumns: '1fr 1fr', gap: '1rem' }}>
                                            <div className="form-group">
                                                <label className="form-label">Expiry</label>
                                                <input 
                                                    type="text"
                                                    className="form-input"
                                                    placeholder="MM/YY"
                                                    value={paymentData.expiry}
                                                    onChange={(e) => setPaymentData(prev => ({ ...prev, expiry: e.target.value }))}
                                                />
                                            </div>
                                            <div className="form-group">
                                                <label className="form-label">CVV</label>
                                                <input 
                                                    type="text"
                                                    className="form-input"
                                                    placeholder="123"
                                                    value={paymentData.cvv}
                                                    onChange={(e) => setPaymentData(prev => ({ ...prev, cvv: e.target.value.slice(0, 4) }))}
                                                />
                                            </div>
                                        </div>
                                        <div className="form-group">
                                            <label className="form-label">Name on Card</label>
                                            <input 
                                                type="text"
                                                className="form-input"
                                                placeholder="John Smith"
                                                value={paymentData.nameOnCard}
                                                onChange={(e) => setPaymentData(prev => ({ ...prev, nameOnCard: e.target.value }))}
                                            />
                                        </div>
                                    </div>

                                    {/* Tip */}
                                    <div style={{ background: 'var(--bg-card)', borderRadius: '12px', padding: '1.5rem', marginBottom: '1rem' }}>
                                        <label className="form-label">Add Tip (Optional)</label>
                                        <div style={{ display: 'grid', gridTemplateColumns: 'repeat(4, 1fr)', gap: '0.5rem', marginBottom: '0.5rem' }}>
                                            {['0', '5', '10', '20'].map(tip => (
                                                <button
                                                    key={tip}
                                                    className={`btn btn-sm ${paymentData.tip === tip ? 'btn-primary' : 'btn-secondary'}`}
                                                    onClick={() => setPaymentData(prev => ({ ...prev, tip }))}
                                                >
                                                    {tip === '0' ? 'No Tip' : `$${tip}`}
                                                </button>
                                            ))}
                                        </div>
                                    </div>

                                    {/* Total */}
                                    <div style={{ background: 'var(--bg-card)', borderRadius: '12px', padding: '1.5rem', marginBottom: '1rem' }}>
                                        <div style={{ display: 'flex', justifyContent: 'space-between', marginBottom: '0.5rem' }}>
                                            <span>Subtotal:</span>
                                            <span>${parseFloat(paymentData.amount || 0).toFixed(2)}</span>
                                        </div>
                                        <div style={{ display: 'flex', justifyContent: 'space-between', marginBottom: '0.5rem' }}>
                                            <span>Tip:</span>
                                            <span>${parseFloat(paymentData.tip || 0).toFixed(2)}</span>
                                        </div>
                                        <div style={{ display: 'flex', justifyContent: 'space-between', fontWeight: '800', fontSize: '1.2rem', borderTop: '2px solid var(--border)', paddingTop: '0.5rem' }}>
                                            <span>Total:</span>
                                            <span style={{ color: 'var(--success)' }}>
                                                ${(parseFloat(paymentData.amount || 0) + parseFloat(paymentData.tip || 0)).toFixed(2)}
                                            </span>
                                        </div>
                                    </div>

                                    {/* Submit Button */}
                                    <button 
                                        className="btn btn-success"
                                        style={{ width: '100%', padding: '1.25rem', fontSize: '1.2rem', fontWeight: '800' }}
                                        onClick={processPayment}
                                        disabled={!paymentData.cardNumber || paymentData.cardNumber.length < 15}
                                    >
                                        üí≥ Charge ${(parseFloat(paymentData.amount || 0) + parseFloat(paymentData.tip || 0)).toFixed(2)}
                                    </button>
                                </div>
                            )}
                        </div>
                    )}
                </div>
            );
        }

        function PaymentsTab({ data, setData }) {
            const [searchTerm, setSearchTerm] = useState('');
            const [filterStatus, setFilterStatus] = useState('all');
            const [selectedPayment, setSelectedPayment] = useState(null);
            const [showRefundModal, setShowRefundModal] = useState(false);
            const [dateRange, setDateRange] = useState({ start: '2025-01-01', end: '2026-12-31' });

            // Collect all payments from all customers
            const allPayments = data.customers.flatMap(customer => 
                (customer.paymentHistory || []).map(payment => ({
                    ...payment,
                    customerId: customer.id,
                    customerName: customer.name,
                    customerEmail: customer.email
                }))
            ).sort((a, b) => new Date(b.date) - new Date(a.date));

            // Filter payments
            const filteredPayments = allPayments.filter(payment => {
                if (filterStatus !== 'all' && payment.status !== filterStatus) return false;
                if (searchTerm) {
                    const search = searchTerm.toLowerCase();
                    return (
                        payment.customerName?.toLowerCase().includes(search) ||
                        payment.id?.toLowerCase().includes(search) ||
                        payment.orderId?.toLowerCase().includes(search) ||
                        payment.last4?.includes(search)
                    );
                }
                return true;
            });

            // Calculate totals
            const totalCollected = filteredPayments.filter(p => p.status === 'Completed').reduce((sum, p) => sum + p.amount, 0);
            const totalPending = filteredPayments.filter(p => p.status === 'Pending').reduce((sum, p) => sum + p.amount, 0);
            const totalRefunded = filteredPayments.filter(p => p.status === 'Refunded').reduce((sum, p) => sum + p.amount, 0);

            return (
                <>
                    <div className="card">
                        <div className="card-header">
                            <h2 className="card-title">üí≥ Payment Management</h2>
                            <div style={{ display: 'flex', gap: '0.5rem' }}>
                                <button className="btn btn-secondary">üì• Export</button>
                                <button className="btn btn-primary">+ Record Payment</button>
                            </div>
                        </div>

                        {/* Search & Filters */}
                        <div style={{ display: 'flex', gap: '1rem', marginBottom: '1.5rem', flexWrap: 'wrap' }}>
                            <input 
                                type="text"
                                placeholder="üîç Search by customer, payment ID, or card..."
                                className="form-input"
                                value={searchTerm}
                                onChange={(e) => setSearchTerm(e.target.value)}
                                style={{ flex: 2, minWidth: '250px' }}
                            />
                            <select className="form-select" value={filterStatus} onChange={(e) => setFilterStatus(e.target.value)} style={{ minWidth: '150px' }}>
                                <option value="all">All Status</option>
                                <option value="Completed">Completed</option>
                                <option value="Pending">Pending</option>
                                <option value="Refunded">Refunded</option>
                                <option value="Failed">Failed</option>
                            </select>
                        </div>

                        {/* Stats */}
                        <div style={{ display: 'grid', gridTemplateColumns: 'repeat(auto-fit, minmax(200px, 1fr))', gap: '1rem', marginBottom: '1.5rem' }}>
                            <div style={{ padding: '1.5rem', background: 'var(--bg-dark)', borderRadius: '12px', border: '2px solid var(--success)' }}>
                                <div style={{ color: 'var(--text-muted)', fontSize: '0.85rem', marginBottom: '0.5rem' }}>Total Collected</div>
                                <div style={{ fontSize: '2rem', fontWeight: '800', fontFamily: "'JetBrains Mono', monospace", color: 'var(--success)' }}>
                                    ${totalCollected.toLocaleString(undefined, { minimumFractionDigits: 2 })}
                                </div>
                            </div>
                            <div style={{ padding: '1.5rem', background: 'var(--bg-dark)', borderRadius: '12px', border: '2px solid var(--warning)' }}>
                                <div style={{ color: 'var(--text-muted)', fontSize: '0.85rem', marginBottom: '0.5rem' }}>Pending</div>
                                <div style={{ fontSize: '2rem', fontWeight: '800', fontFamily: "'JetBrains Mono', monospace", color: 'var(--warning)' }}>
                                    ${totalPending.toLocaleString(undefined, { minimumFractionDigits: 2 })}
                                </div>
                            </div>
                            <div style={{ padding: '1.5rem', background: 'var(--bg-dark)', borderRadius: '12px', border: '2px solid var(--danger)' }}>
                                <div style={{ color: 'var(--text-muted)', fontSize: '0.85rem', marginBottom: '0.5rem' }}>Refunded</div>
                                <div style={{ fontSize: '2rem', fontWeight: '800', fontFamily: "'JetBrains Mono', monospace", color: 'var(--danger)' }}>
                                    ${totalRefunded.toLocaleString(undefined, { minimumFractionDigits: 2 })}
                                </div>
                            </div>
                            <div style={{ padding: '1.5rem', background: 'var(--bg-dark)', borderRadius: '12px', border: '2px solid var(--primary)' }}>
                                <div style={{ color: 'var(--text-muted)', fontSize: '0.85rem', marginBottom: '0.5rem' }}>Transactions</div>
                                <div style={{ fontSize: '2rem', fontWeight: '800', fontFamily: "'JetBrains Mono', monospace", color: 'var(--primary)' }}>
                                    {filteredPayments.length}
                                </div>
                            </div>
                        </div>

                        {/* Payments Table */}
                        <div className="table-container">
                            <table className="table">
                                <thead>
                                    <tr>
                                        <th>Payment ID</th>
                                        <th>Date</th>
                                        <th>Customer</th>
                                        <th>Order</th>
                                        <th>Method</th>
                                        <th>Amount</th>
                                        <th>Status</th>
                                        <th>Actions</th>
                                    </tr>
                                </thead>
                                <tbody>
                                    {filteredPayments.map(payment => (
                                        <tr key={payment.id}>
                                            <td><strong style={{ fontFamily: "'JetBrains Mono', monospace", fontSize: '0.85rem' }}>{payment.id}</strong></td>
                                            <td>{payment.date}</td>
                                            <td>
                                                <div style={{ fontWeight: '600' }}>{payment.customerName}</div>
                                                <div style={{ fontSize: '0.75rem', color: 'var(--text-muted)' }}>{payment.customerId}</div>
                                            </td>
                                            <td style={{ fontFamily: "'JetBrains Mono', monospace", fontSize: '0.85rem' }}>{payment.orderId || '-'}</td>
                                            <td>
                                                <div style={{ display: 'flex', alignItems: 'center', gap: '0.5rem' }}>
                                                    <span>{payment.type === 'Visa' ? 'üí≥' : payment.type === 'Mastercard' ? 'üí≥' : 'üè¶'}</span>
                                                    <div>
                                                        <div style={{ fontSize: '0.85rem' }}>{payment.type}</div>
                                                        <div style={{ fontSize: '0.75rem', color: 'var(--text-muted)', fontFamily: "'JetBrains Mono', monospace" }}>
                                                            ‚Ä¢‚Ä¢‚Ä¢‚Ä¢ {payment.last4}
                                                        </div>
                                                    </div>
                                                </div>
                                            </td>
                                            <td style={{ fontFamily: "'JetBrains Mono', monospace", fontWeight: '700', fontSize: '1rem', color: 'var(--success)' }}>
                                                ${payment.amount.toFixed(2)}
                                            </td>
                                            <td>
                                                <span className={`badge badge-${
                                                    payment.status === 'Completed' ? 'success' :
                                                    payment.status === 'Pending' ? 'warning' :
                                                    payment.status === 'Refunded' ? 'danger' : 'secondary'
                                                }`}>
                                                    {payment.status}
                                                </span>
                                            </td>
                                            <td>
                                                <div style={{ display: 'flex', gap: '0.5rem' }}>
                                                    <button className="btn btn-sm btn-secondary" onClick={() => setSelectedPayment(payment)}>View</button>
                                                    {payment.status === 'Completed' && (
                                                        <button className="btn btn-sm btn-danger" onClick={() => { setSelectedPayment(payment); setShowRefundModal(true); }}>Refund</button>
                                                    )}
                                                </div>
                                            </td>
                                        </tr>
                                    ))}
                                </tbody>
                            </table>
                        </div>
                    </div>

                    {/* Payment Detail Modal */}
                    {selectedPayment && !showRefundModal && (
                        <div className="modal-overlay" onClick={() => setSelectedPayment(null)}>
                            <div className="modal" onClick={(e) => e.stopPropagation()} style={{ maxWidth: '500px' }}>
                                <div className="modal-header">
                                    <h2 className="modal-title">üí≥ Payment Details</h2>
                                    <button className="modal-close" onClick={() => setSelectedPayment(null)}>√ó</button>
                                </div>
                                <div style={{ padding: '1rem 0' }}>
                                    <div style={{ background: 'var(--bg-dark)', padding: '1.5rem', borderRadius: '12px', textAlign: 'center', marginBottom: '1rem' }}>
                                        <div style={{ color: 'var(--text-muted)', marginBottom: '0.5rem' }}>Amount</div>
                                        <div style={{ fontSize: '2.5rem', fontWeight: '800', color: 'var(--success)' }}>
                                            ${selectedPayment.amount.toFixed(2)}
                                        </div>
                                        <span className={`badge badge-${selectedPayment.status === 'Completed' ? 'success' : 'warning'}`}>
                                            {selectedPayment.status}
                                        </span>
                                    </div>
                                    <div style={{ display: 'grid', gap: '0.75rem' }}>
                                        <div style={{ display: 'flex', justifyContent: 'space-between' }}>
                                            <span style={{ color: 'var(--text-muted)' }}>Payment ID:</span>
                                            <span style={{ fontFamily: "'JetBrains Mono', monospace" }}>{selectedPayment.id}</span>
                                        </div>
                                        <div style={{ display: 'flex', justifyContent: 'space-between' }}>
                                            <span style={{ color: 'var(--text-muted)' }}>Date:</span>
                                            <span>{selectedPayment.date}</span>
                                        </div>
                                        <div style={{ display: 'flex', justifyContent: 'space-between' }}>
                                            <span style={{ color: 'var(--text-muted)' }}>Customer:</span>
                                            <span>{selectedPayment.customerName}</span>
                                        </div>
                                        <div style={{ display: 'flex', justifyContent: 'space-between' }}>
                                            <span style={{ color: 'var(--text-muted)' }}>Order:</span>
                                            <span style={{ fontFamily: "'JetBrains Mono', monospace" }}>{selectedPayment.orderId || '-'}</span>
                                        </div>
                                        <div style={{ display: 'flex', justifyContent: 'space-between' }}>
                                            <span style={{ color: 'var(--text-muted)' }}>Payment Method:</span>
                                            <span>{selectedPayment.type} ‚Ä¢‚Ä¢‚Ä¢‚Ä¢ {selectedPayment.last4}</span>
                                        </div>
                                    </div>
                                </div>
                                <div className="modal-footer">
                                    <button className="btn btn-secondary" onClick={() => setSelectedPayment(null)}>Close</button>
                                    <button className="btn btn-primary">üìß Email Receipt</button>
                                </div>
                            </div>
                        </div>
                    )}

                    {/* Refund Modal */}
                    {showRefundModal && selectedPayment && (
                        <div className="modal-overlay" onClick={() => { setShowRefundModal(false); setSelectedPayment(null); }}>
                            <div className="modal" onClick={(e) => e.stopPropagation()} style={{ maxWidth: '400px' }}>
                                <div className="modal-header">
                                    <h2 className="modal-title">‚ö†Ô∏è Process Refund</h2>
                                    <button className="modal-close" onClick={() => { setShowRefundModal(false); setSelectedPayment(null); }}>√ó</button>
                                </div>
                                <div style={{ padding: '1rem 0', textAlign: 'center' }}>
                                    <div style={{ fontSize: '3rem', marginBottom: '1rem' }}>üí∏</div>
                                    <p>Are you sure you want to refund this payment?</p>
                                    <div style={{ fontSize: '2rem', fontWeight: '800', color: 'var(--danger)', margin: '1rem 0' }}>
                                        ${selectedPayment.amount.toFixed(2)}
                                    </div>
                                    <p style={{ color: 'var(--text-muted)', fontSize: '0.9rem' }}>
                                        This will credit the customer's card ending in {selectedPayment.last4}
                                    </p>
                                </div>
                                <div className="modal-footer">
                                    <button className="btn btn-secondary" onClick={() => { setShowRefundModal(false); setSelectedPayment(null); }}>Cancel</button>
                                    <button 
                                        className="btn btn-danger"
                                        onClick={() => {
                                            alert(`Refund of $${selectedPayment.amount.toFixed(2)} processed successfully!`);
                                            setShowRefundModal(false);
                                            setSelectedPayment(null);
                                        }}
                                    >
                                        Process Refund
                                    </button>
                                </div>
                            </div>
                        </div>
                    )}
                </>
            );
        }

        function ReportsTab({ data }) {
            const [dateRange, setDateRange] = useState({
                startDate: '2026-01-01',
                endDate: '2026-01-15'
            });
            const [selectedReport, setSelectedReport] = useState('overview');
            const [selectedDC, setSelectedDC] = useState('all');

            const productUnitSpecs = {
                'SKU-20': { units: 4.7, price: 18.99 },
                'SKU-30': { units: 7.1, price: 24.99 },
                'SKU-33': { units: 7.8, price: 27.99 },
                'SKU-40': { units: 9.4, price: 34.99 },
                'SKU-100': { units: 23.6, price: 79.99 }
            };

            const calculateReportData = () => {
                const filteredRoutes = data.routes.filter(r => {
                    const dcMatch = selectedDC === 'all' || r.dcId === selectedDC;
                    return dcMatch;
                });

                let totalMiles = 0, totalRevenue = 0, totalCost = 0;
                let totalDeliveredUnits = {}, totalUnitsDistributed = 0;
                let customerDeliveries = {};

                filteredRoutes.forEach(route => {
                    totalMiles += route.totalDistance || 0;
                    totalRevenue += route.totalRevenue || 0;
                    totalCost += route.totalCost || 0;

                    if (route.initialLoad && route.currentLoad) {
                        Object.keys(route.initialLoad).forEach(cylType => {
                            const delivered = (route.initialLoad[cylType] || 0) - (route.currentLoad[cylType] || 0);
                            if (delivered > 0) {
                                totalDeliveredUnits[cylType] = (totalDeliveredUnits[cylType] || 0) + delivered;
                                if (productUnitSpecs[cylType]) {
                                    totalUnitsDistributed += delivered * productUnitSpecs[cylType].units;
                                }
                            }
                        });
                    }

                    route.stops?.forEach(stop => {
                        const order = data.orders.find(o => o.id === stop.orderId);
                        if (order) {
                            if (!customerDeliveries[order.customerId]) {
                                customerDeliveries[order.customerId] = { name: order.customer, deliveries: 0, totalVolume: 0, totalRevenue: 0 };
                            }
                            customerDeliveries[order.customerId].deliveries++;
                            customerDeliveries[order.customerId].totalVolume += order.volume || 0;
                            customerDeliveries[order.customerId].totalRevenue += order.revenue || 0;
                        }
                    });
                });

                const dcBreakdown = {};
                data.distributionCenters.forEach(dc => {
                    const dcRoutes = filteredRoutes.filter(r => r.dcId === dc.id);
                    dcBreakdown[dc.id] = {
                        name: dc.name, city: dc.city, state: dc.state,
                        routes: dcRoutes.length,
                        miles: dcRoutes.reduce((sum, r) => sum + (r.totalDistance || 0), 0),
                        revenue: dcRoutes.reduce((sum, r) => sum + (r.totalRevenue || 0), 0),
                        cost: dcRoutes.reduce((sum, r) => sum + (r.totalCost || 0), 0)
                    };
                });

                const driverPerformance = {};
                data.drivers.forEach(driver => {
                    const driverRoutes = filteredRoutes.filter(r => r.driverId === driver.id);
                    if (driverRoutes.length > 0) {
                        driverPerformance[driver.id] = {
                            name: driver.name,
                            routes: driverRoutes.length,
                            miles: driverRoutes.reduce((sum, r) => sum + (r.totalDistance || 0), 0),
                            hours: driverRoutes.reduce((sum, r) => sum + (r.totalDuration || 0), 0) / 60,
                            revenue: driverRoutes.reduce((sum, r) => sum + (r.totalRevenue || 0), 0)
                        };
                    }
                });

                return {
                    routes: filteredRoutes, totalMiles, totalRevenue, totalCost,
                    profit: totalRevenue - totalCost, routeCount: filteredRoutes.length,
                    totalDeliveredUnits, totalUnitsDistributed,
                    customerDeliveries: Object.values(customerDeliveries).sort((a, b) => b.totalRevenue - a.totalRevenue),
                    dcBreakdown, driverPerformance: Object.values(driverPerformance).sort((a, b) => b.revenue - a.revenue)
                };
            };

            const reportData = calculateReportData();

            return (
                <>
                    <div className="card">
                        <div className="card-header">
                            <h2 className="card-title">üìä Reporting & Analytics</h2>
                        </div>

                        <div style={{ display: 'flex', gap: '1rem', marginBottom: '1.5rem', flexWrap: 'wrap', alignItems: 'flex-end' }}>
                            <div className="form-group" style={{ margin: 0 }}>
                                <label className="form-label">Start Date</label>
                                <input type="date" className="form-input" value={dateRange.startDate}
                                    onChange={(e) => setDateRange(prev => ({ ...prev, startDate: e.target.value }))} />
                            </div>
                            <div className="form-group" style={{ margin: 0 }}>
                                <label className="form-label">End Date</label>
                                <input type="date" className="form-input" value={dateRange.endDate}
                                    onChange={(e) => setDateRange(prev => ({ ...prev, endDate: e.target.value }))} />
                            </div>
                            <div className="form-group" style={{ margin: 0 }}>
                                <label className="form-label">Distribution Center</label>
                                <select className="form-select" value={selectedDC} onChange={(e) => setSelectedDC(e.target.value)}>
                                    <option value="all">All Distribution Centers</option>
                                    {data.distributionCenters.map(dc => (
                                        <option key={dc.id} value={dc.id}>{dc.name}</option>
                                    ))}
                                </select>
                            </div>
                            <button className="btn btn-primary">üì• Export Report</button>
                        </div>

                        <div style={{ display: 'flex', gap: '0.5rem', marginBottom: '1.5rem', flexWrap: 'wrap' }}>
                            {[
                                { id: 'overview', label: 'üìà Overview' },
                                { id: 'distribution', label: 'üì¶ Distribution' },
                                { id: 'customers', label: 'üë• Customers' },
                                { id: 'drivers', label: 'üöõ Drivers' },
                                { id: 'payroll', label: 'üíµ Payroll' }
                            ].map(report => (
                                <button key={report.id}
                                    className={`btn btn-sm ${selectedReport === report.id ? 'btn-primary' : 'btn-secondary'}`}
                                    onClick={() => setSelectedReport(report.id)}>
                                    {report.label}
                                </button>
                            ))}
                        </div>

                        {selectedReport === 'overview' && (
                            <>
                                <div style={{ display: 'grid', gridTemplateColumns: 'repeat(auto-fit, minmax(180px, 1fr))', gap: '1rem', marginBottom: '2rem' }}>
                                    <div style={{ padding: '1.5rem', background: 'var(--bg-dark)', borderRadius: '12px', border: '2px solid var(--success)' }}>
                                        <div style={{ color: 'var(--text-muted)', fontSize: '0.85rem', marginBottom: '0.5rem' }}>Total Revenue</div>
                                        <div style={{ fontSize: '1.8rem', fontWeight: '800', fontFamily: "'JetBrains Mono', monospace", color: 'var(--success)' }}>
                                            ${reportData.totalRevenue.toLocaleString()}
                                        </div>
                                    </div>
                                    <div style={{ padding: '1.5rem', background: 'var(--bg-dark)', borderRadius: '12px', border: '2px solid var(--danger)' }}>
                                        <div style={{ color: 'var(--text-muted)', fontSize: '0.85rem', marginBottom: '0.5rem' }}>Total Cost</div>
                                        <div style={{ fontSize: '1.8rem', fontWeight: '800', fontFamily: "'JetBrains Mono', monospace", color: 'var(--danger)' }}>
                                            ${reportData.totalCost.toLocaleString()}
                                        </div>
                                    </div>
                                    <div style={{ padding: '1.5rem', background: 'var(--bg-dark)', borderRadius: '12px', border: `2px solid ${reportData.profit > 0 ? 'var(--success)' : 'var(--danger)'}` }}>
                                        <div style={{ color: 'var(--text-muted)', fontSize: '0.85rem', marginBottom: '0.5rem' }}>Net Profit</div>
                                        <div style={{ fontSize: '1.8rem', fontWeight: '800', fontFamily: "'JetBrains Mono', monospace", color: reportData.profit > 0 ? 'var(--success)' : 'var(--danger)' }}>
                                            ${reportData.profit.toLocaleString()}
                                        </div>
                                    </div>
                                    <div style={{ padding: '1.5rem', background: 'var(--bg-dark)', borderRadius: '12px', border: '2px solid var(--primary)' }}>
                                        <div style={{ color: 'var(--text-muted)', fontSize: '0.85rem', marginBottom: '0.5rem' }}>Total Routes</div>
                                        <div style={{ fontSize: '1.8rem', fontWeight: '800', fontFamily: "'JetBrains Mono', monospace", color: 'var(--primary)' }}>
                                            {reportData.routeCount}
                                        </div>
                                    </div>
                                    <div style={{ padding: '1.5rem', background: 'var(--bg-dark)', borderRadius: '12px', border: '2px solid var(--accent)' }}>
                                        <div style={{ color: 'var(--text-muted)', fontSize: '0.85rem', marginBottom: '0.5rem' }}>Total Miles</div>
                                        <div style={{ fontSize: '1.8rem', fontWeight: '800', fontFamily: "'JetBrains Mono', monospace", color: 'var(--accent)' }}>
                                            {reportData.totalMiles.toLocaleString()}
                                        </div>
                                    </div>
                                    <div style={{ padding: '1.5rem', background: 'var(--bg-dark)', borderRadius: '12px', border: '2px solid var(--warning)' }}>
                                        <div style={{ color: 'var(--text-muted)', fontSize: '0.85rem', marginBottom: '0.5rem' }}>Units Distributed</div>
                                        <div style={{ fontSize: '1.8rem', fontWeight: '800', fontFamily: "'JetBrains Mono', monospace", color: 'var(--warning)' }}>
                                            {reportData.totalUnitsDistributed.toFixed(0)}
                                        </div>
                                    </div>
                                </div>

                                <h3 style={{ fontSize: '1.1rem', fontWeight: '700', marginBottom: '1rem' }}>DC Performance</h3>
                                <div className="table-container">
                                    <table className="table">
                                        <thead><tr><th>Distribution Center</th><th>Routes</th><th>Miles</th><th>Revenue</th><th>Cost</th><th>Profit</th><th>Margin</th></tr></thead>
                                        <tbody>
                                            {Object.entries(reportData.dcBreakdown).map(([dcId, dc]) => {
                                                const profit = dc.revenue - dc.cost;
                                                const margin = dc.revenue > 0 ? (profit / dc.revenue * 100).toFixed(1) : 0;
                                                return (
                                                    <tr key={dcId}>
                                                        <td><strong>{dc.name}</strong><br/><span style={{ fontSize: '0.75rem', color: 'var(--text-muted)' }}>{dc.city}, {dc.state}</span></td>
                                                        <td>{dc.routes}</td>
                                                        <td>{dc.miles} mi</td>
                                                        <td style={{ color: 'var(--success)', fontWeight: '700' }}>${dc.revenue.toLocaleString()}</td>
                                                        <td style={{ color: 'var(--danger)' }}>${dc.cost.toLocaleString()}</td>
                                                        <td style={{ fontWeight: '700', color: profit > 0 ? 'var(--success)' : 'var(--danger)' }}>${profit.toLocaleString()}</td>
                                                        <td><span className={`badge badge-${margin > 30 ? 'success' : margin > 15 ? 'warning' : 'danger'}`}>{margin}%</span></td>
                                                    </tr>
                                                );
                                            })}
                                        </tbody>
                                    </table>
                                </div>
                            </>
                        )}

                        {selectedReport === 'distribution' && (
                            <>
                                <h3 style={{ fontSize: '1.1rem', fontWeight: '700', marginBottom: '1rem' }}>üì¶ Product Unit Distribution by Type</h3>
                                <div style={{ display: 'grid', gridTemplateColumns: 'repeat(auto-fit, minmax(180px, 1fr))', gap: '1rem', marginBottom: '2rem' }}>
                                    {Object.entries(reportData.totalDeliveredUnits).map(([cylType, count]) => {
                                        const spec = productUnitSpecs[cylType];
                                        const units = spec ? count * spec.units : 0;
                                        const revenue = spec ? count * spec.price : 0;
                                        return (
                                            <div key={cylType} style={{ padding: '1.5rem', background: 'var(--bg-dark)', borderRadius: '12px', border: '2px solid var(--border)' }}>
                                                <div style={{ fontWeight: '700', marginBottom: '0.5rem', color: 'var(--primary)' }}>{cylType}</div>
                                                <div style={{ fontSize: '2rem', fontWeight: '800', fontFamily: "'JetBrains Mono', monospace" }}>{count}</div>
                                                <div style={{ fontSize: '0.85rem', color: 'var(--text-muted)' }}>units delivered</div>
                                                <div style={{ fontSize: '0.9rem', color: 'var(--accent)', marginTop: '0.5rem' }}>{units.toFixed(1)} units</div>
                                                <div style={{ fontSize: '0.9rem', color: 'var(--success)', fontWeight: '700' }}>${revenue.toFixed(2)} revenue</div>
                                            </div>
                                        );
                                    })}
                                </div>
                                <div style={{ padding: '1.5rem', background: 'var(--bg-dark)', borderRadius: '12px', border: '2px solid var(--success)' }}>
                                    <div style={{ display: 'flex', justifyContent: 'space-between', alignItems: 'center' }}>
                                        <div>
                                            <div style={{ fontSize: '1rem', fontWeight: '700', marginBottom: '0.5rem' }}>Total Distribution Summary</div>
                                            <div style={{ color: 'var(--text-muted)' }}>All unit types combined</div>
                                        </div>
                                        <div style={{ textAlign: 'right' }}>
                                            <div style={{ fontSize: '2rem', fontWeight: '800', color: 'var(--success)', fontFamily: "'JetBrains Mono', monospace" }}>
                                                {reportData.totalUnitsDistributed.toFixed(1)} gal
                                            </div>
                                            <div style={{ color: 'var(--text-muted)' }}>Total product distributed</div>
                                        </div>
                                    </div>
                                </div>
                            </>
                        )}

                        {selectedReport === 'customers' && (
                            <>
                                <h3 style={{ fontSize: '1.1rem', fontWeight: '700', marginBottom: '1rem' }}>üë• Customer Usage Report</h3>
                                <div className="table-container">
                                    <table className="table">
                                        <thead><tr><th>Customer</th><th>Deliveries</th><th>Total Volume</th><th>Total Revenue</th><th>Avg per Delivery</th></tr></thead>
                                        <tbody>
                                            {reportData.customerDeliveries.map((customer, idx) => (
                                                <tr key={idx}>
                                                    <td><strong>{customer.name}</strong></td>
                                                    <td style={{ fontFamily: "'JetBrains Mono', monospace" }}>{customer.deliveries}</td>
                                                    <td style={{ fontFamily: "'JetBrains Mono', monospace", color: 'var(--accent)' }}>{customer.totalVolume.toLocaleString()} units</td>
                                                    <td style={{ fontFamily: "'JetBrains Mono', monospace", fontWeight: '700', color: 'var(--success)' }}>${customer.totalRevenue.toLocaleString()}</td>
                                                    <td style={{ fontFamily: "'JetBrains Mono', monospace" }}>${(customer.totalRevenue / customer.deliveries).toFixed(2)}</td>
                                                </tr>
                                            ))}
                                        </tbody>
                                    </table>
                                </div>
                            </>
                        )}

                        {selectedReport === 'drivers' && (
                            <>
                                <h3 style={{ fontSize: '1.1rem', fontWeight: '700', marginBottom: '1rem' }}>üöõ Driver Performance Report</h3>
                                <div className="table-container">
                                    <table className="table">
                                        <thead><tr><th>Driver</th><th>Routes</th><th>Miles</th><th>Hours</th><th>Revenue Generated</th><th>$/Mile</th></tr></thead>
                                        <tbody>
                                            {reportData.driverPerformance.map((driver, idx) => (
                                                <tr key={idx}>
                                                    <td><strong>{driver.name}</strong></td>
                                                    <td style={{ fontFamily: "'JetBrains Mono', monospace" }}>{driver.routes}</td>
                                                    <td style={{ fontFamily: "'JetBrains Mono', monospace" }}>{driver.miles} mi</td>
                                                    <td style={{ fontFamily: "'JetBrains Mono', monospace" }}>{driver.hours.toFixed(1)} hrs</td>
                                                    <td style={{ fontFamily: "'JetBrains Mono', monospace", fontWeight: '700', color: 'var(--success)' }}>${driver.revenue.toLocaleString()}</td>
                                                    <td style={{ fontFamily: "'JetBrains Mono', monospace", color: 'var(--accent)' }}>${(driver.revenue / driver.miles).toFixed(2)}</td>
                                                </tr>
                                            ))}
                                        </tbody>
                                    </table>
                                </div>
                            </>
                        )}

                        {selectedReport === 'payroll' && (
                            <>
                                <h3 style={{ fontSize: '1.1rem', fontWeight: '700', marginBottom: '1rem' }}>üíµ Payroll Summary Report</h3>
                                <div style={{ display: 'grid', gridTemplateColumns: 'repeat(auto-fit, minmax(200px, 1fr))', gap: '1rem', marginBottom: '2rem' }}>
                                    <div style={{ padding: '1.5rem', background: 'var(--bg-dark)', borderRadius: '12px', border: '2px solid var(--success)' }}>
                                        <div style={{ color: 'var(--text-muted)', fontSize: '0.85rem', marginBottom: '0.5rem' }}>Total YTD Gross Pay</div>
                                        <div style={{ fontSize: '1.8rem', fontWeight: '800', fontFamily: "'JetBrains Mono', monospace", color: 'var(--success)' }}>
                                            ${data.drivers.reduce((sum, d) => sum + (d.ytdEarnings?.grossPay || 0), 0).toLocaleString()}
                                        </div>
                                    </div>
                                    <div style={{ padding: '1.5rem', background: 'var(--bg-dark)', borderRadius: '12px', border: '2px solid var(--primary)' }}>
                                        <div style={{ color: 'var(--text-muted)', fontSize: '0.85rem', marginBottom: '0.5rem' }}>Total YTD Net Pay</div>
                                        <div style={{ fontSize: '1.8rem', fontWeight: '800', fontFamily: "'JetBrains Mono', monospace", color: 'var(--primary)' }}>
                                            ${data.drivers.reduce((sum, d) => sum + (d.ytdEarnings?.netPay || 0), 0).toLocaleString()}
                                        </div>
                                    </div>
                                    <div style={{ padding: '1.5rem', background: 'var(--bg-dark)', borderRadius: '12px', border: '2px solid var(--warning)' }}>
                                        <div style={{ color: 'var(--text-muted)', fontSize: '0.85rem', marginBottom: '0.5rem' }}>Total Overtime Hours</div>
                                        <div style={{ fontSize: '1.8rem', fontWeight: '800', fontFamily: "'JetBrains Mono', monospace", color: 'var(--warning)' }}>
                                            {data.drivers.reduce((sum, d) => sum + (d.ytdEarnings?.overtimeHours || 0), 0).toLocaleString()}
                                        </div>
                                    </div>
                                    <div style={{ padding: '1.5rem', background: 'var(--bg-dark)', borderRadius: '12px', border: '2px solid var(--danger)' }}>
                                        <div style={{ color: 'var(--text-muted)', fontSize: '0.85rem', marginBottom: '0.5rem' }}>Total Taxes Withheld</div>
                                        <div style={{ fontSize: '1.8rem', fontWeight: '800', fontFamily: "'JetBrains Mono', monospace", color: 'var(--danger)' }}>
                                            ${data.drivers.reduce((sum, d) => sum + (d.ytdEarnings?.federalTax || 0) + (d.ytdEarnings?.stateTax || 0) + (d.ytdEarnings?.socialSecurity || 0) + (d.ytdEarnings?.medicare || 0), 0).toLocaleString()}
                                        </div>
                                    </div>
                                </div>
                                <div className="table-container">
                                    <table className="table">
                                        <thead><tr><th>Employee</th><th>Pay Frequency</th><th>Hourly Rate</th><th>YTD Gross</th><th>YTD OT Hours</th><th>YTD Taxes</th><th>YTD Net</th></tr></thead>
                                        <tbody>
                                            {data.drivers.map(driver => (
                                                <tr key={driver.id}>
                                                    <td><strong>{driver.name}</strong><br/><span style={{ fontSize: '0.75rem', color: 'var(--text-muted)' }}>{driver.payrollId}</span></td>
                                                    <td><span className="badge badge-info">{driver.payFrequency}</span></td>
                                                    <td style={{ fontFamily: "'JetBrains Mono', monospace" }}>${driver.hourlyRate}/hr</td>
                                                    <td style={{ fontFamily: "'JetBrains Mono', monospace", color: 'var(--success)', fontWeight: '700' }}>${driver.ytdEarnings?.grossPay?.toLocaleString()}</td>
                                                    <td style={{ fontFamily: "'JetBrains Mono', monospace", color: 'var(--warning)' }}>{driver.ytdEarnings?.overtimeHours}</td>
                                                    <td style={{ fontFamily: "'JetBrains Mono', monospace", color: 'var(--danger)' }}>
                                                        ${((driver.ytdEarnings?.federalTax || 0) + (driver.ytdEarnings?.stateTax || 0) + (driver.ytdEarnings?.socialSecurity || 0) + (driver.ytdEarnings?.medicare || 0)).toLocaleString()}
                                                    </td>
                                                    <td style={{ fontFamily: "'JetBrains Mono', monospace", color: 'var(--success)', fontWeight: '700' }}>${driver.ytdEarnings?.netPay?.toLocaleString()}</td>
                                                </tr>
                                            ))}
                                        </tbody>
                                    </table>
                                </div>
                            </>
                        )}
                    </div>
                </>
            );
        }

        function ManagementTab({ data, openModal, handleDelete, setDriverMode, driverMode }) {
            const [deleteConfirm, setDeleteConfirm] = useState(null);
            const [showBulkOrderModal, setShowBulkOrderModal] = useState(false);
            const [selectedDCForOrder, setSelectedDCForOrder] = useState(null);

            // Product Specifications
            const [productUnitSpecs, setProductUnitSpecs] = useState([
                {
                    id: 'SKU-20',
                    name: 'Small Unit (20)',
                    type: 'Standard',
                    productCapacity: 20, // lbs
                    productUnits: 4.7, // units
                    emptyWeight: 17, // lbs (tare weight)
                    fullWeight: 37, // lbs
                    height: 18, // inches
                    diameter: 12.5, // inches
                    waterCapacity: 47.6, // lbs
                    workingPressure: 312, // PSI
                    bottlesPerPallet: 48,
                    palletConfiguration: '8x6',
                    pricePerBottle: 18.99,
                    wholesaleCost: 8.50
                },
                {
                    id: 'SKU-30',
                    name: 'Medium Unit (30)',
                    type: 'Industrial',
                    productCapacity: 30,
                    productUnits: 7.1,
                    emptyWeight: 25,
                    fullWeight: 55,
                    height: 24,
                    diameter: 12.5,
                    waterCapacity: 71.4,
                    workingPressure: 312,
                    bottlesPerPallet: 36,
                    palletConfiguration: '6x6',
                    pricePerBottle: 24.99,
                    wholesaleCost: 12.00
                },
                {
                    id: 'SKU-33',
                    name: 'Medium Unit (33)',
                    type: 'Industrial Standard',
                    productCapacity: 33,
                    productUnits: 7.8,
                    emptyWeight: 28,
                    fullWeight: 61,
                    height: 26,
                    diameter: 12.5,
                    waterCapacity: 78.5,
                    workingPressure: 312,
                    bottlesPerPallet: 32,
                    palletConfiguration: '8x4',
                    pricePerBottle: 27.99,
                    wholesaleCost: 13.50
                },
                {
                    id: 'SKU-40',
                    name: 'Large Unit (40)',
                    type: 'Commercial',
                    productCapacity: 40,
                    productUnits: 9.4,
                    emptyWeight: 32,
                    fullWeight: 72,
                    height: 29,
                    diameter: 12.5,
                    waterCapacity: 95.2,
                    workingPressure: 312,
                    bottlesPerPallet: 28,
                    palletConfiguration: '7x4',
                    pricePerBottle: 34.99,
                    wholesaleCost: 16.00
                },
                {
                    id: 'SKU-100',
                    name: 'XL Unit (100)',
                    type: 'Commercial Large',
                    productCapacity: 100,
                    productUnits: 23.6,
                    emptyWeight: 67,
                    fullWeight: 167,
                    height: 48,
                    diameter: 14.5,
                    waterCapacity: 239,
                    workingPressure: 312,
                    bottlesPerPallet: 9,
                    palletConfiguration: '3x3',
                    pricePerBottle: 79.99,
                    wholesaleCost: 38.00
                },
                {
                    id: 'SKU-420',
                    name: '4Small Unit (20)',
                    type: 'Bulk Industrial',
                    productCapacity: 420,
                    productUnits: 100,
                    emptyWeight: 285,
                    fullWeight: 705,
                    height: 52,
                    diameter: 30,
                    waterCapacity: 1000,
                    workingPressure: 312,
                    bottlesPerPallet: 1,
                    palletConfiguration: '1x1',
                    pricePerBottle: 299.99,
                    wholesaleCost: 145.00
                }
            ]);

            // Equipment Specifications
            const [equipmentSpecs] = useState({
                woodenPallet: {
                    name: 'Standard Wooden Pallet',
                    weight: 45, // lbs
                    dimensions: '48" x 40" x 6"',
                    maxLoadCapacity: 2500, // lbs
                    costPerPallet: 15.00
                },
                plasticPallet: {
                    name: 'Plastic Pallet',
                    weight: 35,
                    dimensions: '48" x 40" x 6"',
                    maxLoadCapacity: 2800,
                    costPerPallet: 45.00
                },
                cageRack: {
                    name: 'Product Unit Cage Rack',
                    weight: 125,
                    dimensions: '48" x 48" x 60"',
                    maxBottles: 48,
                    costPerRack: 285.00
                },
                deliveryTrailer: {
                    name: 'Delivery Trailer',
                    emptyWeight: 2800, // lbs
                    maxGVWR: 14000, // lbs
                    maxPayload: 11200, // lbs
                    length: 20, // feet
                    palletCapacity: 10
                },
                bobtailTruck: {
                    name: 'Bobtail Delivery Truck',
                    emptyWeight: 12000,
                    maxGVWR: 26000,
                    maxPayload: 14000,
                    tankCapacity: 2800, // units
                    pumpRate: 50 // units per minute
                }
            });

            // Distribution Center Inventory
            const [dcInventory, setDcInventory] = useState([
                {
                    dcId: 'DC-AL-001',
                    inventory: {
                        'SKU-20': { full: 450, empty: 120, reorderPoint: 200, maxCapacity: 800 },
                        'SKU-30': { full: 180, empty: 45, reorderPoint: 80, maxCapacity: 350 },
                        'SKU-33': { full: 220, empty: 60, reorderPoint: 100, maxCapacity: 400 },
                        'SKU-40': { full: 95, empty: 30, reorderPoint: 50, maxCapacity: 200 },
                        'SKU-100': { full: 35, empty: 15, reorderPoint: 20, maxCapacity: 80 }
                    },
                    bulkInventoryUnits: 8500,
                    bulkInventoryCapacity: 18000,
                    bulkReorderPoint: 6000,
                    lastBulkDelivery: '2026-01-10',
                    nextScheduledDelivery: '2026-01-18'
                },
                {
                    dcId: 'DC-AL-002',
                    inventory: {
                        'SKU-20': { full: 380, empty: 95, reorderPoint: 200, maxCapacity: 700 },
                        'SKU-30': { full: 150, empty: 40, reorderPoint: 80, maxCapacity: 300 },
                        'SKU-33': { full: 175, empty: 55, reorderPoint: 100, maxCapacity: 350 },
                        'SKU-40': { full: 80, empty: 25, reorderPoint: 50, maxCapacity: 180 },
                        'SKU-100': { full: 28, empty: 12, reorderPoint: 20, maxCapacity: 70 }
                    },
                    bulkInventoryUnits: 7200,
                    bulkInventoryCapacity: 15000,
                    bulkReorderPoint: 5000,
                    lastBulkDelivery: '2026-01-12',
                    nextScheduledDelivery: '2026-01-20'
                },
                {
                    dcId: 'DC-GA-001',
                    inventory: {
                        'SKU-20': { full: 620, empty: 180, reorderPoint: 300, maxCapacity: 1200 },
                        'SKU-30': { full: 240, empty: 70, reorderPoint: 120, maxCapacity: 500 },
                        'SKU-33': { full: 310, empty: 85, reorderPoint: 150, maxCapacity: 600 },
                        'SKU-40': { full: 145, empty: 40, reorderPoint: 75, maxCapacity: 300 },
                        'SKU-100': { full: 52, empty: 20, reorderPoint: 30, maxCapacity: 120 }
                    },
                    bulkInventoryUnits: 12500,
                    bulkInventoryCapacity: 25000,
                    bulkReorderPoint: 8000,
                    lastBulkDelivery: '2026-01-08',
                    nextScheduledDelivery: '2026-01-16'
                },
                {
                    dcId: 'DC-FL-001',
                    inventory: {
                        'SKU-20': { full: 520, empty: 150, reorderPoint: 250, maxCapacity: 1000 },
                        'SKU-30': { full: 195, empty: 55, reorderPoint: 100, maxCapacity: 400 },
                        'SKU-33': { full: 260, empty: 75, reorderPoint: 125, maxCapacity: 500 },
                        'SKU-40': { full: 120, empty: 35, reorderPoint: 60, maxCapacity: 250 },
                        'SKU-100': { full: 45, empty: 18, reorderPoint: 25, maxCapacity: 100 }
                    },
                    bulkInventoryUnits: 9800,
                    bulkInventoryCapacity: 20000,
                    bulkReorderPoint: 7000,
                    lastBulkDelivery: '2026-01-11',
                    nextScheduledDelivery: '2026-01-19'
                },
                {
                    dcId: 'DC-FL-002',
                    inventory: {
                        'SKU-20': { full: 410, empty: 110, reorderPoint: 200, maxCapacity: 800 },
                        'SKU-30': { full: 165, empty: 45, reorderPoint: 80, maxCapacity: 350 },
                        'SKU-33': { full: 200, empty: 60, reorderPoint: 100, maxCapacity: 400 },
                        'SKU-40': { full: 90, empty: 28, reorderPoint: 50, maxCapacity: 200 },
                        'SKU-100': { full: 32, empty: 14, reorderPoint: 20, maxCapacity: 80 }
                    },
                    bulkInventoryUnits: 6800,
                    bulkInventoryCapacity: 15000,
                    bulkReorderPoint: 5000,
                    lastBulkDelivery: '2026-01-13',
                    nextScheduledDelivery: '2026-01-21'
                },
                {
                    dcId: 'DC-TN-001',
                    inventory: {
                        'SKU-20': { full: 480, empty: 130, reorderPoint: 225, maxCapacity: 900 },
                        'SKU-30': { full: 175, empty: 50, reorderPoint: 90, maxCapacity: 375 },
                        'SKU-33': { full: 235, empty: 65, reorderPoint: 110, maxCapacity: 450 },
                        'SKU-40': { full: 105, empty: 32, reorderPoint: 55, maxCapacity: 220 },
                        'SKU-100': { full: 40, empty: 16, reorderPoint: 22, maxCapacity: 90 }
                    },
                    bulkInventoryUnits: 11200,
                    bulkInventoryCapacity: 20000,
                    bulkReorderPoint: 7000,
                    lastBulkDelivery: '2026-01-09',
                    nextScheduledDelivery: '2026-01-17'
                }
            ]);

            // Bulk Order Schedule
            const [bulkOrderSchedule, setBulkOrderSchedule] = useState([
                { id: 'BO-001', dcId: 'DC-GA-001', scheduledDate: '2026-01-16', units: 12000, status: 'Scheduled', supplier: 'Enterprise Products', poNumber: 'PO-2026-0116' },
                { id: 'BO-002', dcId: 'DC-TN-001', scheduledDate: '2026-01-17', units: 8000, status: 'Scheduled', supplier: 'AmeriGas', poNumber: 'PO-2026-0117' },
                { id: 'BO-003', dcId: 'DC-AL-001', scheduledDate: '2026-01-18', units: 10000, status: 'Scheduled', supplier: 'Ferrellgas', poNumber: 'PO-2026-0118' },
                { id: 'BO-004', dcId: 'DC-FL-001', scheduledDate: '2026-01-19', units: 9000, status: 'Pending Approval', supplier: 'Regional Supplier', poNumber: 'PO-2026-0119' },
                { id: 'BO-005', dcId: 'DC-AL-002', scheduledDate: '2026-01-20', units: 7500, status: 'Pending Approval', supplier: 'AmeriGas', poNumber: 'PO-2026-0120' },
                { id: 'BO-006', dcId: 'DC-FL-002', scheduledDate: '2026-01-21', units: 8000, status: 'Draft', supplier: 'Enterprise Products', poNumber: '' }
            ]);

            // Bulk product price per unit
            const BULK_PRODUCT_PRICE = 1.25;

            // Calculate total product in inventory for a DC
            const calculateDCProductTotal = (dcInv) => {
                let totalUnits = dcInv.bulkInventoryUnits;
                Object.entries(dcInv.inventory).forEach(([cylId, inv]) => {
                    const spec = productUnitSpecs.find(s => s.id === cylId);
                    if (spec) {
                        totalUnits += inv.full * spec.productUnits;
                    }
                });
                return totalUnits;
            };

            // Calculate load weight for order
            const calculateLoadWeight = (orderBottles, includePallets = true) => {
                let totalWeight = 0;
                let palletCount = 0;
                
                Object.entries(orderBottles).forEach(([cylId, count]) => {
                    const spec = productUnitSpecs.find(s => s.id === cylId);
                    if (spec && count > 0) {
                        totalWeight += count * spec.fullWeight;
                        palletCount += Math.ceil(count / spec.bottlesPerPallet);
                    }
                });
                
                if (includePallets) {
                    totalWeight += palletCount * equipmentSpecs.woodenPallet.weight;
                }
                
                return { totalWeight, palletCount };
            };

            const [apiConnections, setApiConnections] = useState([
                {
                    id: 'API-001',
                    name: 'Verizon Connect (Fleetmatics)',
                    type: 'GPS Tracking',
                    status: 'Connected',
                    apiKey: 'vz_live_‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢3a7f',
                    endpoint: 'https://api.verizonconnect.com/v1',
                    lastSync: '2026-01-15 14:32:15',
                    features: ['Real-time GPS', 'Vehicle Diagnostics', 'Driver Behavior', 'Geofencing'],
                    description: 'Real-time truck location tracking and fleet telemetry'
                },
                {
                    id: 'API-002',
                    name: 'Samsara Fleet Management',
                    type: 'GPS Tracking',
                    status: 'Disconnected',
                    apiKey: '',
                    endpoint: 'https://api.samsara.com/fleet',
                    lastSync: null,
                    features: ['GPS Tracking', 'ELD Compliance', 'Camera Systems', 'Maintenance Tracking'],
                    description: 'Alternative fleet tracking and compliance solution'
                },
                {
                    id: 'API-003',
                    name: 'Geotab',
                    type: 'Telematics',
                    status: 'Disconnected',
                    apiKey: '',
                    endpoint: 'https://my.geotab.com/apiv1',
                    lastSync: null,
                    features: ['Vehicle Tracking', 'Fuel Management', 'Safety Monitoring', 'Route Optimization'],
                    description: 'Advanced telematics and fleet analytics'
                },
                {
                    id: 'API-004',
                    name: 'Google Maps Platform',
                    type: 'Mapping & Routing',
                    status: 'Connected',
                    apiKey: 'AIza‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢TyU9',
                    endpoint: 'https://maps.googleapis.com/maps/api',
                    lastSync: '2026-01-15 14:30:00',
                    features: ['Route Optimization', 'Distance Matrix', 'Geocoding', 'Traffic Data'],
                    description: 'Enhanced routing and distance calculations'
                },
                {
                    id: 'API-005',
                    name: 'Stripe Payment Processing',
                    type: 'Billing & Payments',
                    status: 'Disconnected',
                    apiKey: '',
                    endpoint: 'https://api.stripe.com/v1',
                    lastSync: null,
                    features: ['Payment Processing', 'Invoicing', 'Subscription Management', 'Analytics'],
                    description: 'Customer billing and payment automation'
                },
                {
                    id: 'API-006',
                    name: 'Twilio SMS',
                    type: 'Communications',
                    status: 'Connected',
                    apiKey: 'AC‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢8b2c',
                    endpoint: 'https://api.twilio.com/2010-04-01',
                    lastSync: '2026-01-15 14:28:45',
                    features: ['SMS Notifications', 'Delivery Alerts', 'Driver Communication', 'Customer Updates'],
                    description: 'Automated SMS notifications for deliveries and alerts'
                },
                {
                    id: 'API-007',
                    name: 'QuickBooks Online',
                    type: 'Accounting',
                    status: 'Disconnected',
                    apiKey: '',
                    endpoint: 'https://quickbooks.api.intuit.com/v3',
                    lastSync: null,
                    features: ['Invoice Sync', 'Expense Tracking', 'Financial Reports', 'Tax Management'],
                    description: 'Automated accounting and financial integration'
                },
                {
                    id: 'API-008',
                    name: 'Weather API',
                    type: 'Data Services',
                    status: 'Connected',
                    apiKey: 'wx_‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢9k3p',
                    endpoint: 'https://api.weatherapi.com/v1',
                    lastSync: '2026-01-15 14:35:00',
                    features: ['Real-time Weather', 'Route Conditions', 'Severe Alerts', 'Forecasts'],
                    description: 'Weather data for route planning and safety'
                }
            ]);
            const [selectedApi, setSelectedApi] = useState(null);
            const [showApiModal, setShowApiModal] = useState(false);

            const confirmDelete = (type, id, name) => {
                setDeleteConfirm({ type, id, name });
            };

            const executeDelete = () => {
                if (deleteConfirm) {
                    handleDelete(deleteConfirm.type, deleteConfirm.id);
                    setDeleteConfirm(null);
                }
            };

            const testConnection = (apiId) => {
                alert(`Testing connection to ${apiConnections.find(a => a.id === apiId)?.name}...\n\nIn production, this would validate the API credentials and test the connection.`);
            };

            const syncNow = (apiId) => {
                const api = apiConnections.find(a => a.id === apiId);
                alert(`Syncing data from ${api?.name}...\n\nThis would fetch latest data from the API.`);
                // Update last sync time
                setApiConnections(prev => prev.map(a => 
                    a.id === apiId ? { ...a, lastSync: new Date().toISOString().slice(0, 19).replace('T', ' ') } : a
                ));
            };

            const toggleConnection = (apiId) => {
                setApiConnections(prev => prev.map(a => 
                    a.id === apiId ? { 
                        ...a, 
                        status: a.status === 'Connected' ? 'Disconnected' : 'Connected',
                        lastSync: a.status === 'Disconnected' ? new Date().toISOString().slice(0, 19).replace('T', ' ') : null
                    } : a
                ));
            };

            return (
                <>
                    <div className="card">
                        <div className="card-header">
                            <h2 className="card-title">‚öôÔ∏è System Management</h2>
                            <div style={{ display: 'flex', gap: '0.5rem', flexWrap: 'wrap' }}>
                                <button 
                                    className={`btn ${driverMode ? 'btn-success' : 'btn-secondary'}`}
                                    onClick={() => setDriverMode(!driverMode)}
                                >
                                    {driverMode ? '‚úì Driver Mode Active' : 'üöõ Enable Driver Mode'}
                                </button>
                            </div>
                        </div>

                        <div style={{ display: 'grid', gridTemplateColumns: 'repeat(auto-fit, minmax(200px, 1fr))', gap: '1rem', marginBottom: '2rem' }}>
                            <div style={{ padding: '1rem', background: 'var(--bg-dark)', borderRadius: '12px', border: '2px solid var(--border)' }}>
                                <div style={{ color: 'var(--text-muted)', fontSize: '0.85rem', marginBottom: '0.5rem' }}>Total Customers</div>
                                <div style={{ fontSize: '2rem', fontWeight: '800', fontFamily: "'JetBrains Mono', monospace", color: 'var(--primary)' }}>
                                    {data.customers.length}
                                </div>
                            </div>
                            <div style={{ padding: '1rem', background: 'var(--bg-dark)', borderRadius: '12px', border: '2px solid var(--border)' }}>
                                <div style={{ color: 'var(--text-muted)', fontSize: '0.85rem', marginBottom: '0.5rem' }}>Total Trucks</div>
                                <div style={{ fontSize: '2rem', fontWeight: '800', fontFamily: "'JetBrains Mono', monospace", color: 'var(--accent)' }}>
                                    {data.trucks.length}
                                </div>
                            </div>
                            <div style={{ padding: '1rem', background: 'var(--bg-dark)', borderRadius: '12px', border: '2px solid var(--border)' }}>
                                <div style={{ color: 'var(--text-muted)', fontSize: '0.85rem', marginBottom: '0.5rem' }}>Total Drivers</div>
                                <div style={{ fontSize: '2rem', fontWeight: '800', fontFamily: "'JetBrains Mono', monospace", color: 'var(--success)' }}>
                                    {data.drivers.length}
                                </div>
                            </div>
                            <div style={{ padding: '1rem', background: 'var(--bg-dark)', borderRadius: '12px', border: '2px solid var(--border)' }}>
                                <div style={{ color: 'var(--text-muted)', fontSize: '0.85rem', marginBottom: '0.5rem' }}>Distribution Centers</div>
                                <div style={{ fontSize: '2rem', fontWeight: '800', fontFamily: "'JetBrains Mono', monospace", color: 'var(--secondary)' }}>
                                    {data.distributionCenters.length}
                                </div>
                            </div>
                            <div style={{ padding: '1rem', background: 'var(--bg-dark)', borderRadius: '12px', border: '2px solid var(--border)' }}>
                                <div style={{ color: 'var(--text-muted)', fontSize: '0.85rem', marginBottom: '0.5rem' }}>Active Routes</div>
                                <div style={{ fontSize: '2rem', fontWeight: '800', fontFamily: "'JetBrains Mono', monospace", color: 'var(--warning)' }}>
                                    {data.routes.length}
                                </div>
                            </div>
                            <div style={{ padding: '1rem', background: 'var(--bg-dark)', borderRadius: '12px', border: '2px solid var(--border)' }}>
                                <div style={{ color: 'var(--text-muted)', fontSize: '0.85rem', marginBottom: '0.5rem' }}>API Integrations</div>
                                <div style={{ fontSize: '2rem', fontWeight: '800', fontFamily: "'JetBrains Mono', monospace", color: 'var(--success)' }}>
                                    {apiConnections.filter(a => a.status === 'Connected').length}/{apiConnections.length}
                                </div>
                            </div>
                        </div>
                    </div>

                    {/* Product Specifications */}
                    <div className="card">
                        <div className="card-header">
                            <h2 className="card-title">üì¶ Product Specifications</h2>
                        </div>
                        <div className="table-container">
                            <table className="table">
                                <thead>
                                    <tr>
                                        <th>Product Unit Type</th>
                                        <th>Name</th>
                                        <th>Product (lbs)</th>
                                        <th>Product (gal)</th>
                                        <th>Empty Wt</th>
                                        <th>Full Wt</th>
                                        <th>Height</th>
                                        <th>Diameter</th>
                                        <th>Per Pallet</th>
                                        <th>Retail Price</th>
                                        <th>Wholesale</th>
                                        <th>Margin</th>
                                    </tr>
                                </thead>
                                <tbody>
                                    {productUnitSpecs.map(spec => {
                                        const margin = ((spec.pricePerBottle - spec.wholesaleCost) / spec.pricePerBottle * 100).toFixed(1);
                                        return (
                                            <tr key={spec.id}>
                                                <td><strong>{spec.id}</strong></td>
                                                <td>
                                                    <div>{spec.name}</div>
                                                    <div style={{ fontSize: '0.75rem', color: 'var(--text-muted)' }}>{spec.type}</div>
                                                </td>
                                                <td style={{ fontFamily: "'JetBrains Mono', monospace", fontWeight: '700', color: 'var(--primary)' }}>{spec.productCapacity} lbs</td>
                                                <td style={{ fontFamily: "'JetBrains Mono', monospace", color: 'var(--accent)' }}>{spec.productUnits} units</td>
                                                <td>{spec.emptyWeight} lbs</td>
                                                <td style={{ fontWeight: '700' }}>{spec.fullWeight} lbs</td>
                                                <td>{spec.height}"</td>
                                                <td>{spec.diameter}"</td>
                                                <td>
                                                    <div style={{ fontWeight: '700' }}>{spec.bottlesPerPallet}</div>
                                                    <div style={{ fontSize: '0.7rem', color: 'var(--text-muted)' }}>{spec.palletConfiguration}</div>
                                                </td>
                                                <td style={{ fontFamily: "'JetBrains Mono', monospace", fontWeight: '700', color: 'var(--success)' }}>${spec.pricePerBottle}</td>
                                                <td style={{ fontFamily: "'JetBrains Mono', monospace", color: 'var(--text-muted)' }}>${spec.wholesaleCost}</td>
                                                <td>
                                                    <span className={`badge badge-${margin > 50 ? 'success' : margin > 30 ? 'warning' : 'danger'}`}>
                                                        {margin}%
                                                    </span>
                                                </td>
                                            </tr>
                                        );
                                    })}
                                </tbody>
                            </table>
                        </div>

                        {/* Equipment Specifications */}
                        <h3 style={{ marginTop: '2rem', marginBottom: '1rem', fontSize: '1.1rem', fontWeight: '700', color: 'var(--secondary)' }}>
                            üì¶ Equipment & Trailer Specifications
                        </h3>
                        <div style={{ display: 'grid', gridTemplateColumns: 'repeat(auto-fit, minmax(280px, 1fr))', gap: '1rem' }}>
                            <div style={{ background: 'var(--bg-dark)', padding: '1rem', borderRadius: '12px', border: '2px solid var(--border)' }}>
                                <div style={{ fontWeight: '700', marginBottom: '0.75rem', color: 'var(--primary)' }}>ü™µ {equipmentSpecs.woodenPallet.name}</div>
                                <div style={{ display: 'grid', gap: '0.5rem', fontSize: '0.9rem' }}>
                                    <div style={{ display: 'flex', justifyContent: 'space-between' }}>
                                        <span style={{ color: 'var(--text-muted)' }}>Weight:</span>
                                        <span style={{ fontWeight: '700' }}>{equipmentSpecs.woodenPallet.weight} lbs</span>
                                    </div>
                                    <div style={{ display: 'flex', justifyContent: 'space-between' }}>
                                        <span style={{ color: 'var(--text-muted)' }}>Dimensions:</span>
                                        <span>{equipmentSpecs.woodenPallet.dimensions}</span>
                                    </div>
                                    <div style={{ display: 'flex', justifyContent: 'space-between' }}>
                                        <span style={{ color: 'var(--text-muted)' }}>Max Load:</span>
                                        <span style={{ fontWeight: '700' }}>{equipmentSpecs.woodenPallet.maxLoadCapacity.toLocaleString()} lbs</span>
                                    </div>
                                    <div style={{ display: 'flex', justifyContent: 'space-between' }}>
                                        <span style={{ color: 'var(--text-muted)' }}>Cost:</span>
                                        <span style={{ color: 'var(--success)' }}>${equipmentSpecs.woodenPallet.costPerPallet}</span>
                                    </div>
                                </div>
                            </div>

                            <div style={{ background: 'var(--bg-dark)', padding: '1rem', borderRadius: '12px', border: '2px solid var(--border)' }}>
                                <div style={{ fontWeight: '700', marginBottom: '0.75rem', color: 'var(--primary)' }}>üî≤ {equipmentSpecs.cageRack.name}</div>
                                <div style={{ display: 'grid', gap: '0.5rem', fontSize: '0.9rem' }}>
                                    <div style={{ display: 'flex', justifyContent: 'space-between' }}>
                                        <span style={{ color: 'var(--text-muted)' }}>Weight:</span>
                                        <span style={{ fontWeight: '700' }}>{equipmentSpecs.cageRack.weight} lbs</span>
                                    </div>
                                    <div style={{ display: 'flex', justifyContent: 'space-between' }}>
                                        <span style={{ color: 'var(--text-muted)' }}>Dimensions:</span>
                                        <span>{equipmentSpecs.cageRack.dimensions}</span>
                                    </div>
                                    <div style={{ display: 'flex', justifyContent: 'space-between' }}>
                                        <span style={{ color: 'var(--text-muted)' }}>Max Bottles:</span>
                                        <span style={{ fontWeight: '700' }}>{equipmentSpecs.cageRack.maxBottles}</span>
                                    </div>
                                    <div style={{ display: 'flex', justifyContent: 'space-between' }}>
                                        <span style={{ color: 'var(--text-muted)' }}>Cost:</span>
                                        <span style={{ color: 'var(--success)' }}>${equipmentSpecs.cageRack.costPerRack}</span>
                                    </div>
                                </div>
                            </div>

                            <div style={{ background: 'var(--bg-dark)', padding: '1rem', borderRadius: '12px', border: '2px solid var(--warning)' }}>
                                <div style={{ fontWeight: '700', marginBottom: '0.75rem', color: 'var(--warning)' }}>üöö {equipmentSpecs.deliveryTrailer.name}</div>
                                <div style={{ display: 'grid', gap: '0.5rem', fontSize: '0.9rem' }}>
                                    <div style={{ display: 'flex', justifyContent: 'space-between' }}>
                                        <span style={{ color: 'var(--text-muted)' }}>Empty Weight:</span>
                                        <span style={{ fontWeight: '700' }}>{equipmentSpecs.deliveryTrailer.emptyWeight.toLocaleString()} lbs</span>
                                    </div>
                                    <div style={{ display: 'flex', justifyContent: 'space-between' }}>
                                        <span style={{ color: 'var(--text-muted)' }}>Max GVWR:</span>
                                        <span style={{ fontWeight: '700' }}>{equipmentSpecs.deliveryTrailer.maxGVWR.toLocaleString()} lbs</span>
                                    </div>
                                    <div style={{ display: 'flex', justifyContent: 'space-between' }}>
                                        <span style={{ color: 'var(--text-muted)' }}>Max Payload:</span>
                                        <span style={{ fontWeight: '700', color: 'var(--success)' }}>{equipmentSpecs.deliveryTrailer.maxPayload.toLocaleString()} lbs</span>
                                    </div>
                                    <div style={{ display: 'flex', justifyContent: 'space-between' }}>
                                        <span style={{ color: 'var(--text-muted)' }}>Pallet Capacity:</span>
                                        <span style={{ fontWeight: '700' }}>{equipmentSpecs.deliveryTrailer.palletCapacity} pallets</span>
                                    </div>
                                </div>
                            </div>

                            <div style={{ background: 'var(--bg-dark)', padding: '1rem', borderRadius: '12px', border: '2px solid var(--accent)' }}>
                                <div style={{ fontWeight: '700', marginBottom: '0.75rem', color: 'var(--accent)' }}>üöõ {equipmentSpecs.bobtailTruck.name}</div>
                                <div style={{ display: 'grid', gap: '0.5rem', fontSize: '0.9rem' }}>
                                    <div style={{ display: 'flex', justifyContent: 'space-between' }}>
                                        <span style={{ color: 'var(--text-muted)' }}>Empty Weight:</span>
                                        <span style={{ fontWeight: '700' }}>{equipmentSpecs.bobtailTruck.emptyWeight.toLocaleString()} lbs</span>
                                    </div>
                                    <div style={{ display: 'flex', justifyContent: 'space-between' }}>
                                        <span style={{ color: 'var(--text-muted)' }}>Max GVWR:</span>
                                        <span style={{ fontWeight: '700' }}>{equipmentSpecs.bobtailTruck.maxGVWR.toLocaleString()} lbs</span>
                                    </div>
                                    <div style={{ display: 'flex', justifyContent: 'space-between' }}>
                                        <span style={{ color: 'var(--text-muted)' }}>Storage Capacity:</span>
                                        <span style={{ fontWeight: '700', color: 'var(--primary)' }}>{equipmentSpecs.bobtailTruck.tankCapacity.toLocaleString()} units</span>
                                    </div>
                                    <div style={{ display: 'flex', justifyContent: 'space-between' }}>
                                        <span style={{ color: 'var(--text-muted)' }}>Pump Rate:</span>
                                        <span style={{ fontWeight: '700' }}>{equipmentSpecs.bobtailTruck.pumpRate} gal/min</span>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>

                    {/* Distribution Center Inventory */}
                    <div className="card">
                        <div className="card-header">
                            <h2 className="card-title">üìä Distribution Center Inventory</h2>
                        </div>
                        
                        <div style={{ display: 'grid', gap: '1.5rem' }}>
                            {dcInventory.map(dcInv => {
                                const dc = data.distributionCenters.find(d => d.id === dcInv.dcId);
                                if (!dc) return null;
                                
                                const totalProduct = calculateDCProductTotal(dcInv);
                                const bulkPercent = (dcInv.bulkInventoryUnits / dcInv.bulkInventoryCapacity * 100).toFixed(1);
                                const needsReorder = dcInv.bulkInventoryUnits <= dcInv.bulkReorderPoint;
                                
                                return (
                                    <div 
                                        key={dcInv.dcId}
                                        style={{ 
                                            background: 'var(--bg-dark)', 
                                            padding: '1.5rem', 
                                            borderRadius: '12px', 
                                            border: `2px solid ${needsReorder ? 'var(--danger)' : 'var(--border)'}` 
                                        }}
                                    >
                                        <div style={{ display: 'flex', justifyContent: 'space-between', alignItems: 'center', marginBottom: '1rem', flexWrap: 'wrap', gap: '1rem' }}>
                                            <div>
                                                <h3 style={{ margin: 0, fontSize: '1.2rem', fontWeight: '700' }}>{dc.name}</h3>
                                                <div style={{ fontSize: '0.85rem', color: 'var(--text-muted)' }}>{dc.city}, {dc.state} ‚Ä¢ {dcInv.dcId}</div>
                                            </div>
                                            <div style={{ display: 'flex', gap: '0.5rem' }}>
                                                {needsReorder && (
                                                    <span className="badge badge-danger">‚ö†Ô∏è Reorder Needed</span>
                                                )}
                                                <button 
                                                    className="btn btn-sm btn-primary"
                                                    onClick={() => {
                                                        setSelectedDCForOrder(dcInv);
                                                        setShowBulkOrderModal(true);
                                                    }}
                                                >
                                                    üì¶ Order Bulk Product
                                                </button>
                                            </div>
                                        </div>

                                        {/* Bulk Inventory Status */}
                                        <div style={{ background: 'var(--bg-card)', padding: '1rem', borderRadius: '8px', marginBottom: '1rem' }}>
                                            <div style={{ display: 'flex', justifyContent: 'space-between', alignItems: 'center', marginBottom: '0.5rem' }}>
                                                <span style={{ fontWeight: '700' }}>Bulk Inventory Level</span>
                                                <span style={{ fontFamily: "'JetBrains Mono', monospace", fontWeight: '700', color: needsReorder ? 'var(--danger)' : 'var(--success)' }}>
                                                    {dcInv.bulkInventoryUnits.toLocaleString()} / {dcInv.bulkInventoryCapacity.toLocaleString()} units
                                                </span>
                                            </div>
                                            <div style={{ background: 'var(--bg-dark)', borderRadius: '8px', height: '24px', overflow: 'hidden' }}>
                                                <div style={{ 
                                                    width: `${bulkPercent}%`, 
                                                    height: '100%', 
                                                    background: needsReorder ? 'var(--danger)' : bulkPercent < 50 ? 'var(--warning)' : 'var(--success)',
                                                    transition: 'width 0.3s ease',
                                                    display: 'flex',
                                                    alignItems: 'center',
                                                    justifyContent: 'center',
                                                    fontWeight: '700',
                                                    fontSize: '0.85rem'
                                                }}>
                                                    {bulkPercent}%
                                                </div>
                                            </div>
                                            <div style={{ display: 'flex', justifyContent: 'space-between', marginTop: '0.5rem', fontSize: '0.8rem', color: 'var(--text-muted)' }}>
                                                <span>Reorder Point: {dcInv.bulkReorderPoint.toLocaleString()} units</span>
                                                <span>Last Delivery: {dcInv.lastBulkDelivery}</span>
                                                <span>Next Scheduled: {dcInv.nextScheduledDelivery}</span>
                                            </div>
                                        </div>

                                        {/* Product Unit Inventory */}
                                        <div className="table-container" style={{ margin: 0 }}>
                                            <table className="table" style={{ margin: 0 }}>
                                                <thead>
                                                    <tr>
                                                        <th>Product Unit</th>
                                                        <th>Full</th>
                                                        <th>Empty</th>
                                                        <th>Total</th>
                                                        <th>Reorder Pt</th>
                                                        <th>Max Cap</th>
                                                        <th>Product (gal)</th>
                                                        <th>Status</th>
                                                    </tr>
                                                </thead>
                                                <tbody>
                                                    {Object.entries(dcInv.inventory).map(([cylId, inv]) => {
                                                        const spec = productUnitSpecs.find(s => s.id === cylId);
                                                        if (!spec) return null;
                                                        const totalBottles = inv.full + inv.empty;
                                                        const productGal = inv.full * spec.productUnits;
                                                        const lowStock = inv.full <= inv.reorderPoint;
                                                        
                                                        return (
                                                            <tr key={cylId}>
                                                                <td>
                                                                    <strong>{spec.name}</strong>
                                                                    <div style={{ fontSize: '0.7rem', color: 'var(--text-muted)' }}>{cylId}</div>
                                                                </td>
                                                                <td style={{ fontFamily: "'JetBrains Mono', monospace", fontWeight: '700', color: 'var(--success)' }}>
                                                                    {inv.full}
                                                                </td>
                                                                <td style={{ fontFamily: "'JetBrains Mono', monospace", color: 'var(--text-muted)' }}>
                                                                    {inv.empty}
                                                                </td>
                                                                <td style={{ fontFamily: "'JetBrains Mono', monospace", fontWeight: '700' }}>
                                                                    {totalBottles}
                                                                </td>
                                                                <td style={{ fontFamily: "'JetBrains Mono', monospace" }}>
                                                                    {inv.reorderPoint}
                                                                </td>
                                                                <td style={{ fontFamily: "'JetBrains Mono', monospace" }}>
                                                                    {inv.maxCapacity}
                                                                </td>
                                                                <td style={{ fontFamily: "'JetBrains Mono', monospace", color: 'var(--primary)', fontWeight: '700' }}>
                                                                    {productGal.toFixed(1)}
                                                                </td>
                                                                <td>
                                                                    <span className={`badge badge-${lowStock ? 'danger' : 'success'}`}>
                                                                        {lowStock ? 'Low Stock' : 'OK'}
                                                                    </span>
                                                                </td>
                                                            </tr>
                                                        );
                                                    })}
                                                </tbody>
                                            </table>
                                        </div>
                                        
                                        <div style={{ display: 'flex', justifyContent: 'space-between', marginTop: '1rem', padding: '0.75rem', background: 'var(--bg-card)', borderRadius: '8px' }}>
                                            <span style={{ fontWeight: '700' }}>Total Product in Inventory:</span>
                                            <span style={{ fontFamily: "'JetBrains Mono', monospace", fontWeight: '800', fontSize: '1.1rem', color: 'var(--primary)' }}>
                                                {totalProduct.toLocaleString(undefined, { maximumFractionDigits: 1 })} units
                                            </span>
                                        </div>
                                    </div>
                                );
                            })}
                        </div>
                    </div>

                    {/* Bulk Order Schedule */}
                    <div className="card">
                        <div className="card-header">
                            <h2 className="card-title">üìÖ Bulk Product Order Schedule</h2>
                            <button className="btn btn-primary" onClick={() => {
                                setSelectedDCForOrder(null);
                                setShowBulkOrderModal(true);
                            }}>
                                + Schedule New Order
                            </button>
                        </div>
                        <div className="table-container">
                            <table className="table">
                                <thead>
                                    <tr>
                                        <th>Order ID</th>
                                        <th>Distribution Center</th>
                                        <th>Scheduled Date</th>
                                        <th>Units</th>
                                        <th>Est. Cost</th>
                                        <th>Supplier</th>
                                        <th>PO Number</th>
                                        <th>Status</th>
                                        <th>Actions</th>
                                    </tr>
                                </thead>
                                <tbody>
                                    {bulkOrderSchedule.map(order => {
                                        const dc = data.distributionCenters.find(d => d.id === order.dcId);
                                        const estCost = order.units * BULK_PRODUCT_PRICE;
                                        
                                        return (
                                            <tr key={order.id}>
                                                <td><strong>{order.id}</strong></td>
                                                <td>
                                                    <div>{dc?.name}</div>
                                                    <div style={{ fontSize: '0.75rem', color: 'var(--text-muted)' }}>{dc?.city}, {dc?.state}</div>
                                                </td>
                                                <td style={{ fontFamily: "'JetBrains Mono', monospace" }}>{order.scheduledDate}</td>
                                                <td style={{ fontFamily: "'JetBrains Mono', monospace", fontWeight: '700', color: 'var(--primary)' }}>
                                                    {order.units.toLocaleString()} units
                                                </td>
                                                <td style={{ fontFamily: "'JetBrains Mono', monospace", fontWeight: '700', color: 'var(--success)' }}>
                                                    ${estCost.toLocaleString()}
                                                </td>
                                                <td>{order.supplier}</td>
                                                <td style={{ fontFamily: "'JetBrains Mono', monospace", fontSize: '0.85rem' }}>
                                                    {order.poNumber || '-'}
                                                </td>
                                                <td>
                                                    <span className={`badge badge-${
                                                        order.status === 'Scheduled' ? 'success' :
                                                        order.status === 'Pending Approval' ? 'warning' :
                                                        order.status === 'Draft' ? 'secondary' :
                                                        order.status === 'Delivered' ? 'info' : 'danger'
                                                    }`}>
                                                        {order.status}
                                                    </span>
                                                </td>
                                                <td>
                                                    <div style={{ display: 'flex', gap: '0.5rem' }}>
                                                        {order.status === 'Draft' && (
                                                            <button className="btn btn-sm btn-success">Submit</button>
                                                        )}
                                                        {order.status === 'Pending Approval' && (
                                                            <button className="btn btn-sm btn-primary">Approve</button>
                                                        )}
                                                        <button className="btn btn-sm btn-secondary">Edit</button>
                                                    </div>
                                                </td>
                                            </tr>
                                        );
                                    })}
                                </tbody>
                            </table>
                        </div>
                        
                        <div style={{ display: 'grid', gridTemplateColumns: 'repeat(auto-fit, minmax(200px, 1fr))', gap: '1rem', marginTop: '1.5rem' }}>
                            <div style={{ padding: '1rem', background: 'var(--bg-dark)', borderRadius: '12px', border: '2px solid var(--border)' }}>
                                <div style={{ color: 'var(--text-muted)', fontSize: '0.85rem', marginBottom: '0.5rem' }}>Total Scheduled Orders</div>
                                <div style={{ fontSize: '2rem', fontWeight: '800', fontFamily: "'JetBrains Mono', monospace", color: 'var(--primary)' }}>
                                    {bulkOrderSchedule.length}
                                </div>
                            </div>
                            <div style={{ padding: '1rem', background: 'var(--bg-dark)', borderRadius: '12px', border: '2px solid var(--border)' }}>
                                <div style={{ color: 'var(--text-muted)', fontSize: '0.85rem', marginBottom: '0.5rem' }}>Total Units on Order</div>
                                <div style={{ fontSize: '2rem', fontWeight: '800', fontFamily: "'JetBrains Mono', monospace", color: 'var(--accent)' }}>
                                    {bulkOrderSchedule.reduce((sum, o) => sum + o.units, 0).toLocaleString()}
                                </div>
                            </div>
                            <div style={{ padding: '1rem', background: 'var(--bg-dark)', borderRadius: '12px', border: '2px solid var(--border)' }}>
                                <div style={{ color: 'var(--text-muted)', fontSize: '0.85rem', marginBottom: '0.5rem' }}>Estimated Total Cost</div>
                                <div style={{ fontSize: '2rem', fontWeight: '800', fontFamily: "'JetBrains Mono', monospace", color: 'var(--success)' }}>
                                    ${(bulkOrderSchedule.reduce((sum, o) => sum + o.units, 0) * BULK_PRODUCT_PRICE).toLocaleString()}
                                </div>
                            </div>
                            <div style={{ padding: '1rem', background: 'var(--bg-dark)', borderRadius: '12px', border: '2px solid var(--border)' }}>
                                <div style={{ color: 'var(--text-muted)', fontSize: '0.85rem', marginBottom: '0.5rem' }}>Bulk Price/Unit</div>
                                <div style={{ fontSize: '2rem', fontWeight: '800', fontFamily: "'JetBrains Mono', monospace", color: 'var(--warning)' }}>
                                    ${BULK_PRODUCT_PRICE}
                                </div>
                            </div>
                        </div>
                    </div>

                    {/* Bulk Order Modal */}
                    {showBulkOrderModal && (
                        <div className="modal-overlay" onClick={() => setShowBulkOrderModal(false)}>
                            <div className="modal" onClick={(e) => e.stopPropagation()} style={{ maxWidth: '600px' }}>
                                <div className="modal-header">
                                    <h2 className="modal-title">üì¶ Schedule Bulk Product Delivery</h2>
                                    <button className="modal-close" onClick={() => setShowBulkOrderModal(false)}>√ó</button>
                                </div>
                                <div style={{ padding: '1rem 0' }}>
                                    <div className="form-group">
                                        <label className="form-label">Distribution Center</label>
                                        <select className="form-select" defaultValue={selectedDCForOrder?.dcId || ''}>
                                            <option value="">Select Distribution Center</option>
                                            {data.distributionCenters.map(dc => (
                                                <option key={dc.id} value={dc.id}>{dc.name} - {dc.city}, {dc.state}</option>
                                            ))}
                                        </select>
                                    </div>

                                    <div className="form-row">
                                        <div className="form-group">
                                            <label className="form-label">Delivery Date</label>
                                            <input type="date" className="form-input" />
                                        </div>
                                        <div className="form-group">
                                            <label className="form-label">Units to Order</label>
                                            <input type="number" className="form-input" placeholder="10000" />
                                        </div>
                                    </div>

                                    <div className="form-group">
                                        <label className="form-label">Supplier</label>
                                        <select className="form-select">
                                            <option value="">Select Supplier</option>
                                            <option value="enterprise">Enterprise Products Partners</option>
                                            <option value="amerigas">AmeriGas Partners</option>
                                            <option value="ferrellgas">Ferrellgas Partners</option>
                                            <option value="suburban">Regional Supplier Partners</option>
                                            <option value="ngl">NGL Energy Partners</option>
                                        </select>
                                    </div>

                                    <div className="form-group">
                                        <label className="form-label">Priority Level</label>
                                        <select className="form-select">
                                            <option value="standard">Standard (3-5 business days)</option>
                                            <option value="expedited">Expedited (1-2 business days)</option>
                                            <option value="emergency">Emergency (Same/Next day) +15%</option>
                                        </select>
                                    </div>

                                    <div className="form-group">
                                        <label className="form-label">Notes</label>
                                        <textarea 
                                            className="form-input" 
                                            rows="3" 
                                            placeholder="Special delivery instructions, preferred time window, etc."
                                        />
                                    </div>

                                    {selectedDCForOrder && (
                                        <div style={{ background: 'var(--bg-dark)', padding: '1rem', borderRadius: '8px', marginTop: '1rem' }}>
                                            <div style={{ fontWeight: '700', marginBottom: '0.5rem' }}>Current Inventory Status</div>
                                            <div style={{ display: 'grid', gap: '0.5rem', fontSize: '0.9rem' }}>
                                                <div style={{ display: 'flex', justifyContent: 'space-between' }}>
                                                    <span style={{ color: 'var(--text-muted)' }}>Current Level:</span>
                                                    <span style={{ fontWeight: '700' }}>{selectedDCForOrder.bulkInventoryUnits.toLocaleString()} units</span>
                                                </div>
                                                <div style={{ display: 'flex', justifyContent: 'space-between' }}>
                                                    <span style={{ color: 'var(--text-muted)' }}>Storage Capacity:</span>
                                                    <span>{selectedDCForOrder.bulkInventoryCapacity.toLocaleString()} units</span>
                                                </div>
                                                <div style={{ display: 'flex', justifyContent: 'space-between' }}>
                                                    <span style={{ color: 'var(--text-muted)' }}>Available Space:</span>
                                                    <span style={{ fontWeight: '700', color: 'var(--success)' }}>
                                                        {(selectedDCForOrder.bulkInventoryCapacity - selectedDCForOrder.bulkInventoryUnits).toLocaleString()} units
                                                    </span>
                                                </div>
                                            </div>
                                        </div>
                                    )}
                                </div>
                                <div className="modal-footer">
                                    <button className="btn btn-secondary" onClick={() => setShowBulkOrderModal(false)}>
                                        Cancel
                                    </button>
                                    <button 
                                        className="btn btn-primary" 
                                        onClick={() => {
                                            alert('Bulk product order submitted for approval!');
                                            setShowBulkOrderModal(false);
                                        }}
                                    >
                                        Submit Order
                                    </button>
                                </div>
                            </div>
                        </div>
                    )}

                    <div className="card">
                        <div className="card-header">
                            <h2 className="card-title">üîå API Integration Management</h2>
                            <button className="btn btn-primary" onClick={() => setShowApiModal(true)}>
                                + Add API Connection
                            </button>
                        </div>

                        <div style={{ display: 'grid', gap: '1rem' }}>
                            {apiConnections.map(api => (
                                <div 
                                    key={api.id}
                                    style={{
                                        background: 'var(--bg-dark)',
                                        border: `2px solid ${api.status === 'Connected' ? 'var(--success)' : 'var(--border)'}`,
                                        borderRadius: '12px',
                                        padding: '1.5rem',
                                        transition: 'all 0.3s ease'
                                    }}
                                >
                                    <div style={{ display: 'flex', justifyContent: 'space-between', alignItems: 'flex-start', marginBottom: '1rem', flexWrap: 'wrap', gap: '1rem' }}>
                                        <div style={{ flex: 1, minWidth: '300px' }}>
                                            <div style={{ display: 'flex', alignItems: 'center', gap: '1rem', marginBottom: '0.5rem', flexWrap: 'wrap' }}>
                                                <h3 style={{ fontSize: '1.2rem', fontWeight: '700', margin: 0 }}>{api.name}</h3>
                                                <span className={`badge badge-${api.status === 'Connected' ? 'success' : 'warning'}`}>
                                                    {api.status}
                                                </span>
                                                <span className="badge badge-info">{api.type}</span>
                                            </div>
                                            <p style={{ color: 'var(--text-muted)', fontSize: '0.9rem', margin: '0.5rem 0' }}>
                                                {api.description}
                                            </p>
                                            <div style={{ display: 'flex', gap: '2rem', marginTop: '1rem', flexWrap: 'wrap' }}>
                                                <div>
                                                    <div style={{ fontSize: '0.75rem', color: 'var(--text-muted)', textTransform: 'uppercase', letterSpacing: '1px' }}>
                                                        Endpoint
                                                    </div>
                                                    <div style={{ fontFamily: "'JetBrains Mono', monospace", fontSize: '0.85rem', marginTop: '0.25rem', wordBreak: 'break-all' }}>
                                                        {api.endpoint}
                                                    </div>
                                                </div>
                                                {api.apiKey && (
                                                    <div>
                                                        <div style={{ fontSize: '0.75rem', color: 'var(--text-muted)', textTransform: 'uppercase', letterSpacing: '1px' }}>
                                                            API Key
                                                        </div>
                                                        <div style={{ fontFamily: "'JetBrains Mono', monospace", fontSize: '0.85rem', marginTop: '0.25rem' }}>
                                                            {api.apiKey}
                                                        </div>
                                                    </div>
                                                )}
                                                {api.lastSync && (
                                                    <div>
                                                        <div style={{ fontSize: '0.75rem', color: 'var(--text-muted)', textTransform: 'uppercase', letterSpacing: '1px' }}>
                                                            Last Sync
                                                        </div>
                                                        <div style={{ fontFamily: "'JetBrains Mono', monospace", fontSize: '0.85rem', marginTop: '0.25rem', color: 'var(--success)' }}>
                                                            {api.lastSync}
                                                        </div>
                                                    </div>
                                                )}
                                            </div>
                                            <div style={{ marginTop: '1rem' }}>
                                                <div style={{ fontSize: '0.75rem', color: 'var(--text-muted)', textTransform: 'uppercase', letterSpacing: '1px', marginBottom: '0.5rem' }}>
                                                    Features
                                                </div>
                                                <div style={{ display: 'flex', gap: '0.5rem', flexWrap: 'wrap' }}>
                                                    {api.features.map((feature, idx) => (
                                                        <span 
                                                            key={idx}
                                                            style={{
                                                                background: 'var(--bg-card)',
                                                                border: '1px solid var(--border)',
                                                                padding: '0.25rem 0.75rem',
                                                                borderRadius: '6px',
                                                                fontSize: '0.8rem'
                                                            }}
                                                        >
                                                            {feature}
                                                        </span>
                                                    ))}
                                                </div>
                                            </div>
                                        </div>
                                        <div style={{ display: 'flex', flexDirection: 'column', gap: '0.5rem' }}>
                                            <button 
                                                className={`btn btn-sm ${api.status === 'Connected' ? 'btn-danger' : 'btn-success'}`}
                                                onClick={() => toggleConnection(api.id)}
                                                style={{ minWidth: '120px' }}
                                            >
                                                {api.status === 'Connected' ? 'Disconnect' : 'Connect'}
                                            </button>
                                            {api.status === 'Connected' && (
                                                <>
                                                    <button 
                                                        className="btn btn-sm btn-secondary"
                                                        onClick={() => syncNow(api.id)}
                                                        style={{ minWidth: '120px' }}
                                                    >
                                                        Sync Now
                                                    </button>
                                                    <button 
                                                        className="btn btn-sm btn-secondary"
                                                        onClick={() => testConnection(api.id)}
                                                        style={{ minWidth: '120px' }}
                                                    >
                                                        Test Connection
                                                    </button>
                                                </>
                                            )}
                                            <button 
                                                className="btn btn-sm btn-secondary"
                                                onClick={() => setSelectedApi(api)}
                                                style={{ minWidth: '120px' }}
                                            >
                                                Configure
                                            </button>
                                        </div>
                                    </div>
                                </div>
                            ))}
                        </div>
                    </div>

                    <div className="card">
                        <div className="card-header">
                            <h2 className="card-title">üë• Manage Customers</h2>
                            <button className="btn btn-primary" onClick={() => openModal('customer')}>
                                + Add Customer
                            </button>
                        </div>
                        <div className="table-container">
                            <table className="table">
                                <thead>
                                    <tr>
                                        <th>ID</th>
                                        <th>Store ID</th>
                                        <th>Name</th>
                                        <th>State</th>
                                        <th>Status</th>
                                        <th>Actions</th>
                                    </tr>
                                </thead>
                                <tbody>
                                    {data.customers.map(customer => (
                                        <tr key={customer.id}>
                                            <td><strong>{customer.id}</strong></td>
                                            <td>{customer.storeId}</td>
                                            <td>{customer.name}</td>
                                            <td>{customer.state}</td>
                                            <td>
                                                <span className={`badge badge-${customer.status === 'Active' ? 'success' : 'warning'}`}>
                                                    {customer.status}
                                                </span>
                                            </td>
                                            <td>
                                                <div style={{ display: 'flex', gap: '0.5rem' }}>
                                                    <button 
                                                        className="btn btn-sm btn-secondary"
                                                        onClick={() => openModal('customer', customer)}
                                                    >
                                                        Edit
                                                    </button>
                                                    <button 
                                                        className="btn btn-sm btn-danger"
                                                        onClick={() => confirmDelete('customers', customer.id, customer.name)}
                                                    >
                                                        Delete
                                                    </button>
                                                </div>
                                            </td>
                                        </tr>
                                    ))}
                                </tbody>
                            </table>
                        </div>
                    </div>

                    <div className="card">
                        <div className="card-header">
                            <h2 className="card-title">üöõ Manage Trucks</h2>
                            <button className="btn btn-primary" onClick={() => openModal('truck')}>
                                + Add Truck
                            </button>
                        </div>
                        <div className="table-container">
                            <table className="table">
                                <thead>
                                    <tr>
                                        <th>ID</th>
                                        <th>Name</th>
                                        <th>GPS Device</th>
                                        <th>DC</th>
                                        <th>Capacity</th>
                                        <th>Status</th>
                                        <th>Actions</th>
                                    </tr>
                                </thead>
                                <tbody>
                                    {data.trucks.map(truck => {
                                        const dc = data.distributionCenters.find(d => d.id === truck.dcId);
                                        return (
                                            <tr key={truck.id}>
                                                <td><strong>{truck.id}</strong></td>
                                                <td>{truck.name}</td>
                                                <td>
                                                    <div style={{ fontSize: '0.85rem' }}>
                                                        <div style={{ 
                                                            fontFamily: "'JetBrains Mono', monospace",
                                                            color: truck.gpsDeviceId ? 'var(--success)' : 'var(--danger)'
                                                        }}>
                                                            {truck.gpsDeviceId || '‚ö† Not Mapped'}
                                                        </div>
                                                        {truck.gpsProvider && (
                                                            <div style={{ color: 'var(--text-muted)', fontSize: '0.75rem' }}>
                                                                {truck.gpsProvider}
                                                            </div>
                                                        )}
                                                    </div>
                                                </td>
                                                <td>{dc?.city}, {dc?.state}</td>
                                                <td>{truck.capacity} units</td>
                                                <td>
                                                    <span className={`badge badge-${truck.status === 'active' ? 'success' : 'warning'}`}>
                                                        {truck.status}
                                                    </span>
                                                </td>
                                                <td>
                                                    <div style={{ display: 'flex', gap: '0.5rem' }}>
                                                        <button 
                                                            className="btn btn-sm btn-secondary"
                                                            onClick={() => openModal('truck', truck)}
                                                        >
                                                            Edit
                                                        </button>
                                                        <button 
                                                            className="btn btn-sm btn-danger"
                                                            onClick={() => confirmDelete('trucks', truck.id, truck.name)}
                                                        >
                                                            Delete
                                                        </button>
                                                    </div>
                                                </td>
                                            </tr>
                                        );
                                    })}
                                </tbody>
                            </table>
                        </div>
                    </div>

                    <div className="card">
                        <div className="card-header">
                            <h2 className="card-title">üë®‚Äç‚úàÔ∏è Manage Drivers</h2>
                            <button className="btn btn-primary" onClick={() => openModal('driver')}>
                                + Add Driver
                            </button>
                        </div>
                        <div className="table-container">
                            <table className="table">
                                <thead>
                                    <tr>
                                        <th>ID</th>
                                        <th>Name</th>
                                        <th>License</th>
                                        <th>Hourly Rate</th>
                                        <th>Status</th>
                                        <th>Actions</th>
                                    </tr>
                                </thead>
                                <tbody>
                                    {data.drivers.map(driver => (
                                        <tr key={driver.id}>
                                            <td><strong>{driver.id}</strong></td>
                                            <td>{driver.name}</td>
                                            <td>{driver.licenseNumber}</td>
                                            <td>${driver.hourlyRate}/hr</td>
                                            <td>
                                                <span className={`badge badge-${
                                                    driver.status === 'available' ? 'success' :
                                                    driver.status === 'on-route' ? 'info' : 'warning'
                                                }`}>
                                                    {driver.status}
                                                </span>
                                            </td>
                                            <td>
                                                <div style={{ display: 'flex', gap: '0.5rem' }}>
                                                    <button 
                                                        className="btn btn-sm btn-secondary"
                                                        onClick={() => openModal('driver', driver)}
                                                    >
                                                        Edit
                                                    </button>
                                                    <button 
                                                        className="btn btn-sm btn-danger"
                                                        onClick={() => confirmDelete('drivers', driver.id, driver.name)}
                                                    >
                                                        Delete
                                                    </button>
                                                </div>
                                            </td>
                                        </tr>
                                    ))}
                                </tbody>
                            </table>
                        </div>
                    </div>

                    <div className="card">
                        <div className="card-header">
                            <h2 className="card-title">üè≠ Manage Distribution Centers</h2>
                            <button className="btn btn-primary" onClick={() => openModal('dc')}>
                                + Add DC
                            </button>
                        </div>
                        <div className="table-container">
                            <table className="table">
                                <thead>
                                    <tr>
                                        <th>ID</th>
                                        <th>Name</th>
                                        <th>Location</th>
                                        <th>Trucks</th>
                                        <th>Actions</th>
                                    </tr>
                                </thead>
                                <tbody>
                                    {data.distributionCenters.map(dc => {
                                        const dcTrucks = data.trucks.filter(t => t.dcId === dc.id);
                                        return (
                                            <tr key={dc.id}>
                                                <td><strong>{dc.id}</strong></td>
                                                <td>{dc.name}</td>
                                                <td>{dc.city}, {dc.state}</td>
                                                <td>{dcTrucks.length} trucks</td>
                                                <td>
                                                    <div style={{ display: 'flex', gap: '0.5rem' }}>
                                                        <button 
                                                            className="btn btn-sm btn-secondary"
                                                            onClick={() => openModal('dc', dc)}
                                                        >
                                                            Edit
                                                        </button>
                                                        <button 
                                                            className="btn btn-sm btn-danger"
                                                            onClick={() => confirmDelete('distributionCenters', dc.id, dc.name)}
                                                        >
                                                            Delete
                                                        </button>
                                                    </div>
                                                </td>
                                            </tr>
                                        );
                                    })}
                                </tbody>
                            </table>
                        </div>
                    </div>

                    <div className="card">
                        <div className="card-header">
                            <h2 className="card-title">üó∫Ô∏è Manage Routes</h2>
                            <button className="btn btn-primary" onClick={() => openModal('route')}>
                                + Add Route
                            </button>
                        </div>
                        <div className="table-container">
                            <table className="table">
                                <thead>
                                    <tr>
                                        <th>ID</th>
                                        <th>DC</th>
                                        <th>Truck</th>
                                        <th>Driver</th>
                                        <th>Date</th>
                                        <th>Status</th>
                                        <th>Actions</th>
                                    </tr>
                                </thead>
                                <tbody>
                                    {data.routes.map(route => {
                                        const dc = data.distributionCenters.find(d => d.id === route.dcId);
                                        const truck = data.trucks.find(t => t.id === route.truckId);
                                        const driver = data.drivers.find(d => d.id === route.driverId);
                                        return (
                                            <tr key={route.id}>
                                                <td><strong>{route.id}</strong></td>
                                                <td>{dc?.city}</td>
                                                <td>{truck?.name}</td>
                                                <td>{driver?.name}</td>
                                                <td>{route.date}</td>
                                                <td>
                                                    <span className={`badge badge-${
                                                        route.status === 'completed' ? 'success' :
                                                        route.status === 'in-progress' ? 'info' : 'warning'
                                                    }`}>
                                                        {route.status}
                                                    </span>
                                                </td>
                                                <td>
                                                    <div style={{ display: 'flex', gap: '0.5rem' }}>
                                                        <button 
                                                            className="btn btn-sm btn-secondary"
                                                            onClick={() => openModal('route', route)}
                                                        >
                                                            Edit
                                                        </button>
                                                        <button 
                                                            className="btn btn-sm btn-danger"
                                                            onClick={() => confirmDelete('routes', route.id, route.id)}
                                                        >
                                                            Delete
                                                        </button>
                                                    </div>
                                                </td>
                                            </tr>
                                        );
                                    })}
                                </tbody>
                            </table>
                        </div>
                    </div>

                    {selectedApi && (
                        <div className="modal-overlay" onClick={() => setSelectedApi(null)}>
                            <div className="modal" onClick={(e) => e.stopPropagation()} style={{ maxWidth: '700px' }}>
                                <div className="modal-header">
                                    <h2 className="modal-title">üîß Configure {selectedApi.name}</h2>
                                    <button className="modal-close" onClick={() => setSelectedApi(null)}>√ó</button>
                                </div>
                                <div style={{ padding: '1rem 0' }}>
                                    <div className="form-group">
                                        <label className="form-label">API Endpoint</label>
                                        <input 
                                            type="text"
                                            className="form-input"
                                            value={selectedApi.endpoint}
                                            readOnly
                                            style={{ background: 'var(--bg-hover)' }}
                                        />
                                    </div>
                                    <div className="form-group">
                                        <label className="form-label">API Key / Token</label>
                                        <input 
                                            type="text"
                                            className="form-input"
                                            placeholder="Enter your API key"
                                            defaultValue={selectedApi.apiKey}
                                        />
                                        <p style={{ fontSize: '0.85rem', color: 'var(--text-muted)', marginTop: '0.5rem' }}>
                                            Keep your API key secure. Never share it publicly.
                                        </p>
                                    </div>
                                    
                                    {selectedApi.name === 'Verizon Connect (Fleetmatics)' && (
                                        <>
                                            <div className="form-group">
                                                <label className="form-label">Account ID</label>
                                                <input 
                                                    type="text"
                                                    className="form-input"
                                                    placeholder="Your Verizon Connect Account ID"
                                                />
                                            </div>
                                            <div className="form-group">
                                                <label className="form-label">Sync Interval (minutes)</label>
                                                <select className="form-select">
                                                    <option value="1">Every 1 minute (Real-time)</option>
                                                    <option value="5" selected>Every 5 minutes</option>
                                                    <option value="15">Every 15 minutes</option>
                                                    <option value="30">Every 30 minutes</option>
                                                    <option value="60">Every hour</option>
                                                </select>
                                            </div>
                                            <div className="form-group">
                                                <label className="form-label">
                                                    <input type="checkbox" style={{ marginRight: '0.5rem' }} defaultChecked />
                                                    Enable automatic geofence alerts
                                                </label>
                                            </div>
                                            <div className="form-group">
                                                <label className="form-label">
                                                    <input type="checkbox" style={{ marginRight: '0.5rem' }} defaultChecked />
                                                    Track driver behavior metrics
                                                </label>
                                            </div>
                                            <div className="form-group">
                                                <label className="form-label">
                                                    <input type="checkbox" style={{ marginRight: '0.5rem' }} />
                                                    Send vehicle diagnostic alerts
                                                </label>
                                            </div>
                                        </>
                                    )}

                                    <div style={{ 
                                        background: 'var(--bg-dark)', 
                                        padding: '1rem', 
                                        borderRadius: '8px',
                                        border: '1px solid var(--border)',
                                        marginTop: '1.5rem'
                                    }}>
                                        <div style={{ fontWeight: '700', marginBottom: '0.75rem', fontSize: '0.9rem' }}>
                                            üìã Integration Documentation
                                        </div>
                                        <div style={{ fontSize: '0.85rem', color: 'var(--text-muted)', lineHeight: '1.6' }}>
                                            {selectedApi.name === 'Verizon Connect (Fleetmatics)' && (
                                                <>
                                                    <p style={{ marginBottom: '0.5rem' }}>
                                                        <strong>Setup Instructions:</strong>
                                                    </p>
                                                    <ol style={{ marginLeft: '1.5rem', marginBottom: '0.5rem' }}>
                                                        <li>Log into your Verizon Connect portal</li>
                                                        <li>Navigate to Settings ‚Üí API Access</li>
                                                        <li>Generate a new API key with "Read" permissions</li>
                                                        <li>Copy your Account ID from the dashboard</li>
                                                        <li>Paste both values above and click "Save & Test"</li>
                                                    </ol>
                                                    <p style={{ marginTop: '1rem' }}>
                                                        <strong>Data Synced:</strong> Real-time GPS coordinates, vehicle speed, 
                                                        engine status, fuel level, driver ID, geofence events, and trip history.
                                                    </p>
                                                </>
                                            )}
                                            {selectedApi.name === 'Google Maps Platform' && (
                                                <>
                                                    <p>Enable the following APIs in Google Cloud Console:</p>
                                                    <ul style={{ marginLeft: '1.5rem', marginTop: '0.5rem' }}>
                                                        <li>Maps JavaScript API</li>
                                                        <li>Routes API</li>
                                                        <li>Distance Matrix API</li>
                                                        <li>Geocoding API</li>
                                                    </ul>
                                                </>
                                            )}
                                            {!['Verizon Connect (Fleetmatics)', 'Google Maps Platform'].includes(selectedApi.name) && (
                                                <p>
                                                    Refer to the {selectedApi.name} documentation for detailed setup instructions
                                                    and API key generation process.
                                                </p>
                                            )}
                                        </div>
                                    </div>
                                </div>
                                <div className="modal-footer">
                                    <button 
                                        className="btn btn-secondary" 
                                        onClick={() => setSelectedApi(null)}
                                    >
                                        Cancel
                                    </button>
                                    <button 
                                        className="btn btn-primary" 
                                        onClick={() => {
                                            alert('API configuration saved successfully!');
                                            setSelectedApi(null);
                                        }}
                                    >
                                        Save & Test Connection
                                    </button>
                                </div>
                            </div>
                        </div>
                    )}

                    {showApiModal && (
                        <div className="modal-overlay" onClick={() => setShowApiModal(false)}>
                            <div className="modal" onClick={(e) => e.stopPropagation()}>
                                <div className="modal-header">
                                    <h2 className="modal-title">‚ûï Add New API Connection</h2>
                                    <button className="modal-close" onClick={() => setShowApiModal(false)}>√ó</button>
                                </div>
                                <div style={{ padding: '1rem 0' }}>
                                    <div className="form-group">
                                        <label className="form-label">API Provider</label>
                                        <select className="form-select">
                                            <option value="">Select a provider...</option>
                                            <option value="custom">Custom API</option>
                                            <option value="fleetio">Fleetio</option>
                                            <option value="motive">Motive (KeepTruckin)</option>
                                            <option value="teletrac">Teletrac Navman</option>
                                            <option value="omnitracs">Omnitracs</option>
                                            <option value="salesforce">Salesforce</option>
                                            <option value="hubspot">HubSpot CRM</option>
                                            <option value="zapier">Zapier Webhooks</option>
                                        </select>
                                    </div>
                                    <div className="form-group">
                                        <label className="form-label">API Name</label>
                                        <input 
                                            type="text"
                                            className="form-input"
                                            placeholder="e.g., Custom Fleet Tracker"
                                        />
                                    </div>
                                    <div className="form-group">
                                        <label className="form-label">API Endpoint URL</label>
                                        <input 
                                            type="text"
                                            className="form-input"
                                            placeholder="https://api.example.com/v1"
                                        />
                                    </div>
                                    <div className="form-group">
                                        <label className="form-label">API Key / Token</label>
                                        <input 
                                            type="password"
                                            className="form-input"
                                            placeholder="Enter your API key"
                                        />
                                    </div>
                                    <div className="form-group">
                                        <label className="form-label">Integration Type</label>
                                        <select className="form-select">
                                            <option value="gps">GPS Tracking</option>
                                            <option value="telematics">Telematics</option>
                                            <option value="mapping">Mapping & Routing</option>
                                            <option value="billing">Billing & Payments</option>
                                            <option value="communications">Communications</option>
                                            <option value="accounting">Accounting</option>
                                            <option value="crm">CRM</option>
                                            <option value="other">Other</option>
                                        </select>
                                    </div>
                                </div>
                                <div className="modal-footer">
                                    <button 
                                        className="btn btn-secondary" 
                                        onClick={() => setShowApiModal(false)}
                                    >
                                        Cancel
                                    </button>
                                    <button 
                                        className="btn btn-primary" 
                                        onClick={() => {
                                            alert('New API connection would be added here');
                                            setShowApiModal(false);
                                        }}
                                    >
                                        Add Connection
                                    </button>
                                </div>
                            </div>
                        </div>
                    )}

                    {deleteConfirm && (
                        <div className="modal-overlay" onClick={() => setDeleteConfirm(null)}>
                            <div className="modal" onClick={(e) => e.stopPropagation()}>
                                <div className="modal-header">
                                    <h2 className="modal-title">‚ö†Ô∏è Confirm Deletion</h2>
                                    <button className="modal-close" onClick={() => setDeleteConfirm(null)}>√ó</button>
                                </div>
                                <div style={{ padding: '1rem 0' }}>
                                    <p style={{ fontSize: '1.1rem', marginBottom: '1rem' }}>
                                        Are you sure you want to delete:
                                    </p>
                                    <p style={{ fontSize: '1.2rem', fontWeight: '700', color: 'var(--danger)' }}>
                                        {deleteConfirm.name}
                                    </p>
                                    <p style={{ color: 'var(--text-muted)', marginTop: '1rem', fontSize: '0.9rem' }}>
                                        This action cannot be undone.
                                    </p>
                                </div>
                                <div className="modal-footer">
                                    <button 
                                        className="btn btn-secondary" 
                                        onClick={() => setDeleteConfirm(null)}
                                    >
                                        Cancel
                                    </button>
                                    <button 
                                        className="btn btn-danger" 
                                        onClick={executeDelete}
                                    >
                                        Delete Permanently
                                    </button>
                                </div>
                            </div>
                        </div>
                    )}
                </>
            );
        }

        function Modal({ type, item, data, onClose, onSave }) {
            const [formData, setFormData] = useState(item || {});

            const handleChange = (e) => {
                const { name, value } = e.target;
                setFormData(prev => ({ ...prev, [name]: value }));
            };

            const handleSubmit = (e) => {
                e.preventDefault();
                onSave(
                    type === 'order' ? 'orders' :
                    type === 'route' ? 'routes' :
                    type === 'truck' ? 'trucks' :
                    type === 'driver' ? 'drivers' :
                    type === 'customer' ? 'customers' :
                    type === 'dc' ? 'distributionCenters' : '',
                    formData
                );
            };

            return (
                <div className="modal-overlay" onClick={onClose}>
                    <div className="modal" onClick={(e) => e.stopPropagation()}>
                        <div className="modal-header">
                            <h2 className="modal-title">
                                {item ? 'Edit' : 'New'} {
                                    type === 'order' ? 'Order' :
                                    type === 'route' ? 'Route' :
                                    type === 'truck' ? 'Truck' :
                                    type === 'driver' ? 'Driver' :
                                    type === 'customer' ? 'Customer' :
                                    type === 'dc' ? 'Distribution Center' : ''
                                }
                            </h2>
                            <button className="modal-close" onClick={onClose}>√ó</button>
                        </div>

                        <form onSubmit={handleSubmit}>
                            {type === 'order' && (
                                <>
                                    <div className="form-group">
                                        <label className="form-label">Select Customer</label>
                                        <select 
                                            name="customerId"
                                            className="form-select"
                                            value={formData.customerId || ''}
                                            onChange={(e) => {
                                                const selectedCustomer = data.customers.find(c => c.id === e.target.value);
                                                if (selectedCustomer) {
                                                    setFormData(prev => ({
                                                        ...prev,
                                                        customerId: selectedCustomer.id,
                                                        customer: selectedCustomer.name,
                                                        address: selectedCustomer.address,
                                                        lat: selectedCustomer.lat,
                                                        lng: selectedCustomer.lng,
                                                        state: selectedCustomer.state,
                                                        preferredDC: selectedCustomer.preferredDC
                                                    }));
                                                }
                                            }}
                                        >
                                            <option value="">Select Customer</option>
                                            {data.customers.map(customer => (
                                                <option key={customer.id} value={customer.id}>
                                                    {customer.name} - {customer.city}, {customer.state}
                                                </option>
                                            ))}
                                        </select>
                                    </div>
                                    <div className="form-group">
                                        <label className="form-label">Customer Name</label>
                                        <input 
                                            type="text" 
                                            name="customer"
                                            className="form-input"
                                            value={formData.customer || ''}
                                            onChange={handleChange}
                                            required
                                            disabled={formData.customerId}
                                        />
                                    </div>
                                    <div className="form-group">
                                        <label className="form-label">Delivery Address</label>
                                        <input 
                                            type="text" 
                                            name="address"
                                            className="form-input"
                                            value={formData.address || ''}
                                            onChange={handleChange}
                                            required
                                            disabled={formData.customerId}
                                        />
                                    </div>
                                    <div className="form-row">
                                        <div className="form-group">
                                            <label className="form-label">Latitude</label>
                                            <input 
                                                type="number" 
                                                step="0.0001"
                                                name="lat"
                                                className="form-input"
                                                value={formData.lat || ''}
                                                onChange={handleChange}
                                                placeholder="32.6099"
                                                disabled={formData.customerId}
                                            />
                                        </div>
                                        <div className="form-group">
                                            <label className="form-label">Longitude</label>
                                            <input 
                                                type="number" 
                                                step="0.0001"
                                                name="lng"
                                                className="form-input"
                                                value={formData.lng || ''}
                                                onChange={handleChange}
                                                placeholder="-85.4808"
                                                disabled={formData.customerId}
                                            />
                                        </div>
                                    </div>
                                    <div className="form-row">
                                        <div className="form-group">
                                            <label className="form-label">Volume (units)</label>
                                            <input 
                                                type="number" 
                                                name="volume"
                                                className="form-input"
                                                value={formData.volume || ''}
                                                onChange={handleChange}
                                                required
                                            />
                                        </div>
                                        <div className="form-group">
                                            <label className="form-label">Revenue ($)</label>
                                            <input 
                                                type="number" 
                                                name="revenue"
                                                className="form-input"
                                                value={formData.revenue || ''}
                                                onChange={handleChange}
                                                required
                                            />
                                        </div>
                                    </div>
                                    <div className="form-row">
                                        <div className="form-group">
                                            <label className="form-label">Priority</label>
                                            <select 
                                                name="priority"
                                                className="form-select"
                                                value={formData.priority || 'medium'}
                                                onChange={handleChange}
                                            >
                                                <option value="high">High</option>
                                                <option value="medium">Medium</option>
                                                <option value="low">Low</option>
                                            </select>
                                        </div>
                                        <div className="form-group">
                                            <label className="form-label">Delivery Date</label>
                                            <input 
                                                type="date" 
                                                name="deliveryDate"
                                                className="form-input"
                                                value={formData.deliveryDate || ''}
                                                onChange={handleChange}
                                                required
                                            />
                                        </div>
                                    </div>
                                    <div className="form-group">
                                        <label className="form-label">Status</label>
                                        <select 
                                            name="status"
                                            className="form-select"
                                            value={formData.status || 'pending'}
                                            onChange={handleChange}
                                        >
                                            <option value="pending">Pending</option>
                                            <option value="assigned">Assigned</option>
                                            <option value="completed">Completed</option>
                                        </select>
                                    </div>
                                </>
                            )}

                            {type === 'customer' && (
                                <>
                                    <div className="form-group">
                                        <label className="form-label">Store ID</label>
                                        <input 
                                            type="text" 
                                            name="storeId"
                                            className="form-input"
                                            value={formData.storeId || ''}
                                            onChange={handleChange}
                                            placeholder="STR-XX-XXX"
                                            required
                                        />
                                    </div>
                                    <div className="form-group">
                                        <label className="form-label">Customer Name</label>
                                        <input 
                                            type="text" 
                                            name="name"
                                            className="form-input"
                                            value={formData.name || ''}
                                            onChange={handleChange}
                                            required
                                        />
                                    </div>
                                    <div className="form-row">
                                        <div className="form-group">
                                            <label className="form-label">Contact Person</label>
                                            <input 
                                                type="text" 
                                                name="contactPerson"
                                                className="form-input"
                                                value={formData.contactPerson || ''}
                                                onChange={handleChange}
                                                required
                                            />
                                        </div>
                                        <div className="form-group">
                                            <label className="form-label">Account Type</label>
                                            <select 
                                                name="accountType"
                                                className="form-select"
                                                value={formData.accountType || ''}
                                                onChange={handleChange}
                                                required
                                            >
                                                <option value="">Select Type</option>
                                                <option value="Commercial">Commercial</option>
                                                <option value="Industrial">Industrial</option>
                                                <option value="Agricultural">Agricultural</option>
                                                <option value="Residential">Residential</option>
                                                <option value="Hospitality">Hospitality</option>
                                                <option value="Healthcare">Healthcare</option>
                                                <option value="Educational">Educational</option>
                                                <option value="Entertainment">Entertainment</option>
                                                <option value="Manufacturing">Manufacturing</option>
                                            </select>
                                        </div>
                                    </div>
                                    <div className="form-row">
                                        <div className="form-group">
                                            <label className="form-label">Email</label>
                                            <input 
                                                type="email" 
                                                name="email"
                                                className="form-input"
                                                value={formData.email || ''}
                                                onChange={handleChange}
                                                required
                                            />
                                        </div>
                                        <div className="form-group">
                                            <label className="form-label">Phone</label>
                                            <input 
                                                type="tel" 
                                                name="phone"
                                                className="form-input"
                                                value={formData.phone || ''}
                                                onChange={handleChange}
                                                placeholder="(XXX) XXX-XXXX"
                                                required
                                            />
                                        </div>
                                    </div>
                                    <div className="form-group">
                                        <label className="form-label">Address</label>
                                        <input 
                                            type="text" 
                                            name="address"
                                            className="form-input"
                                            value={formData.address || ''}
                                            onChange={handleChange}
                                            required
                                        />
                                    </div>
                                    <div className="form-row">
                                        <div className="form-group">
                                            <label className="form-label">City</label>
                                            <input 
                                                type="text" 
                                                name="city"
                                                className="form-input"
                                                value={formData.city || ''}
                                                onChange={handleChange}
                                                required
                                            />
                                        </div>
                                        <div className="form-group">
                                            <label className="form-label">State</label>
                                            <select 
                                                name="state"
                                                className="form-select"
                                                value={formData.state || ''}
                                                onChange={handleChange}
                                                required
                                            >
                                                <option value="">Select State</option>
                                                <option value="Alabama">Alabama</option>
                                                <option value="Florida">Florida</option>
                                                <option value="Georgia">Georgia</option>
                                                <option value="Kentucky">Kentucky</option>
                                                <option value="Louisiana">Louisiana</option>
                                                <option value="Mississippi">Mississippi</option>
                                                <option value="North Carolina">North Carolina</option>
                                                <option value="South Carolina">South Carolina</option>
                                                <option value="Tennessee">Tennessee</option>
                                            </select>
                                        </div>
                                        <div className="form-group">
                                            <label className="form-label">ZIP Code</label>
                                            <input 
                                                type="text" 
                                                name="zipCode"
                                                className="form-input"
                                                value={formData.zipCode || ''}
                                                onChange={handleChange}
                                                required
                                            />
                                        </div>
                                    </div>
                                    <div className="form-row">
                                        <div className="form-group">
                                            <label className="form-label">Latitude</label>
                                            <input 
                                                type="number" 
                                                step="0.0001"
                                                name="lat"
                                                className="form-input"
                                                value={formData.lat || ''}
                                                onChange={handleChange}
                                                placeholder="32.6099"
                                            />
                                        </div>
                                        <div className="form-group">
                                            <label className="form-label">Longitude</label>
                                            <input 
                                                type="number" 
                                                step="0.0001"
                                                name="lng"
                                                className="form-input"
                                                value={formData.lng || ''}
                                                onChange={handleChange}
                                                placeholder="-85.4808"
                                            />
                                        </div>
                                    </div>
                                    <div className="form-group">
                                        <label className="form-label">Preferred Distribution Center</label>
                                        <select 
                                            name="preferredDC"
                                            className="form-select"
                                            value={formData.preferredDC || ''}
                                            onChange={handleChange}
                                            required
                                        >
                                            <option value="">Select DC</option>
                                            {data.distributionCenters.map(dc => (
                                                <option key={dc.id} value={dc.id}>{dc.name} - {dc.city}, {dc.state}</option>
                                            ))}
                                        </select>
                                    </div>
                                    <div className="form-group">
                                        <label className="form-label">Status</label>
                                        <select 
                                            name="status"
                                            className="form-select"
                                            value={formData.status || 'Active'}
                                            onChange={handleChange}
                                        >
                                            <option value="Active">Active</option>
                                            <option value="Inactive">Inactive</option>
                                        </select>
                                    </div>
                                </>
                            )}

                            {type === 'truck' && (
                                <>
                                    <div className="form-group">
                                        <label className="form-label">Truck Name</label>
                                        <input 
                                            type="text" 
                                            name="name"
                                            className="form-input"
                                            value={formData.name || ''}
                                            onChange={handleChange}
                                            required
                                        />
                                    </div>
                                    <div className="form-row">
                                        <div className="form-group">
                                            <label className="form-label">VIN Number</label>
                                            <input 
                                                type="text" 
                                                name="vin"
                                                className="form-input"
                                                value={formData.vin || ''}
                                                onChange={handleChange}
                                                placeholder="1HGBH41JXMN109186"
                                            />
                                        </div>
                                        <div className="form-group">
                                            <label className="form-label">License Plate</label>
                                            <input 
                                                type="text" 
                                                name="licensePlate"
                                                className="form-input"
                                                value={formData.licensePlate || ''}
                                                onChange={handleChange}
                                                placeholder="AL-TRK-001"
                                            />
                                        </div>
                                    </div>
                                    <div className="form-group">
                                        <label className="form-label">Capacity (units)</label>
                                        <input 
                                            type="number" 
                                            name="capacity"
                                            className="form-input"
                                            value={formData.capacity || ''}
                                            onChange={handleChange}
                                            required
                                        />
                                    </div>
                                    <div className="form-group">
                                        <label className="form-label">Distribution Center</label>
                                        <select 
                                            name="dcId"
                                            className="form-select"
                                            value={formData.dcId || ''}
                                            onChange={handleChange}
                                            required
                                        >
                                            <option value="">Select Center</option>
                                            {data.distributionCenters.map(dc => (
                                                <option key={dc.id} value={dc.id}>{dc.name}</option>
                                            ))}
                                        </select>
                                    </div>
                                    <div style={{ 
                                        background: 'var(--bg-dark)', 
                                        padding: '1rem', 
                                        borderRadius: '8px',
                                        border: '2px solid var(--border)',
                                        marginBottom: '1rem'
                                    }}>
                                        <div style={{ fontWeight: '700', marginBottom: '0.75rem', fontSize: '1rem', display: 'flex', alignItems: 'center', gap: '0.5rem' }}>
                                            üì° GPS Device Mapping
                                        </div>
                                        <div className="form-row">
                                            <div className="form-group">
                                                <label className="form-label">GPS Provider</label>
                                                <select 
                                                    name="gpsProvider"
                                                    className="form-select"
                                                    value={formData.gpsProvider || ''}
                                                    onChange={handleChange}
                                                >
                                                    <option value="">Select Provider</option>
                                                    <option value="Verizon Connect">Verizon Connect (Fleetmatics)</option>
                                                    <option value="Samsara">Samsara</option>
                                                    <option value="Geotab">Geotab</option>
                                                    <option value="Motive">Motive (KeepTruckin)</option>
                                                    <option value="Teletrac">Teletrac Navman</option>
                                                    <option value="Omnitracs">Omnitracs</option>
                                                    <option value="Other">Other</option>
                                                </select>
                                            </div>
                                            <div className="form-group">
                                                <label className="form-label">GPS Device ID</label>
                                                <input 
                                                    type="text" 
                                                    name="gpsDeviceId"
                                                    className="form-input"
                                                    value={formData.gpsDeviceId || ''}
                                                    onChange={handleChange}
                                                    placeholder="VZ-GPS-8473-AA"
                                                />
                                            </div>
                                        </div>
                                        <p style={{ fontSize: '0.85rem', color: 'var(--text-muted)', marginTop: '0.5rem' }}>
                                            üí° Map this truck to its GPS tracking device. The device ID should match the identifier in your GPS provider's system (e.g., Verizon Connect). This enables real-time location tracking on the map.
                                        </p>
                                    </div>
                                    <div style={{ 
                                        background: 'var(--bg-dark)', 
                                        padding: '1rem', 
                                        borderRadius: '8px',
                                        border: '2px solid var(--border)',
                                        marginBottom: '1rem'
                                    }}>
                                        <div style={{ fontWeight: '700', marginBottom: '0.75rem', fontSize: '1rem', display: 'flex', alignItems: 'center', gap: '0.5rem' }}>
                                            üí∞ Operating Costs
                                        </div>
                                        <div className="form-row">
                                            <div className="form-group">
                                                <label className="form-label">Fuel Efficiency (MPG)</label>
                                                <input 
                                                    type="number" 
                                                    step="0.1"
                                                    name="fuelMPG"
                                                    className="form-input"
                                                    value={formData.fuelMPG || ''}
                                                    onChange={handleChange}
                                                    placeholder="8.5"
                                                />
                                            </div>
                                            <div className="form-group">
                                                <label className="form-label">Maintenance Cost ($/mile)</label>
                                                <input 
                                                    type="number" 
                                                    step="0.01"
                                                    name="maintenanceCostPerMile"
                                                    className="form-input"
                                                    value={formData.maintenanceCostPerMile || ''}
                                                    onChange={handleChange}
                                                    placeholder="0.45"
                                                />
                                            </div>
                                            <div className="form-group">
                                                <label className="form-label">Insurance Cost ($/day)</label>
                                                <input 
                                                    type="number" 
                                                    step="0.01"
                                                    name="insuranceCostPerDay"
                                                    className="form-input"
                                                    value={formData.insuranceCostPerDay || ''}
                                                    onChange={handleChange}
                                                    placeholder="45.00"
                                                />
                                            </div>
                                        </div>
                                        <p style={{ fontSize: '0.85rem', color: 'var(--text-muted)', marginTop: '0.5rem' }}>
                                            üí° These costs are automatically used to calculate route profitability. Include typical fuel efficiency (MPG), maintenance cost per mile driven, and daily insurance premiums.
                                        </p>
                                    </div>
                                    <div className="form-group">
                                        <label className="form-label">Status</label>
                                        <select 
                                            name="status"
                                            className="form-select"
                                            value={formData.status || 'active'}
                                            onChange={handleChange}
                                        >
                                            <option value="active">Active</option>
                                            <option value="maintenance">Maintenance</option>
                                            <option value="inactive">Inactive</option>
                                        </select>
                                    </div>
                                </>
                            )}

                            {type === 'driver' && (
                                <>
                                    <h4 style={{ margin: '0 0 1rem 0', color: 'var(--primary)' }}>üìã Personal Information</h4>
                                    <div className="form-row">
                                        <div className="form-group">
                                            <label className="form-label">First Name</label>
                                            <input 
                                                type="text" 
                                                name="firstName"
                                                className="form-input"
                                                value={formData.firstName || ''}
                                                onChange={handleChange}
                                                required
                                            />
                                        </div>
                                        <div className="form-group">
                                            <label className="form-label">Last Name</label>
                                            <input 
                                                type="text" 
                                                name="lastName"
                                                className="form-input"
                                                value={formData.lastName || ''}
                                                onChange={handleChange}
                                                required
                                            />
                                        </div>
                                    </div>
                                    <div className="form-row">
                                        <div className="form-group">
                                            <label className="form-label">Email</label>
                                            <input 
                                                type="email" 
                                                name="email"
                                                className="form-input"
                                                value={formData.email || ''}
                                                onChange={handleChange}
                                                required
                                            />
                                        </div>
                                        <div className="form-group">
                                            <label className="form-label">Phone</label>
                                            <input 
                                                type="tel" 
                                                name="phone"
                                                className="form-input"
                                                value={formData.phone || ''}
                                                onChange={handleChange}
                                                placeholder="(XXX) XXX-XXXX"
                                                required
                                            />
                                        </div>
                                    </div>
                                    <div className="form-row">
                                        <div className="form-group">
                                            <label className="form-label">Date of Birth</label>
                                            <input 
                                                type="date" 
                                                name="dateOfBirth"
                                                className="form-input"
                                                value={formData.dateOfBirth || ''}
                                                onChange={handleChange}
                                                required
                                            />
                                        </div>
                                        <div className="form-group">
                                            <label className="form-label">SSN (Last 4 digits)</label>
                                            <input 
                                                type="text" 
                                                name="ssn"
                                                className="form-input"
                                                value={formData.ssn || ''}
                                                onChange={handleChange}
                                                placeholder="***-**-XXXX"
                                            />
                                        </div>
                                    </div>
                                    <div className="form-group">
                                        <label className="form-label">Address</label>
                                        <input 
                                            type="text" 
                                            name="address"
                                            className="form-input"
                                            value={formData.address || ''}
                                            onChange={handleChange}
                                        />
                                    </div>
                                    <div className="form-row">
                                        <div className="form-group">
                                            <label className="form-label">City</label>
                                            <input 
                                                type="text" 
                                                name="city"
                                                className="form-input"
                                                value={formData.city || ''}
                                                onChange={handleChange}
                                            />
                                        </div>
                                        <div className="form-group">
                                            <label className="form-label">State</label>
                                            <select 
                                                name="state"
                                                className="form-select"
                                                value={formData.state || ''}
                                                onChange={handleChange}
                                            >
                                                <option value="">Select State</option>
                                                <option value="Alabama">Alabama</option>
                                                <option value="Florida">Florida</option>
                                                <option value="Georgia">Georgia</option>
                                                <option value="Kentucky">Kentucky</option>
                                                <option value="Louisiana">Louisiana</option>
                                                <option value="Mississippi">Mississippi</option>
                                                <option value="North Carolina">North Carolina</option>
                                                <option value="South Carolina">South Carolina</option>
                                                <option value="Tennessee">Tennessee</option>
                                            </select>
                                        </div>
                                        <div className="form-group">
                                            <label className="form-label">ZIP</label>
                                            <input 
                                                type="text" 
                                                name="zipCode"
                                                className="form-input"
                                                value={formData.zipCode || ''}
                                                onChange={handleChange}
                                            />
                                        </div>
                                    </div>

                                    <h4 style={{ margin: '1.5rem 0 1rem 0', color: 'var(--danger)' }}>üö® Emergency Contact</h4>
                                    <div className="form-row">
                                        <div className="form-group">
                                            <label className="form-label">Emergency Contact Name</label>
                                            <input 
                                                type="text" 
                                                name="emergencyContact"
                                                className="form-input"
                                                value={formData.emergencyContact || ''}
                                                onChange={handleChange}
                                            />
                                        </div>
                                        <div className="form-group">
                                            <label className="form-label">Emergency Phone</label>
                                            <input 
                                                type="tel" 
                                                name="emergencyPhone"
                                                className="form-input"
                                                value={formData.emergencyPhone || ''}
                                                onChange={handleChange}
                                                placeholder="(XXX) XXX-XXXX"
                                            />
                                        </div>
                                    </div>

                                    <h4 style={{ margin: '1.5rem 0 1rem 0', color: 'var(--accent)' }}>üíº Employment Details</h4>
                                    <div className="form-row">
                                        <div className="form-group">
                                            <label className="form-label">Hire Date</label>
                                            <input 
                                                type="date" 
                                                name="hireDate"
                                                className="form-input"
                                                value={formData.hireDate || ''}
                                                onChange={handleChange}
                                            />
                                        </div>
                                        <div className="form-group">
                                            <label className="form-label">Employment Type</label>
                                            <select 
                                                name="employeeType"
                                                className="form-select"
                                                value={formData.employeeType || 'Full-Time'}
                                                onChange={handleChange}
                                            >
                                                <option value="Full-Time">Full-Time</option>
                                                <option value="Part-Time">Part-Time</option>
                                                <option value="Contract">Contract</option>
                                            </select>
                                        </div>
                                        <div className="form-group">
                                            <label className="form-label">Hourly Rate ($)</label>
                                            <input 
                                                type="number" 
                                                name="hourlyRate"
                                                className="form-input"
                                                value={formData.hourlyRate || ''}
                                                onChange={handleChange}
                                                required
                                            />
                                        </div>
                                    </div>

                                    <div style={{ background: 'var(--bg-dark)', padding: '1rem', borderRadius: '8px', border: '2px solid var(--success)', margin: '1.5rem 0 1rem 0' }}>
                                        <h4 style={{ margin: '0 0 1rem 0', color: 'var(--success)' }}>ü™™ CDL Information</h4>
                                        <div className="form-row">
                                            <div className="form-group">
                                                <label className="form-label">CDL License Number</label>
                                                <input 
                                                    type="text" 
                                                    name="licenseNumber"
                                                    className="form-input"
                                                    value={formData.licenseNumber || ''}
                                                    onChange={handleChange}
                                                    placeholder="CDL-XX-XXXXXX"
                                                    required
                                                />
                                            </div>
                                            <div className="form-group">
                                                <label className="form-label">License Class</label>
                                                <select 
                                                    name="licenseClass"
                                                    className="form-select"
                                                    value={formData.licenseClass || ''}
                                                    onChange={handleChange}
                                                    required
                                                >
                                                    <option value="">Select Class</option>
                                                    <option value="Class A">Class A</option>
                                                    <option value="Class B">Class B</option>
                                                    <option value="Class C">Class C</option>
                                                </select>
                                            </div>
                                        </div>
                                        <div className="form-row">
                                            <div className="form-group">
                                                <label className="form-label">License State</label>
                                                <select 
                                                    name="licenseState"
                                                    className="form-select"
                                                    value={formData.licenseState || ''}
                                                    onChange={handleChange}
                                                    required
                                                >
                                                    <option value="">Select State</option>
                                                    <option value="Alabama">Alabama</option>
                                                    <option value="Florida">Florida</option>
                                                    <option value="Georgia">Georgia</option>
                                                    <option value="Kentucky">Kentucky</option>
                                                    <option value="Louisiana">Louisiana</option>
                                                    <option value="Mississippi">Mississippi</option>
                                                    <option value="North Carolina">North Carolina</option>
                                                    <option value="South Carolina">South Carolina</option>
                                                    <option value="Tennessee">Tennessee</option>
                                                </select>
                                            </div>
                                            <div className="form-group">
                                                <label className="form-label">License Expiration</label>
                                                <input 
                                                    type="date" 
                                                    name="licenseExpiration"
                                                    className="form-input"
                                                    value={formData.licenseExpiration || ''}
                                                    onChange={handleChange}
                                                    required
                                                />
                                            </div>
                                        </div>
                                        <div className="form-group">
                                            <label className="form-label">Endorsements</label>
                                            <div style={{ display: 'grid', gridTemplateColumns: 'repeat(2, 1fr)', gap: '0.5rem' }}>
                                                <label style={{ display: 'flex', alignItems: 'center', gap: '0.5rem', cursor: 'pointer' }}>
                                                    <input type="checkbox" name="endorsement_safety" /> Safety (H)
                                                </label>
                                                <label style={{ display: 'flex', alignItems: 'center', gap: '0.5rem', cursor: 'pointer' }}>
                                                    <input type="checkbox" name="endorsement_cargo" /> Cargo (N)
                                                </label>
                                                <label style={{ display: 'flex', alignItems: 'center', gap: '0.5rem', cursor: 'pointer' }}>
                                                    <input type="checkbox" name="endorsement_doubles" /> Doubles/Triples (T)
                                                </label>
                                                <label style={{ display: 'flex', alignItems: 'center', gap: '0.5rem', cursor: 'pointer' }}>
                                                    <input type="checkbox" name="endorsement_passenger" /> Passenger (P)
                                                </label>
                                            </div>
                                        </div>
                                    </div>

                                    <div style={{ background: 'var(--bg-dark)', padding: '1rem', borderRadius: '8px', border: '2px solid var(--secondary)', marginBottom: '1rem' }}>
                                        <h4 style={{ margin: '0 0 1rem 0', color: 'var(--secondary)' }}>üè• Medical Certification</h4>
                                        <div className="form-row">
                                            <div className="form-group">
                                                <label className="form-label">Medical Card Expiration</label>
                                                <input 
                                                    type="date" 
                                                    name="medicalCardExpiration"
                                                    className="form-input"
                                                    value={formData.medicalCardExpiration || ''}
                                                    onChange={handleChange}
                                                />
                                            </div>
                                            <div className="form-group">
                                                <label className="form-label">Medical Card Status</label>
                                                <select 
                                                    name="medicalCardStatus"
                                                    className="form-select"
                                                    value={formData.medicalCardStatus || 'Valid'}
                                                    onChange={handleChange}
                                                >
                                                    <option value="Valid">Valid</option>
                                                    <option value="Expired">Expired</option>
                                                    <option value="Pending">Pending Renewal</option>
                                                </select>
                                            </div>
                                        </div>
                                    </div>

                                    <div className="form-group">
                                        <label className="form-label">Employment Status</label>
                                        <select 
                                            name="status"
                                            className="form-select"
                                            value={formData.status || 'available'}
                                            onChange={handleChange}
                                        >
                                            <option value="available">Available</option>
                                            <option value="on-route">On Route</option>
                                            <option value="off-duty">Off Duty</option>
                                        </select>
                                    </div>
                                </>
                            )}

                            {type === 'dc' && (
                                <>
                                    <div className="form-group">
                                        <label className="form-label">Center Name</label>
                                        <input 
                                            type="text" 
                                            name="name"
                                            className="form-input"
                                            value={formData.name || ''}
                                            onChange={handleChange}
                                            required
                                        />
                                    </div>
                                    <div className="form-group">
                                        <label className="form-label">Address</label>
                                        <input 
                                            type="text" 
                                            name="address"
                                            className="form-input"
                                            value={formData.address || ''}
                                            onChange={handleChange}
                                            required
                                        />
                                    </div>
                                    <div className="form-row">
                                        <div className="form-group">
                                            <label className="form-label">City</label>
                                            <input 
                                                type="text" 
                                                name="city"
                                                className="form-input"
                                                value={formData.city || ''}
                                                onChange={handleChange}
                                                required
                                            />
                                        </div>
                                        <div className="form-group">
                                            <label className="form-label">State</label>
                                            <select 
                                                name="state"
                                                className="form-select"
                                                value={formData.state || ''}
                                                onChange={handleChange}
                                                required
                                            >
                                                <option value="">Select State</option>
                                                <option value="Alabama">Alabama</option>
                                                <option value="Florida">Florida</option>
                                                <option value="Georgia">Georgia</option>
                                                <option value="Kentucky">Kentucky</option>
                                                <option value="Louisiana">Louisiana</option>
                                                <option value="Mississippi">Mississippi</option>
                                                <option value="North Carolina">North Carolina</option>
                                                <option value="South Carolina">South Carolina</option>
                                                <option value="Tennessee">Tennessee</option>
                                            </select>
                                        </div>
                                    </div>
                                    <div className="form-row">
                                        <div className="form-group">
                                            <label className="form-label">Latitude</label>
                                            <input 
                                                type="number" 
                                                step="0.0001"
                                                name="lat"
                                                className="form-input"
                                                value={formData.lat || ''}
                                                onChange={handleChange}
                                                placeholder="33.7490"
                                            />
                                        </div>
                                        <div className="form-group">
                                            <label className="form-label">Longitude</label>
                                            <input 
                                                type="number" 
                                                step="0.0001"
                                                name="lng"
                                                className="form-input"
                                                value={formData.lng || ''}
                                                onChange={handleChange}
                                                placeholder="-84.3880"
                                            />
                                        </div>
                                    </div>
                                </>
                            )}

                            {type === 'route' && (
                                <>
                                    <div className="form-group">
                                        <label className="form-label">Distribution Center</label>
                                        <select 
                                            name="dcId"
                                            className="form-select"
                                            value={formData.dcId || ''}
                                            onChange={handleChange}
                                            required
                                        >
                                            <option value="">Select Distribution Center</option>
                                            {data.distributionCenters.map(dc => (
                                                <option key={dc.id} value={dc.id}>{dc.name} - {dc.city}, {dc.state}</option>
                                            ))}
                                        </select>
                                    </div>
                                    <div className="form-row">
                                        <div className="form-group">
                                            <label className="form-label">Date</label>
                                            <input 
                                                type="date" 
                                                name="date"
                                                className="form-input"
                                                value={formData.date || ''}
                                                onChange={handleChange}
                                                required
                                            />
                                        </div>
                                        <div className="form-group">
                                            <label className="form-label">Start Time</label>
                                            <input 
                                                type="time" 
                                                name="startTime"
                                                className="form-input"
                                                value={formData.startTime || '08:00'}
                                                onChange={handleChange}
                                                required
                                            />
                                        </div>
                                    </div>
                                    <div className="form-row">
                                        <div className="form-group">
                                            <label className="form-label">Truck</label>
                                            <select 
                                                name="truckId"
                                                className="form-select"
                                                value={formData.truckId || ''}
                                                onChange={handleChange}
                                                required
                                            >
                                                <option value="">Select Truck</option>
                                                {data.trucks.filter(t => t.status === 'active' && (!formData.dcId || t.dcId === formData.dcId)).map(truck => (
                                                    <option key={truck.id} value={truck.id}>{truck.name}</option>
                                                ))}
                                            </select>
                                        </div>
                                        <div className="form-group">
                                            <label className="form-label">Driver</label>
                                            <select 
                                                name="driverId"
                                                className="form-select"
                                                value={formData.driverId || ''}
                                                onChange={handleChange}
                                                required
                                            >
                                                <option value="">Select Driver</option>
                                                {data.drivers.filter(d => d.status === 'active' || d.status === 'available').map(driver => (
                                                    <option key={driver.id} value={driver.id}>{driver.name}</option>
                                                ))}
                                            </select>
                                        </div>
                                    </div>
                                    <div className="form-group">
                                        <label className="form-label">Status</label>
                                        <select 
                                            name="status"
                                            className="form-select"
                                            value={formData.status || 'planned'}
                                            onChange={handleChange}
                                        >
                                            <option value="planned">Planned</option>
                                            <option value="in-progress">In Progress</option>
                                            <option value="completed">Completed</option>
                                        </select>
                                    </div>
                                    <p style={{ color: 'var(--text-muted)', fontSize: '0.85rem', marginTop: '1rem' }}>
                                        Note: Trucks are filtered by selected DC. After creating a route, you can assign orders from the Orders tab.
                                    </p>
                                </>
                            )}

                            <div className="modal-footer">
                                <button type="button" className="btn btn-secondary" onClick={onClose}>
                                    Cancel
                                </button>
                                <button type="submit" className="btn btn-primary">
                                    {item ? 'Update' : 'Create'}
                                </button>
                            </div>
                        </form>
                    </div>
                </div>
            );
        }

        ReactDOM.render(<App />, document.getElementById('root'));
    </script>
</body>
</html>
